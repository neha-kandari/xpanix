import{j as c,A as Og,m as ct,u as Rx,a as Cx,b as _s,c as vs}from"./motion-Dp-5cGGj.js";import{a as Ix,r as G,R as Px,b as kg}from"./vendor-DAsaUmwd.js";import{U as Ws,S as Nu,L as Lu,M as Nx,X as Lx,F as Dx,I as Ox,a as of,b as Ug,P as Fg,C as Vg,c as jg,Z as Bg,H as kx,D as Ux,T as Fx,A as lf,d as Vx,e as jx,f as Bx}from"./icons-sngJ-nPR.js";import{Q as zg}from"./spline-BqyBE6Fd.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Du={},cf=Ix;Du.createRoot=cf.createRoot,Du.hydrateRoot=cf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qa(){return Qa=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Qa.apply(this,arguments)}var Ki;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Ki||(Ki={}));const uf="popstate";function zx(i){i===void 0&&(i={});function e(n,r){let{pathname:s,search:a,hash:o}=n.location;return Ou("",{pathname:s,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(n,r){return typeof r=="string"?r:Rl(r)}return Gx(e,t,null,i)}function Ht(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Hg(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Hx(){return Math.random().toString(36).substr(2,8)}function hf(i,e){return{usr:i.state,key:i.key,idx:e}}function Ou(i,e,t,n){return t===void 0&&(t=null),Qa({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?ha(e):e,{state:t,key:e&&e.key||n||Hx()})}function Rl(i){let{pathname:e="/",search:t="",hash:n=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ha(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substr(n),i=i.substr(0,n)),i&&(e.pathname=i)}return e}function Gx(i,e,t,n){n===void 0&&(n={});let{window:r=document.defaultView,v5Compat:s=!1}=n,a=r.history,o=Ki.Pop,l=null,h=d();h==null&&(h=0,a.replaceState(Qa({},a.state,{idx:h}),""));function d(){return(a.state||{idx:null}).idx}function f(){o=Ki.Pop;let m=d(),v=m==null?null:m-h;h=m,l&&l({action:o,location:T.location,delta:v})}function p(m,v){o=Ki.Push;let M=Ou(T.location,m,v);h=d()+1;let S=hf(M,h),L=T.createHref(M);try{a.pushState(S,"",L)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;r.location.assign(L)}s&&l&&l({action:o,location:T.location,delta:1})}function g(m,v){o=Ki.Replace;let M=Ou(T.location,m,v);h=d();let S=hf(M,h),L=T.createHref(M);a.replaceState(S,"",L),s&&l&&l({action:o,location:T.location,delta:0})}function y(m){let v=r.location.origin!=="null"?r.location.origin:r.location.href,M=typeof m=="string"?m:Rl(m);return M=M.replace(/ $/,"%20"),Ht(v,"No window.location.(origin|href) available to create URL for href: "+M),new URL(M,v)}let T={get action(){return o},get location(){return i(r,a)},listen(m){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(uf,f),l=m,()=>{r.removeEventListener(uf,f),l=null}},createHref(m){return e(r,m)},createURL:y,encodeLocation(m){let v=y(m);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:g,go(m){return a.go(m)}};return T}var df;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(df||(df={}));function Wx(i,e,t){return t===void 0&&(t="/"),qx(i,e,t)}function qx(i,e,t,n){let r=typeof e=="string"?ha(e):e,s=wh(r.pathname||"/",t);if(s==null)return null;let a=Gg(i);Xx(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let h=sy(s);o=ny(a[l],h)}return o}function Gg(i,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let r=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Ht(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let h=Zi([n,l.relativePath]),d=t.concat(l);s.children&&s.children.length>0&&(Ht(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Gg(s.children,e,d,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:ey(h,s.index),routesMeta:d})};return i.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))r(s,a);else for(let l of Wg(s.path))r(s,a,l)}),e}function Wg(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return r?[s,""]:[s];let a=Wg(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),r&&o.push(...a),o.map(l=>i.startsWith("/")&&l===""?"/":l)}function Xx(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:ty(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const $x=/^:[\w-]+$/,Yx=3,Kx=2,Jx=1,Qx=10,Zx=-2,ff=i=>i==="*";function ey(i,e){let t=i.split("/"),n=t.length;return t.some(ff)&&(n+=Zx),e&&(n+=Kx),t.filter(r=>!ff(r)).reduce((r,s)=>r+($x.test(s)?Yx:s===""?Jx:Qx),n)}function ty(i,e){return i.length===e.length&&i.slice(0,-1).every((n,r)=>n===e[r])?i[i.length-1]-e[e.length-1]:0}function ny(i,e,t){let{routesMeta:n}=i,r={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],h=o===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=iy({path:l.relativePath,caseSensitive:l.caseSensitive,end:h},d),p=l.route;if(!f)return null;Object.assign(r,f.params),a.push({params:r,pathname:Zi([s,f.pathname]),pathnameBase:cy(Zi([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=Zi([s,f.pathnameBase]))}return a}function iy(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=ry(i.path,i.caseSensitive,i.end),r=e.match(t);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:n.reduce((h,d,f)=>{let{paramName:p,isOptional:g}=d;if(p==="*"){let T=o[f]||"";a=s.slice(0,s.length-T.length).replace(/(.)\/+$/,"$1")}const y=o[f];return g&&!y?h[p]=void 0:h[p]=(y||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:a,pattern:i}}function ry(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Hg(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let n=[],r="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(n.push({paramName:"*"}),r+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":i!==""&&i!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),n]}function sy(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Hg(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function wh(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}function ay(i,e){e===void 0&&(e="/");let{pathname:t,search:n="",hash:r=""}=typeof i=="string"?ha(i):i;return{pathname:t?t.startsWith("/")?t:oy(t,e):e,search:uy(n),hash:hy(r)}}function oy(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Oc(i,e,t,n){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ly(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function qg(i,e){let t=ly(i);return e?t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function Xg(i,e,t,n){n===void 0&&(n=!1);let r;typeof i=="string"?r=ha(i):(r=Qa({},i),Ht(!r.pathname||!r.pathname.includes("?"),Oc("?","pathname","search",r)),Ht(!r.pathname||!r.pathname.includes("#"),Oc("#","pathname","hash",r)),Ht(!r.search||!r.search.includes("#"),Oc("#","search","hash",r)));let s=i===""||r.pathname==="",a=s?"/":r.pathname,o;if(a==null)o=t;else{let f=e.length-1;if(!n&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),f-=1;r.pathname=p.join("/")}o=f>=0?e[f]:"/"}let l=ay(r,o),h=a&&a!=="/"&&a.endsWith("/"),d=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(h||d)&&(l.pathname+="/"),l}const Zi=i=>i.join("/").replace(/\/\/+/g,"/"),cy=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),uy=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,hy=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function dy(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const $g=["post","put","patch","delete"];new Set($g);const fy=["get",...$g];new Set(fy);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Za(){return Za=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Za.apply(this,arguments)}const Sh=G.createContext(null),py=G.createContext(null),ns=G.createContext(null),nc=G.createContext(null),is=G.createContext({outlet:null,matches:[],isDataRoute:!1}),Yg=G.createContext(null);function my(i,e){let{relative:t}=e===void 0?{}:e;ho()||Ht(!1);let{basename:n,navigator:r}=G.useContext(ns),{hash:s,pathname:a,search:o}=Jg(i,{relative:t}),l=a;return n!=="/"&&(l=a==="/"?n:Zi([n,a])),r.createHref({pathname:l,search:o,hash:s})}function ho(){return G.useContext(nc)!=null}function rs(){return ho()||Ht(!1),G.useContext(nc).location}function Kg(i){G.useContext(ns).static||G.useLayoutEffect(i)}function fi(){let{isDataRoute:i}=G.useContext(is);return i?Ry():gy()}function gy(){ho()||Ht(!1);let i=G.useContext(Sh),{basename:e,future:t,navigator:n}=G.useContext(ns),{matches:r}=G.useContext(is),{pathname:s}=rs(),a=JSON.stringify(qg(r,t.v7_relativeSplatPath)),o=G.useRef(!1);return Kg(()=>{o.current=!0}),G.useCallback(function(h,d){if(d===void 0&&(d={}),!o.current)return;if(typeof h=="number"){n.go(h);return}let f=Xg(h,JSON.parse(a),s,d.relative==="path");i==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Zi([e,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[e,n,a,s,i])}function Jg(i,e){let{relative:t}=e===void 0?{}:e,{future:n}=G.useContext(ns),{matches:r}=G.useContext(is),{pathname:s}=rs(),a=JSON.stringify(qg(r,n.v7_relativeSplatPath));return G.useMemo(()=>Xg(i,JSON.parse(a),s,t==="path"),[i,a,s,t])}function _y(i,e){return vy(i,e)}function vy(i,e,t,n){ho()||Ht(!1);let{navigator:r}=G.useContext(ns),{matches:s}=G.useContext(is),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let h=rs(),d;if(e){var f;let m=typeof e=="string"?ha(e):e;l==="/"||(f=m.pathname)!=null&&f.startsWith(l)||Ht(!1),d=m}else d=h;let p=d.pathname||"/",g=p;if(l!=="/"){let m=l.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(m.length).join("/")}let y=Wx(i,{pathname:g}),T=wy(y&&y.map(m=>Object.assign({},m,{params:Object.assign({},o,m.params),pathname:Zi([l,r.encodeLocation?r.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:Zi([l,r.encodeLocation?r.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),s,t,n);return e&&T?G.createElement(nc.Provider,{value:{location:Za({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ki.Pop}},T):T}function xy(){let i=My(),e=dy(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),t?G.createElement("pre",{style:r},t):null,null)}const yy=G.createElement(xy,null);class by extends G.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?G.createElement(is.Provider,{value:this.props.routeContext},G.createElement(Yg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ey(i){let{routeContext:e,match:t,children:n}=i,r=G.useContext(Sh);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),G.createElement(is.Provider,{value:e},n)}function wy(i,e,t,n){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),i==null){var s;if(!t)return null;if(t.errors)i=t.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let a=i,o=(r=t)==null?void 0:r.errors;if(o!=null){let d=a.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);d>=0||Ht(!1),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,h=-1;if(t&&n&&n.v7_partialHydration)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(h=d),f.route.id){let{loaderData:p,errors:g}=t,y=f.route.loader&&p[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||y){l=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((d,f,p)=>{let g,y=!1,T=null,m=null;t&&(g=o&&f.route.id?o[f.route.id]:void 0,T=f.route.errorElement||yy,l&&(h<0&&p===0?(Cy("route-fallback"),y=!0,m=null):h===p&&(y=!0,m=f.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,p+1)),M=()=>{let S;return g?S=T:y?S=m:f.route.Component?S=G.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=d,G.createElement(Ey,{match:f,routeContext:{outlet:d,matches:v,isDataRoute:t!=null},children:S})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?G.createElement(by,{location:t.location,revalidation:t.revalidation,component:T,error:g,children:M(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):M()},null)}var Qg=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(Qg||{}),Zg=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(Zg||{});function Sy(i){let e=G.useContext(Sh);return e||Ht(!1),e}function Ty(i){let e=G.useContext(py);return e||Ht(!1),e}function Ay(i){let e=G.useContext(is);return e||Ht(!1),e}function e0(i){let e=Ay(),t=e.matches[e.matches.length-1];return t.route.id||Ht(!1),t.route.id}function My(){var i;let e=G.useContext(Yg),t=Ty(),n=e0();return e!==void 0?e:(i=t.errors)==null?void 0:i[n]}function Ry(){let{router:i}=Sy(Qg.UseNavigateStable),e=e0(Zg.UseNavigateStable),t=G.useRef(!1);return Kg(()=>{t.current=!0}),G.useCallback(function(r,s){s===void 0&&(s={}),t.current&&(typeof r=="number"?i.navigate(r):i.navigate(r,Za({fromRouteId:e},s)))},[i,e])}const pf={};function Cy(i,e,t){pf[i]||(pf[i]=!0)}function Iy(i,e){i?.v7_startTransition,i?.v7_relativeSplatPath}function Cn(i){Ht(!1)}function Py(i){let{basename:e="/",children:t=null,location:n,navigationType:r=Ki.Pop,navigator:s,static:a=!1,future:o}=i;ho()&&Ht(!1);let l=e.replace(/^\/*/,"/"),h=G.useMemo(()=>({basename:l,navigator:s,static:a,future:Za({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=ha(n));let{pathname:d="/",search:f="",hash:p="",state:g=null,key:y="default"}=n,T=G.useMemo(()=>{let m=wh(d,l);return m==null?null:{location:{pathname:m,search:f,hash:p,state:g,key:y},navigationType:r}},[l,d,f,p,g,y,r]);return T==null?null:G.createElement(ns.Provider,{value:h},G.createElement(nc.Provider,{children:t,value:T}))}function Ny(i){let{children:e,location:t}=i;return _y(ku(e),t)}new Promise(()=>{});function ku(i,e){e===void 0&&(e=[]);let t=[];return G.Children.forEach(i,(n,r)=>{if(!G.isValidElement(n))return;let s=[...e,r];if(n.type===G.Fragment){t.push.apply(t,ku(n.props.children,s));return}n.type!==Cn&&Ht(!1),!n.props.index||!n.props.children||Ht(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=ku(n.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uu(){return Uu=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Uu.apply(this,arguments)}function Ly(i,e){if(i==null)return{};var t={},n=Object.keys(i),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(t[r]=i[r]);return t}function Dy(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function Oy(i,e){return i.button===0&&(!e||e==="_self")&&!Dy(i)}const ky=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Uy="6";try{window.__reactRouterVersion=Uy}catch{}const Fy="startTransition",mf=Px[Fy];function Vy(i){let{basename:e,children:t,future:n,window:r}=i,s=G.useRef();s.current==null&&(s.current=zx({window:r,v5Compat:!0}));let a=s.current,[o,l]=G.useState({action:a.action,location:a.location}),{v7_startTransition:h}=n||{},d=G.useCallback(f=>{h&&mf?mf(()=>l(f)):l(f)},[l,h]);return G.useLayoutEffect(()=>a.listen(d),[a,d]),G.useEffect(()=>Iy(n),[n]),G.createElement(Py,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:n})}const jy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",By=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rt=G.forwardRef(function(e,t){let{onClick:n,relative:r,reloadDocument:s,replace:a,state:o,target:l,to:h,preventScrollReset:d,viewTransition:f}=e,p=Ly(e,ky),{basename:g}=G.useContext(ns),y,T=!1;if(typeof h=="string"&&By.test(h)&&(y=h,jy))try{let S=new URL(window.location.href),L=h.startsWith("//")?new URL(S.protocol+h):new URL(h),V=wh(L.pathname,g);L.origin===S.origin&&V!=null?h=V+L.search+L.hash:T=!0}catch{}let m=my(h,{relative:r}),v=zy(h,{replace:a,state:o,target:l,preventScrollReset:d,relative:r,viewTransition:f});function M(S){n&&n(S),S.defaultPrevented||v(S)}return G.createElement("a",Uu({},p,{href:y||m,onClick:T||s?n:M,ref:t,target:l}))});var gf;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(gf||(gf={}));var _f;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(_f||(_f={}));function zy(i,e){let{target:t,replace:n,state:r,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,l=fi(),h=rs(),d=Jg(i,{relative:a});return G.useCallback(f=>{if(Oy(f,t)){f.preventDefault();let p=n!==void 0?n:Rl(h)===Rl(d);l(i,{replace:p,state:r,preventScrollReset:s,relative:a,viewTransition:o})}},[h,l,d,n,r,t,i,s,a,o])}const Hy=()=>{};var vf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Gy=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const r=i[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=i[t++];e[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=i[t++],a=i[t++],o=i[t++],l=((r&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=i[t++],a=i[t++];e[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|a&63)}}return e.join("")},n0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){const s=i[r],a=r+1<i.length,o=a?i[r+1]:0,l=r+2<i.length,h=l?i[r+2]:0,d=s>>2,f=(s&3)<<4|o>>4;let p=(o&15)<<2|h>>6,g=h&63;l||(g=64,a||(p=64)),n.push(t[d],t[f],t[p],t[g])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(t0(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):Gy(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){const s=t[i.charAt(r++)],o=r<i.length?t[i.charAt(r)]:0;++r;const h=r<i.length?t[i.charAt(r)]:64;++r;const f=r<i.length?t[i.charAt(r)]:64;if(++r,s==null||o==null||h==null||f==null)throw new Wy;const p=s<<2|o>>4;if(n.push(p),h!==64){const g=o<<4&240|h>>2;if(n.push(g),f!==64){const y=h<<6&192|f;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class Wy extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qy=function(i){const e=t0(i);return n0.encodeByteArray(e,!0)},Cl=function(i){return qy(i).replace(/\./g,"")},i0=function(i){try{return n0.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=()=>Xy().__FIREBASE_DEFAULTS__,Yy=()=>{if(typeof process>"u"||typeof vf>"u")return;const i=vf.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},Ky=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&i0(i[1]);return e&&JSON.parse(e)},ic=()=>{try{return Hy()||$y()||Yy()||Ky()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},r0=i=>{var e,t;return(t=(e=ic())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[i]},Jy=i=>{const e=r0(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},s0=()=>{var i;return(i=ic())===null||i===void 0?void 0:i.config},a0=i=>{var e;return(e=ic())===null||e===void 0?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function o0(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=i.iat||0,s=i.sub||i.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},i);return[Cl(JSON.stringify(t)),Cl(JSON.stringify(a)),""].join(".")}const Wa={};function eb(){const i={prod:[],emulator:[]};for(const e of Object.keys(Wa))Wa[e]?i.emulator.push(e):i.prod.push(e);return i}function tb(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let xf=!1;function l0(i,e){if(typeof window>"u"||typeof document>"u"||!da(window.location.host)||Wa[i]===e||Wa[i]||xf)return;Wa[i]=e;function t(p){return`__firebase__banner__${p}`}const n="__firebase__banner",s=eb().prod.length>0;function a(){const p=document.getElementById(n);p&&p.remove()}function o(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function h(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{xf=!0,a()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=tb(n),g=t("text"),y=document.getElementById(g)||document.createElement("span"),T=t("learnmore"),m=document.getElementById(T)||document.createElement("a"),v=t("preprendIcon"),M=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const S=p.element;o(S),d(m,T);const L=h();l(M,v),S.append(M,y,m,L),document.body.appendChild(S)}s?(y.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function ib(){var i;const e=(i=ic())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sb(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function ab(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ob(){const i=pn();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function lb(){return!ib()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cb(){try{return typeof indexedDB=="object"}catch{return!1}}function ub(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="FirebaseError";class Di extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=hb,Object.setPrototypeOf(this,Di.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fo.prototype.create)}}class fo{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],a=s?db(s,n):"Error",o=`${this.serviceName}: ${a} (${r}).`;return new Di(r,o,n)}}function db(i,e){return i.replace(fb,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const fb=/\{\$([^}]+)}/g;function pb(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function Xr(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const s=i[r],a=e[r];if(yf(s)&&yf(a)){if(!Xr(s,a))return!1}else if(s!==a)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function yf(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Va(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[r,s]=n.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function ja(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function mb(i,e){const t=new gb(i,e);return t.subscribe.bind(t)}class gb{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");_b(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:n},r.next===void 0&&(r.next=kc),r.error===void 0&&(r.error=kc),r.complete===void 0&&(r.complete=kc);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _b(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function kc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(i){return i&&i._delegate?i._delegate:i}class $r{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Qy;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yb(e))try{this.getOrInitializeService({instanceIdentifier:Dr})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(e=Dr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Dr){return this.instances.has(e)}getOptions(e=Dr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(r))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:xb(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Dr){return this.component?this.component.multipleInstances?e:Dr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xb(i){return i===Dr?void 0:i}function yb(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new vb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(dt||(dt={}));const Eb={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},wb=dt.INFO,Sb={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},Tb=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),r=Sb[e];if(r)console[r](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Th{constructor(e){this.name=e,this._logLevel=wb,this._logHandler=Tb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Eb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...e),this._logHandler(this,dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...e),this._logHandler(this,dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...e),this._logHandler(this,dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...e),this._logHandler(this,dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...e),this._logHandler(this,dt.ERROR,...e)}}const Ab=(i,e)=>e.some(t=>i instanceof t);let bf,Ef;function Mb(){return bf||(bf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Rb(){return Ef||(Ef=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const c0=new WeakMap,Fu=new WeakMap,u0=new WeakMap,Uc=new WeakMap,Ah=new WeakMap;function Cb(i){const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("success",s),i.removeEventListener("error",a)},s=()=>{t(er(i.result)),r()},a=()=>{n(i.error),r()};i.addEventListener("success",s),i.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&c0.set(t,i)}).catch(()=>{}),Ah.set(e,i),e}function Ib(i){if(Fu.has(i))return;const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",a),i.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",s),i.addEventListener("error",a),i.addEventListener("abort",a)});Fu.set(i,e)}let Vu={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Fu.get(i);if(e==="objectStoreNames")return i.objectStoreNames||u0.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return er(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function Pb(i){Vu=i(Vu)}function Nb(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(Fc(this),e,...t);return u0.set(n,e.sort?e.sort():[e]),er(n)}:Rb().includes(i)?function(...e){return i.apply(Fc(this),e),er(c0.get(this))}:function(...e){return er(i.apply(Fc(this),e))}}function Lb(i){return typeof i=="function"?Nb(i):(i instanceof IDBTransaction&&Ib(i),Ab(i,Mb())?new Proxy(i,Vu):i)}function er(i){if(i instanceof IDBRequest)return Cb(i);if(Uc.has(i))return Uc.get(i);const e=Lb(i);return e!==i&&(Uc.set(i,e),Ah.set(e,i)),e}const Fc=i=>Ah.get(i);function Db(i,e,{blocked:t,upgrade:n,blocking:r,terminated:s}={}){const a=indexedDB.open(i,e),o=er(a);return n&&a.addEventListener("upgradeneeded",l=>{n(er(a.result),l.oldVersion,l.newVersion,er(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),o}const Ob=["get","getKey","getAll","getAllKeys","count"],kb=["put","add","delete","clear"],Vc=new Map;function wf(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Vc.get(e))return Vc.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=kb.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||Ob.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,r?"readwrite":"readonly");let h=l.store;return n&&(h=h.index(o.shift())),(await Promise.all([h[t](...o),r&&l.done]))[0]};return Vc.set(e,s),s}Pb(i=>({...i,get:(e,t,n)=>wf(e,t)||i.get(e,t,n),has:(e,t)=>!!wf(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Fb(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function Fb(i){const e=i.getComponent();return e?.type==="VERSION"}const ju="@firebase/app",Sf="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new Th("@firebase/app"),Vb="@firebase/app-compat",jb="@firebase/analytics-compat",Bb="@firebase/analytics",zb="@firebase/app-check-compat",Hb="@firebase/app-check",Gb="@firebase/auth",Wb="@firebase/auth-compat",qb="@firebase/database",Xb="@firebase/data-connect",$b="@firebase/database-compat",Yb="@firebase/functions",Kb="@firebase/functions-compat",Jb="@firebase/installations",Qb="@firebase/installations-compat",Zb="@firebase/messaging",eE="@firebase/messaging-compat",tE="@firebase/performance",nE="@firebase/performance-compat",iE="@firebase/remote-config",rE="@firebase/remote-config-compat",sE="@firebase/storage",aE="@firebase/storage-compat",oE="@firebase/firestore",lE="@firebase/ai",cE="@firebase/firestore-compat",uE="firebase",hE="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu="[DEFAULT]",dE={[ju]:"fire-core",[Vb]:"fire-core-compat",[Bb]:"fire-analytics",[jb]:"fire-analytics-compat",[Hb]:"fire-app-check",[zb]:"fire-app-check-compat",[Gb]:"fire-auth",[Wb]:"fire-auth-compat",[qb]:"fire-rtdb",[Xb]:"fire-data-connect",[$b]:"fire-rtdb-compat",[Yb]:"fire-fn",[Kb]:"fire-fn-compat",[Jb]:"fire-iid",[Qb]:"fire-iid-compat",[Zb]:"fire-fcm",[eE]:"fire-fcm-compat",[tE]:"fire-perf",[nE]:"fire-perf-compat",[iE]:"fire-rc",[rE]:"fire-rc-compat",[sE]:"fire-gcs",[aE]:"fire-gcs-compat",[oE]:"fire-fst",[cE]:"fire-fst-compat",[lE]:"fire-vertex","fire-js":"fire-js",[uE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=new Map,fE=new Map,zu=new Map;function Tf(i,e){try{i.container.addComponent(e)}catch(t){Ii.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Qs(i){const e=i.name;if(zu.has(e))return Ii.debug(`There were multiple attempts to register component ${e}.`),!1;zu.set(e,i);for(const t of eo.values())Tf(t,i);for(const t of fE.values())Tf(t,i);return!0}function Mh(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function In(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tr=new fo("app","Firebase",pE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new $r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=hE;function h0(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Bu,automaticDataCollectionEnabled:!0},e),r=n.name;if(typeof r!="string"||!r)throw tr.create("bad-app-name",{appName:String(r)});if(t||(t=s0()),!t)throw tr.create("no-options");const s=eo.get(r);if(s){if(Xr(t,s.options)&&Xr(n,s.config))return s;throw tr.create("duplicate-app",{appName:r})}const a=new bb(r);for(const l of zu.values())a.addComponent(l);const o=new mE(t,n,a);return eo.set(r,o),o}function d0(i=Bu){const e=eo.get(i);if(!e&&i===Bu&&s0())return h0();if(!e)throw tr.create("no-app",{appName:i});return e}function Af(){return Array.from(eo.values())}function nr(i,e,t){var n;let r=(n=dE[i])!==null&&n!==void 0?n:i;t&&(r+=`-${t}`);const s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ii.warn(o.join(" "));return}Qs(new $r(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="firebase-heartbeat-database",_E=1,to="firebase-heartbeat-store";let jc=null;function f0(){return jc||(jc=Db(gE,_E,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(to)}catch(t){console.warn(t)}}}}).catch(i=>{throw tr.create("idb-open",{originalErrorMessage:i.message})})),jc}async function vE(i){try{const t=(await f0()).transaction(to),n=await t.objectStore(to).get(p0(i));return await t.done,n}catch(e){if(e instanceof Di)Ii.warn(e.message);else{const t=tr.create("idb-get",{originalErrorMessage:e?.message});Ii.warn(t.message)}}}async function Mf(i,e){try{const n=(await f0()).transaction(to,"readwrite");await n.objectStore(to).put(e,p0(i)),await n.done}catch(t){if(t instanceof Di)Ii.warn(t.message);else{const n=tr.create("idb-set",{originalErrorMessage:t?.message});Ii.warn(n.message)}}}function p0(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=1024,yE=30;class bE{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wE(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Rf();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>yE){const a=SE(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ii.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Rf(),{heartbeatsToSend:n,unsentEntries:r}=EE(this._heartbeatsCache.heartbeats),s=Cl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ii.warn(t),""}}}function Rf(){return new Date().toISOString().substring(0,10)}function EE(i,e=xE){const t=[];let n=i.slice();for(const r of i){const s=t.find(a=>a.agent===r.agent);if(s){if(s.dates.push(r.date),Cf(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Cf(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class wE{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cb()?ub().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await vE(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Mf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Mf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Cf(i){return Cl(JSON.stringify({version:2,heartbeats:i})).length}function SE(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(i){Qs(new $r("platform-logger",e=>new Ub(e),"PRIVATE")),Qs(new $r("heartbeat",e=>new bE(e),"PRIVATE")),nr(ju,Sf,i),nr(ju,Sf,"esm2017"),nr("fire-js","")}TE("");var AE="firebase",ME="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nr(AE,ME,"app");function Rh(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(t[n[r]]=i[n[r]]);return t}function m0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RE=m0,g0=new fo("auth","Firebase",m0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=new Th("@firebase/auth");function CE(i,...e){Il.logLevel<=dt.WARN&&Il.warn(`Auth (${fa}): ${i}`,...e)}function gl(i,...e){Il.logLevel<=dt.ERROR&&Il.error(`Auth (${fa}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(i,...e){throw Ih(i,...e)}function $n(i,...e){return Ih(i,...e)}function Ch(i,e,t){const n=Object.assign(Object.assign({},RE()),{[e]:t});return new fo("auth","Firebase",n).create(e,{appName:i.name})}function Ci(i){return Ch(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function IE(i,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&Vn(i,"argument-error"),Ch(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ih(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return g0.create(i,...e)}function He(i,e,...t){if(!i)throw Ih(e,...t)}function Ti(i){const e="INTERNAL ASSERTION FAILED: "+i;throw gl(e),new Error(e)}function Pi(i,e){i||Ti(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.href)||""}function PE(){return If()==="http:"||If()==="https:"}function If(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PE()||sb()||"connection"in navigator)?navigator.onLine:!0}function LE(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pi(t>e,"Short delay should be less than long delay!"),this.isMobile=nb()||ab()}get(){return NE()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(i,e){Pi(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ti("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ti("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ti("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kE=new mo(3e4,6e4);function vr(i,e){return i.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:i.tenantId}):e}async function Oi(i,e,t,n,r={}){return v0(i,r,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=po(Object.assign({key:i.config.apiKey},a)).slice(1),l=await i._getAdditionalHeaders();l["Content-Type"]="application/json",i.languageCode&&(l["X-Firebase-Locale"]=i.languageCode);const h=Object.assign({method:e,headers:l},s);return rb()||(h.referrerPolicy="no-referrer"),i.emulatorConfig&&da(i.emulatorConfig.host)&&(h.credentials="include"),_0.fetch()(await x0(i,i.config.apiHost,t,o),h)})}async function v0(i,e,t){i._canInitEmulator=!1;const n=Object.assign(Object.assign({},DE),e);try{const r=new FE(i),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Vo(i,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,h]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vo(i,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Vo(i,"email-already-in-use",a);if(l==="USER_DISABLED")throw Vo(i,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Ch(i,d,h);Vn(i,d)}}catch(r){if(r instanceof Di)throw r;Vn(i,"network-request-failed",{message:String(r)})}}async function go(i,e,t,n,r={}){const s=await Oi(i,e,t,n,r);return"mfaPendingCredential"in s&&Vn(i,"multi-factor-auth-required",{_serverResponse:s}),s}async function x0(i,e,t,n){const r=`${e}${t}?${n}`,s=i,a=s.config.emulator?Ph(i.config,r):`${i.config.apiScheme}://${r}`;return OE.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function UE(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class FE{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n($n(this.auth,"network-request-failed")),kE.get())})}}function Vo(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const r=$n(i,e,n);return r.customData._tokenResponse=t,r}function Pf(i){return i!==void 0&&i.enterprise!==void 0}class VE{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return UE(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function jE(i,e){return Oi(i,"GET","/v2/recaptchaConfig",vr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BE(i,e){return Oi(i,"POST","/v1/accounts:delete",e)}async function Pl(i,e){return Oi(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zE(i,e=!1){const t=sn(i),n=await t.getIdToken(e),r=Nh(n);He(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,a=s?.sign_in_provider;return{claims:r,token:n,authTime:qa(Bc(r.auth_time)),issuedAtTime:qa(Bc(r.iat)),expirationTime:qa(Bc(r.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Bc(i){return Number(i)*1e3}function Nh(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return gl("JWT malformed, contained fewer than 3 sections"),null;try{const r=i0(t);return r?JSON.parse(r):(gl("Failed to decode base64 JWT payload"),null)}catch(r){return gl("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Nf(i){const e=Nh(i);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zs(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Di&&HE(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function HE({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qa(this.lastLoginAt),this.creationTime=qa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nl(i){var e;const t=i.auth,n=await i.getIdToken(),r=await Zs(i,Pl(t,{idToken:n}));He(r?.users.length,t,"internal-error");const s=r.users[0];i._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?y0(s.providerUserInfo):[],o=qE(i.providerData,a),l=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!o?.length,d=l?h:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Gu(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(i,f)}async function WE(i){const e=sn(i);await Nl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qE(i,e){return[...i.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function y0(i){return i.map(e=>{var{providerId:t}=e,n=Rh(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XE(i,e){const t=await v0(i,{},async()=>{const n=po({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=i.config,a=await x0(i,r,"/v1/token",`key=${s}`),o=await i._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return i.emulatorConfig&&da(i.emulatorConfig.host)&&(l.credentials="include"),_0.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function $E(i,e){return Oi(i,"POST","/v2/accounts:revokeToken",vr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Nf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){He(e.length!==0,"internal-error");const t=Nf(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(He(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await XE(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,a=new qs;return n&&(He(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),r&&(He(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),s&&(He(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qs,this.toJSON())}_performRefresh(){return Ti("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(i,e){He(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Xn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=Rh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new GE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Gu(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Zs(this,this.stsTokenManager.getToken(this.auth,e));return He(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return zE(this,e)}reload(){return WE(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Nl(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(In(this.auth.app))return Promise.reject(Ci(this.auth));const e=await this.getIdToken();return await Zs(this,BE(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,a,o,l,h,d;const f=(n=t.displayName)!==null&&n!==void 0?n:void 0,p=(r=t.email)!==null&&r!==void 0?r:void 0,g=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=t.photoURL)!==null&&a!==void 0?a:void 0,T=(o=t.tenantId)!==null&&o!==void 0?o:void 0,m=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,v=(h=t.createdAt)!==null&&h!==void 0?h:void 0,M=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:L,isAnonymous:V,providerData:k,stsTokenManager:w}=t;He(S&&w,e,"internal-error");const A=qs.fromJSON(this.name,w);He(typeof S=="string",e,"internal-error"),Fi(f,e.name),Fi(p,e.name),He(typeof L=="boolean",e,"internal-error"),He(typeof V=="boolean",e,"internal-error"),Fi(g,e.name),Fi(y,e.name),Fi(T,e.name),Fi(m,e.name),Fi(v,e.name),Fi(M,e.name);const C=new Xn({uid:S,auth:e,email:p,emailVerified:L,displayName:f,isAnonymous:V,photoURL:y,phoneNumber:g,tenantId:T,stsTokenManager:A,createdAt:v,lastLoginAt:M});return k&&Array.isArray(k)&&(C.providerData=k.map(x=>Object.assign({},x))),m&&(C._redirectEventId=m),C}static async _fromIdTokenResponse(e,t,n=!1){const r=new qs;r.updateFromServerResponse(t);const s=new Xn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Nl(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];He(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?y0(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!s?.length,o=new qs;o.updateFromIdToken(n);const l=new Xn({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:a}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Gu(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,h),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf=new Map;function Ai(i){Pi(i instanceof Function,"Expected a class definition");let e=Lf.get(i);return e?(Pi(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,Lf.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}b0.type="NONE";const Df=b0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(i,e,t){return`firebase:${i}:${e}:${t}`}class Xs{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=_l(this.userKey,r.apiKey,s),this.fullPersistenceKey=_l("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Pl(this.auth,{idToken:e}).catch(()=>{});return t?Xn._fromGetAccountInfoResponse(this.auth,t,e):null}return Xn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Xs(Ai(Df),e,n);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Ai(Df);const a=_l(n,e.config.apiKey,e.name);let o=null;for(const h of t)try{const d=await h._get(a);if(d){let f;if(typeof d=="string"){const p=await Pl(e,{idToken:d}).catch(()=>{});if(!p)break;f=await Xn._fromGetAccountInfoResponse(e,p,d)}else f=Xn._fromJSON(e,d);h!==s&&(o=f),s=h;break}}catch{}const l=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Xs(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(a)}catch{}})),new Xs(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(T0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(M0(e))return"Blackberry";if(R0(e))return"Webos";if(w0(e))return"Safari";if((e.includes("chrome/")||S0(e))&&!e.includes("edge/"))return"Chrome";if(A0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if(n?.length===2)return n[1]}return"Other"}function E0(i=pn()){return/firefox\//i.test(i)}function w0(i=pn()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function S0(i=pn()){return/crios\//i.test(i)}function T0(i=pn()){return/iemobile/i.test(i)}function A0(i=pn()){return/android/i.test(i)}function M0(i=pn()){return/blackberry/i.test(i)}function R0(i=pn()){return/webos/i.test(i)}function Lh(i=pn()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function YE(i=pn()){var e;return Lh(i)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KE(){return ob()&&document.documentMode===10}function C0(i=pn()){return Lh(i)||A0(i)||R0(i)||M0(i)||/windows phone/i.test(i)||T0(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(i,e=[]){let t;switch(i){case"Browser":t=Of(pn());break;case"Worker":t=`${Of(pn())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${fa}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QE(i,e={}){return Oi(i,"GET","/v2/passwordPolicy",vr(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE=6;class ew{constructor(e){var t,n,r,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:ZE,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kf(this),this.idTokenSubscription=new kf(this),this.beforeStateQueue=new JE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=g0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ai(t)),this._initializationPromise=this.queue(async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await Xs.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Pl(this,{idToken:e}),n=await Xn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(In(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,o=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return He(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nl(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LE()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(In(this.app))return Promise.reject(Ci(this));const t=e?sn(e):null;return t&&He(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&He(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return In(this.app)?Promise.reject(Ci(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return In(this.app)?Promise.reject(Ci(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ai(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QE(this),t=new ew(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new fo("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await $E(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ai(e)||this._popupRedirectResolver;He(t,this,"argument-error"),this.redirectPersistenceManager=await Xs.create(this,[Ai(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(He(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,n,r);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=I0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&CE(`Error while retrieving App Check token: ${t.error}`),t?.token}}function xr(i){return sn(i)}class kf{constructor(e){this.auth=e,this.observer=null,this.addObserver=mb(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nw(i){rc=i}function P0(i){return rc.loadJS(i)}function iw(){return rc.recaptchaEnterpriseScript}function rw(){return rc.gapiScript}function sw(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class aw{constructor(){this.enterprise=new ow}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class ow{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const lw="recaptcha-enterprise",N0="NO_RECAPTCHA";class cw{constructor(e){this.type=lw,this.auth=xr(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{jE(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const h=new VE(l);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,a(h.siteKey)}}).catch(l=>{o(l)})})}function r(s,a,o){const l=window.grecaptcha;Pf(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(h=>{a(h)}).catch(()=>{a(N0)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aw().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{n(this.auth).then(o=>{if(!t&&Pf(window.grecaptcha))r(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=iw();l.length!==0&&(l+=o),P0(l).then(()=>{r(o,s,a)}).catch(h=>{a(h)})}}).catch(o=>{a(o)})})}}async function Uf(i,e,t,n=!1,r=!1){const s=new cw(i);let a;if(r)a=N0;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}const o=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,h=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Wu(i,e,t,n,r){var s;if(!((s=i._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Uf(i,e,t,t==="getOobCode");return n(i,a)}else return n(i,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Uf(i,e,t,t==="getOobCode");return n(i,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(i,e){const t=Mh(i,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(Xr(s,e??{}))return r;Vn(r,"already-initialized")}return t.initialize({options:e})}function hw(i,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Ai);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e?.popupRedirectResolver)}function dw(i,e,t){const n=xr(i);He(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const r=!1,s=L0(e),{host:a,port:o}=fw(e),l=o===null?"":`:${o}`,h={url:`${s}//${a}${l}/`},d=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!n._canInitEmulator){He(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),He(Xr(h,n.config.emulator)&&Xr(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,da(a)?(o0(`${s}//${a}${l}`),l0("Auth",!0)):pw()}function L0(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function fw(i){const e=L0(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){const s=r[1];return{host:s,port:Ff(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Ff(a)}}}function Ff(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function pw(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ti("not implemented")}_getIdTokenResponse(e){return Ti("not implemented")}_linkToIdToken(e,t){return Ti("not implemented")}_getReauthenticationResolver(e){return Ti("not implemented")}}async function mw(i,e){return Oi(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gw(i,e){return go(i,"POST","/v1/accounts:signInWithPassword",vr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _w(i,e){return go(i,"POST","/v1/accounts:signInWithEmailLink",vr(i,e))}async function vw(i,e){return go(i,"POST","/v1/accounts:signInWithEmailLink",vr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends Dh{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new no(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new no(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wu(e,t,"signInWithPassword",gw);case"emailLink":return _w(e,{email:this._email,oobCode:this._password});default:Vn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wu(e,n,"signUpPassword",mw);case"emailLink":return vw(e,{idToken:t,email:this._email,oobCode:this._password});default:Vn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $s(i,e){return go(i,"POST","/v1/accounts:signInWithIdp",vr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw="http://localhost";class Yr extends Dh{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=Rh(t,["providerId","signInMethod"]);if(!n||!r)return null;const a=new Yr(n,r);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return $s(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,$s(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$s(e,t)}buildRequest(){const e={requestUri:xw,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=po(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function bw(i){const e=Va(ja(i)).link,t=e?Va(ja(e)).deep_link_id:null,n=Va(ja(i)).deep_link_id;return(n?Va(ja(n)).link:null)||n||t||e||i}class Oh{constructor(e){var t,n,r,s,a,o;const l=Va(ja(e)),h=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(n=l.oobCode)!==null&&n!==void 0?n:null,f=yw((r=l.mode)!==null&&r!==void 0?r:null);He(h&&d&&f,"argument-error"),this.apiKey=h,this.operation=f,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.lang)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const t=bw(e);try{return new Oh(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(){this.providerId=pa.PROVIDER_ID}static credential(e,t){return no._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Oh.parseLink(t);return He(n,"argument-error"),no._fromEmailAndCode(e,n.code,n.tenantId)}}pa.PROVIDER_ID="password";pa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";pa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o extends kh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends _o{constructor(){super("facebook.com")}static credential(e){return Yr._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qi.credential(e.oauthAccessToken)}catch{return null}}}qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn extends _o{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yr._fromParams({providerId:Zn.PROVIDER_ID,signInMethod:Zn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Zn.credentialFromTaggedObject(e)}static credentialFromError(e){return Zn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Zn.credential(t,n)}catch{return null}}}Zn.GOOGLE_SIGN_IN_METHOD="google.com";Zn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends _o{constructor(){super("github.com")}static credential(e){return Yr._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends _o{constructor(){super("twitter.com")}static credential(e,t){return Yr._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return $i.credential(t,n)}catch{return null}}}$i.TWITTER_SIGN_IN_METHOD="twitter.com";$i.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ew(i,e){return go(i,"POST","/v1/accounts:signUp",vr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await Xn._fromIdTokenResponse(e,n,r),a=Vf(n);return new Kr({user:s,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Vf(n);return new Kr({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Vf(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll extends Di{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Ll.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Ll(e,t,n,r)}}function D0(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ll._fromErrorAndOperation(i,s,e,n):s})}async function ww(i,e,t=!1){const n=await Zs(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Kr._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sw(i,e,t=!1){const{auth:n}=i;if(In(n.app))return Promise.reject(Ci(n));const r="reauthenticate";try{const s=await Zs(i,D0(n,r,e,i),t);He(s.idToken,n,"internal-error");const a=Nh(s.idToken);He(a,n,"internal-error");const{sub:o}=a;return He(i.uid===o,n,"user-mismatch"),Kr._forOperation(i,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&Vn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O0(i,e,t=!1){if(In(i.app))return Promise.reject(Ci(i));const n="signIn",r=await D0(i,n,e),s=await Kr._fromIdTokenResponse(i,n,r);return t||await i._updateCurrentUser(s.user),s}async function Tw(i,e){return O0(xr(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k0(i){const e=xr(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Aw(i,e,t){if(In(i.app))return Promise.reject(Ci(i));const n=xr(i),a=await Wu(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ew).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&k0(i),l}),o=await Kr._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function Mw(i,e,t){return In(i.app)?Promise.reject(Ci(i)):Tw(sn(i),pa.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&k0(i),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rw(i,e){return Oi(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U0(i,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=sn(i),s={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await Zs(n,Rw(n.auth,s));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function Cw(i,e,t,n){return sn(i).onIdTokenChanged(e,t,n)}function Iw(i,e,t){return sn(i).beforeAuthStateChanged(e,t)}function Pw(i,e,t,n){return sn(i).onAuthStateChanged(e,t,n)}function jf(i){return sn(i).signOut()}const Dl="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dl,"1"),this.storage.removeItem(Dl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw=1e3,Lw=10;class V0 extends F0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=C0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(n);!t&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);KE()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Lw):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},Nw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}V0.type="LOCAL";const Dw=V0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0 extends F0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}j0.type="SESSION";const B0=j0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const n=new sc(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,a=this.handlersMap[r];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(a).map(async h=>h(t.origin,s)),l=await Ow(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uh(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const h=Uh("",20);r.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:r,onMessage(f){const p=f;if(p.data.eventId===h)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(){return window}function Uw(i){ti().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(){return typeof ti().WorkerGlobalScope<"u"&&typeof ti().importScripts=="function"}async function Fw(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Vw(){var i;return((i=navigator?.serviceWorker)===null||i===void 0?void 0:i.controller)||null}function jw(){return z0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="firebaseLocalStorageDb",Bw=1,Ol="firebaseLocalStorage",G0="fbase_key";class vo{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ac(i,e){return i.transaction([Ol],e?"readwrite":"readonly").objectStore(Ol)}function zw(){const i=indexedDB.deleteDatabase(H0);return new vo(i).toPromise()}function qu(){const i=indexedDB.open(H0,Bw);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Ol,{keyPath:G0})}catch(r){t(r)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Ol)?e(n):(n.close(),await zw(),e(await qu()))})})}async function Bf(i,e,t){const n=ac(i,!0).put({[G0]:e,value:t});return new vo(n).toPromise()}async function Hw(i,e){const t=ac(i,!1).get(e),n=await new vo(t).toPromise();return n===void 0?null:n.value}function zf(i,e){const t=ac(i,!0).delete(e);return new vo(t).toPromise()}const Gw=800,Ww=3;class W0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qu(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>Ww)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return z0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sc._getInstance(jw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Fw(),!this.activeServiceWorker)return;this.sender=new kw(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Vw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qu();return await Bf(e,Dl,"1"),await zf(e,Dl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Bf(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>Hw(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>zf(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ac(r,!1).getAll();return new vo(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Gw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}W0.type="LOCAL";const qw=W0;new mo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(i,e){return e?Ai(e):(He(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh extends Dh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $s(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $s(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $s(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Xw(i){return O0(i.auth,new Fh(i),i.bypassAuthState)}function $w(i){const{auth:e,user:t}=i;return He(t,e,"internal-error"),Sw(t,new Fh(i),i.bypassAuthState)}async function Yw(i){const{auth:e,user:t}=i;return He(t,e,"internal-error"),ww(t,new Fh(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xw;case"linkViaPopup":case"linkViaRedirect":return Yw;case"reauthViaPopup":case"reauthViaRedirect":return $w;default:Vn(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=new mo(2e3,1e4);async function $0(i,e,t){if(In(i.app))return Promise.reject($n(i,"operation-not-supported-in-this-environment"));const n=xr(i);IE(i,e,kh);const r=q0(n,t);return new Fr(n,"signInViaPopup",e,r).executeNotNull()}class Fr extends X0{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Fr.currentPopupAction&&Fr.currentPopupAction.cancel(),Fr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return He(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=Uh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($n(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject($n(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($n(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Kw.get())};e()}}Fr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="pendingRedirect",vl=new Map;class Qw extends X0{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=vl.get(this.auth._key());if(!e){try{const n=await Zw(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}vl.set(this.auth._key(),e)}return this.bypassAuthState||vl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Zw(i,e){const t=nS(e),n=tS(i);if(!await n._isAvailable())return!1;const r=await n._get(t)==="true";return await n._remove(t),r}function eS(i,e){vl.set(i._key(),e)}function tS(i){return Ai(i._redirectPersistence)}function nS(i){return _l(Jw,i.config.apiKey,i.name)}async function iS(i,e,t=!1){if(In(i.app))return Promise.reject(Ci(i));const n=xr(i),r=q0(n,e),a=await new Qw(n,r,t).execute();return a&&!t&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=10*60*1e3;class sS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aS(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Y0(e)){const r=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError($n(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rS&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hf(e))}saveEventToCache(e){this.cachedEventUids.add(Hf(e)),this.lastProcessedEventTime=Date.now()}}function Hf(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function Y0({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function aS(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Y0(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(i,e={}){return Oi(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cS=/^https?/;async function uS(i){if(i.config.emulator)return;const{authorizedDomains:e}=await oS(i);for(const t of e)try{if(hS(t))return}catch{}Vn(i,"unauthorized-domain")}function hS(i){const e=Hu(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const a=new URL(i);return a.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===n}if(!cS.test(t))return!1;if(lS.test(i))return n===i;const r=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS=new mo(3e4,6e4);function Gf(){const i=ti().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function fS(i){return new Promise((e,t)=>{var n,r,s;function a(){Gf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Gf(),t($n(i,"network-request-failed"))},timeout:dS.get()})}if(!((r=(n=ti().gapi)===null||n===void 0?void 0:n.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=ti().gapi)===null||s===void 0)&&s.load)a();else{const o=sw("iframefcb");return ti()[o]=()=>{gapi.load?a():t($n(i,"network-request-failed"))},P0(`${rw()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw xl=null,e})}let xl=null;function pS(i){return xl=xl||fS(i),xl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=new mo(5e3,15e3),gS="__/auth/iframe",_S="emulator/auth/iframe",vS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yS(i){const e=i.config;He(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Ph(e,_S):`https://${i.config.authDomain}/${gS}`,n={apiKey:e.apiKey,appName:i.name,v:fa},r=xS.get(i.config.apiHost);r&&(n.eid=r);const s=i._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${po(n).slice(1)}`}async function bS(i){const e=await pS(i),t=ti().gapi;return He(t,i,"internal-error"),e.open({where:document.body,url:yS(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vS,dontclear:!0},n=>new Promise(async(r,s)=>{await n.restyle({setHideOnLeave:!1});const a=$n(i,"network-request-failed"),o=ti().setTimeout(()=>{s(a)},mS.get());function l(){ti().clearTimeout(o),r(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wS=500,SS=600,TS="_blank",AS="http://localhost";class Wf{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MS(i,e,t,n=wS,r=SS){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},ES),{width:n.toString(),height:r.toString(),top:s,left:a}),h=pn().toLowerCase();t&&(o=S0(h)?TS:t),E0(h)&&(e=e||AS,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(YE(h)&&o!=="_self")return RS(e||"",o),new Wf(null);const f=window.open(e||"",o,d);He(f,i,"popup-blocked");try{f.focus()}catch{}return new Wf(f)}function RS(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="__/auth/handler",IS="emulator/auth/handler",PS=encodeURIComponent("fac");async function qf(i,e,t,n,r,s){He(i.config.authDomain,i,"auth-domain-config-required"),He(i.config.apiKey,i,"invalid-api-key");const a={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:fa,eventId:r};if(e instanceof kh){e.setDefaultLanguage(i.languageCode),a.providerId=e.providerId||"",pb(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))a[d]=f}if(e instanceof _o){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}i.tenantId&&(a.tid=i.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await i._getAppCheckToken(),h=l?`#${PS}=${encodeURIComponent(l)}`:"";return`${NS(i)}?${po(o).slice(1)}${h}`}function NS({config:i}){return i.emulator?Ph(i,IS):`https://${i.authDomain}/${CS}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc="webStorageSupport";class LS{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=B0,this._completeRedirectFn=iS,this._overrideRedirectResult=eS}async _openPopup(e,t,n,r){var s;Pi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await qf(e,t,n,Hu(),r);return MS(e,a,Uh())}async _openRedirect(e,t,n,r){await this._originValidation(e);const s=await qf(e,t,n,Hu(),r);return Uw(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Pi(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await bS(e),n=new sS(e);return t.register("authEvent",r=>(He(r?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zc,{type:zc},r=>{var s;const a=(s=r?.[0])===null||s===void 0?void 0:s[zc];a!==void 0&&t(!!a),Vn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=uS(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return C0()||w0()||Lh()}}const DS=LS;var Xf="@firebase/auth",$f="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kS(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function US(i){Qs(new $r("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;He(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:I0(i)},h=new tw(n,r,s,l);return hw(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Qs(new $r("auth-internal",e=>{const t=xr(e.getProvider("auth").getImmediate());return(n=>new OS(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),nr(Xf,$f,kS(i)),nr(Xf,$f,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS=5*60,VS=a0("authIdTokenMaxAge")||FS;let Yf=null;const jS=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>VS)return;const r=t?.token;Yf!==r&&(Yf=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function BS(i=d0()){const e=Mh(i,"auth");if(e.isInitialized())return e.getImmediate();const t=uw(i,{popupRedirectResolver:DS,persistence:[qw,Dw,B0]}),n=a0("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=jS(s.toString());Iw(t,a,()=>a(t.currentUser)),Cw(t,o=>a(o))}}const r=r0("auth");return r&&dw(t,`http://${r}`),t}function zS(){var i,e;return(e=(i=document.getElementsByTagName("head"))===null||i===void 0?void 0:i[0])!==null&&e!==void 0?e:document}nw({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=r=>{const s=$n("internal-error");s.customData=r,t(s)},n.type="text/javascript",n.charset="UTF-8",zS().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});US("Browser");var Kf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ir,K0;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,A){function C(){}C.prototype=A.prototype,w.D=A.prototype,w.prototype=new C,w.prototype.constructor=w,w.C=function(x,E,O){for(var I=Array(arguments.length-2),j=2;j<arguments.length;j++)I[j-2]=arguments[j];return A.prototype[E].apply(x,I)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(w,A,C){C||(C=0);var x=Array(16);if(typeof A=="string")for(var E=0;16>E;++E)x[E]=A.charCodeAt(C++)|A.charCodeAt(C++)<<8|A.charCodeAt(C++)<<16|A.charCodeAt(C++)<<24;else for(E=0;16>E;++E)x[E]=A[C++]|A[C++]<<8|A[C++]<<16|A[C++]<<24;A=w.g[0],C=w.g[1],E=w.g[2];var O=w.g[3],I=A+(O^C&(E^O))+x[0]+3614090360&4294967295;A=C+(I<<7&4294967295|I>>>25),I=O+(E^A&(C^E))+x[1]+3905402710&4294967295,O=A+(I<<12&4294967295|I>>>20),I=E+(C^O&(A^C))+x[2]+606105819&4294967295,E=O+(I<<17&4294967295|I>>>15),I=C+(A^E&(O^A))+x[3]+3250441966&4294967295,C=E+(I<<22&4294967295|I>>>10),I=A+(O^C&(E^O))+x[4]+4118548399&4294967295,A=C+(I<<7&4294967295|I>>>25),I=O+(E^A&(C^E))+x[5]+1200080426&4294967295,O=A+(I<<12&4294967295|I>>>20),I=E+(C^O&(A^C))+x[6]+2821735955&4294967295,E=O+(I<<17&4294967295|I>>>15),I=C+(A^E&(O^A))+x[7]+4249261313&4294967295,C=E+(I<<22&4294967295|I>>>10),I=A+(O^C&(E^O))+x[8]+1770035416&4294967295,A=C+(I<<7&4294967295|I>>>25),I=O+(E^A&(C^E))+x[9]+2336552879&4294967295,O=A+(I<<12&4294967295|I>>>20),I=E+(C^O&(A^C))+x[10]+4294925233&4294967295,E=O+(I<<17&4294967295|I>>>15),I=C+(A^E&(O^A))+x[11]+2304563134&4294967295,C=E+(I<<22&4294967295|I>>>10),I=A+(O^C&(E^O))+x[12]+1804603682&4294967295,A=C+(I<<7&4294967295|I>>>25),I=O+(E^A&(C^E))+x[13]+4254626195&4294967295,O=A+(I<<12&4294967295|I>>>20),I=E+(C^O&(A^C))+x[14]+2792965006&4294967295,E=O+(I<<17&4294967295|I>>>15),I=C+(A^E&(O^A))+x[15]+1236535329&4294967295,C=E+(I<<22&4294967295|I>>>10),I=A+(E^O&(C^E))+x[1]+4129170786&4294967295,A=C+(I<<5&4294967295|I>>>27),I=O+(C^E&(A^C))+x[6]+3225465664&4294967295,O=A+(I<<9&4294967295|I>>>23),I=E+(A^C&(O^A))+x[11]+643717713&4294967295,E=O+(I<<14&4294967295|I>>>18),I=C+(O^A&(E^O))+x[0]+3921069994&4294967295,C=E+(I<<20&4294967295|I>>>12),I=A+(E^O&(C^E))+x[5]+3593408605&4294967295,A=C+(I<<5&4294967295|I>>>27),I=O+(C^E&(A^C))+x[10]+38016083&4294967295,O=A+(I<<9&4294967295|I>>>23),I=E+(A^C&(O^A))+x[15]+3634488961&4294967295,E=O+(I<<14&4294967295|I>>>18),I=C+(O^A&(E^O))+x[4]+3889429448&4294967295,C=E+(I<<20&4294967295|I>>>12),I=A+(E^O&(C^E))+x[9]+568446438&4294967295,A=C+(I<<5&4294967295|I>>>27),I=O+(C^E&(A^C))+x[14]+3275163606&4294967295,O=A+(I<<9&4294967295|I>>>23),I=E+(A^C&(O^A))+x[3]+4107603335&4294967295,E=O+(I<<14&4294967295|I>>>18),I=C+(O^A&(E^O))+x[8]+1163531501&4294967295,C=E+(I<<20&4294967295|I>>>12),I=A+(E^O&(C^E))+x[13]+2850285829&4294967295,A=C+(I<<5&4294967295|I>>>27),I=O+(C^E&(A^C))+x[2]+4243563512&4294967295,O=A+(I<<9&4294967295|I>>>23),I=E+(A^C&(O^A))+x[7]+1735328473&4294967295,E=O+(I<<14&4294967295|I>>>18),I=C+(O^A&(E^O))+x[12]+2368359562&4294967295,C=E+(I<<20&4294967295|I>>>12),I=A+(C^E^O)+x[5]+4294588738&4294967295,A=C+(I<<4&4294967295|I>>>28),I=O+(A^C^E)+x[8]+2272392833&4294967295,O=A+(I<<11&4294967295|I>>>21),I=E+(O^A^C)+x[11]+1839030562&4294967295,E=O+(I<<16&4294967295|I>>>16),I=C+(E^O^A)+x[14]+4259657740&4294967295,C=E+(I<<23&4294967295|I>>>9),I=A+(C^E^O)+x[1]+2763975236&4294967295,A=C+(I<<4&4294967295|I>>>28),I=O+(A^C^E)+x[4]+1272893353&4294967295,O=A+(I<<11&4294967295|I>>>21),I=E+(O^A^C)+x[7]+4139469664&4294967295,E=O+(I<<16&4294967295|I>>>16),I=C+(E^O^A)+x[10]+3200236656&4294967295,C=E+(I<<23&4294967295|I>>>9),I=A+(C^E^O)+x[13]+681279174&4294967295,A=C+(I<<4&4294967295|I>>>28),I=O+(A^C^E)+x[0]+3936430074&4294967295,O=A+(I<<11&4294967295|I>>>21),I=E+(O^A^C)+x[3]+3572445317&4294967295,E=O+(I<<16&4294967295|I>>>16),I=C+(E^O^A)+x[6]+76029189&4294967295,C=E+(I<<23&4294967295|I>>>9),I=A+(C^E^O)+x[9]+3654602809&4294967295,A=C+(I<<4&4294967295|I>>>28),I=O+(A^C^E)+x[12]+3873151461&4294967295,O=A+(I<<11&4294967295|I>>>21),I=E+(O^A^C)+x[15]+530742520&4294967295,E=O+(I<<16&4294967295|I>>>16),I=C+(E^O^A)+x[2]+3299628645&4294967295,C=E+(I<<23&4294967295|I>>>9),I=A+(E^(C|~O))+x[0]+4096336452&4294967295,A=C+(I<<6&4294967295|I>>>26),I=O+(C^(A|~E))+x[7]+1126891415&4294967295,O=A+(I<<10&4294967295|I>>>22),I=E+(A^(O|~C))+x[14]+2878612391&4294967295,E=O+(I<<15&4294967295|I>>>17),I=C+(O^(E|~A))+x[5]+4237533241&4294967295,C=E+(I<<21&4294967295|I>>>11),I=A+(E^(C|~O))+x[12]+1700485571&4294967295,A=C+(I<<6&4294967295|I>>>26),I=O+(C^(A|~E))+x[3]+2399980690&4294967295,O=A+(I<<10&4294967295|I>>>22),I=E+(A^(O|~C))+x[10]+4293915773&4294967295,E=O+(I<<15&4294967295|I>>>17),I=C+(O^(E|~A))+x[1]+2240044497&4294967295,C=E+(I<<21&4294967295|I>>>11),I=A+(E^(C|~O))+x[8]+1873313359&4294967295,A=C+(I<<6&4294967295|I>>>26),I=O+(C^(A|~E))+x[15]+4264355552&4294967295,O=A+(I<<10&4294967295|I>>>22),I=E+(A^(O|~C))+x[6]+2734768916&4294967295,E=O+(I<<15&4294967295|I>>>17),I=C+(O^(E|~A))+x[13]+1309151649&4294967295,C=E+(I<<21&4294967295|I>>>11),I=A+(E^(C|~O))+x[4]+4149444226&4294967295,A=C+(I<<6&4294967295|I>>>26),I=O+(C^(A|~E))+x[11]+3174756917&4294967295,O=A+(I<<10&4294967295|I>>>22),I=E+(A^(O|~C))+x[2]+718787259&4294967295,E=O+(I<<15&4294967295|I>>>17),I=C+(O^(E|~A))+x[9]+3951481745&4294967295,w.g[0]=w.g[0]+A&4294967295,w.g[1]=w.g[1]+(E+(I<<21&4294967295|I>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+O&4294967295}n.prototype.u=function(w,A){A===void 0&&(A=w.length);for(var C=A-this.blockSize,x=this.B,E=this.h,O=0;O<A;){if(E==0)for(;O<=C;)r(this,w,O),O+=this.blockSize;if(typeof w=="string"){for(;O<A;)if(x[E++]=w.charCodeAt(O++),E==this.blockSize){r(this,x),E=0;break}}else for(;O<A;)if(x[E++]=w[O++],E==this.blockSize){r(this,x),E=0;break}}this.h=E,this.o+=A},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var A=1;A<w.length-8;++A)w[A]=0;var C=8*this.o;for(A=w.length-8;A<w.length;++A)w[A]=C&255,C/=256;for(this.u(w),w=Array(16),A=C=0;4>A;++A)for(var x=0;32>x;x+=8)w[C++]=this.g[A]>>>x&255;return w};function s(w,A){var C=o;return Object.prototype.hasOwnProperty.call(C,w)?C[w]:C[w]=A(w)}function a(w,A){this.h=A;for(var C=[],x=!0,E=w.length-1;0<=E;E--){var O=w[E]|0;x&&O==A||(C[E]=O,x=!1)}this.g=C}var o={};function l(w){return-128<=w&&128>w?s(w,function(A){return new a([A|0],0>A?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return f;if(0>w)return m(h(-w));for(var A=[],C=1,x=0;w>=C;x++)A[x]=w/C|0,C*=4294967296;return new a(A,0)}function d(w,A){if(w.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(w.charAt(0)=="-")return m(d(w.substring(1),A));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=h(Math.pow(A,8)),x=f,E=0;E<w.length;E+=8){var O=Math.min(8,w.length-E),I=parseInt(w.substring(E,E+O),A);8>O?(O=h(Math.pow(A,O)),x=x.j(O).add(h(I))):(x=x.j(C),x=x.add(h(I)))}return x}var f=l(0),p=l(1),g=l(16777216);i=a.prototype,i.m=function(){if(T(this))return-m(this).m();for(var w=0,A=1,C=0;C<this.g.length;C++){var x=this.i(C);w+=(0<=x?x:4294967296+x)*A,A*=4294967296}return w},i.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(T(this))return"-"+m(this).toString(w);for(var A=h(Math.pow(w,6)),C=this,x="";;){var E=L(C,A).g;C=v(C,E.j(A));var O=((0<C.g.length?C.g[0]:C.h)>>>0).toString(w);if(C=E,y(C))return O+x;for(;6>O.length;)O="0"+O;x=O+x}},i.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var A=0;A<w.g.length;A++)if(w.g[A]!=0)return!1;return!0}function T(w){return w.h==-1}i.l=function(w){return w=v(this,w),T(w)?-1:y(w)?0:1};function m(w){for(var A=w.g.length,C=[],x=0;x<A;x++)C[x]=~w.g[x];return new a(C,~w.h).add(p)}i.abs=function(){return T(this)?m(this):this},i.add=function(w){for(var A=Math.max(this.g.length,w.g.length),C=[],x=0,E=0;E<=A;E++){var O=x+(this.i(E)&65535)+(w.i(E)&65535),I=(O>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);x=I>>>16,O&=65535,I&=65535,C[E]=I<<16|O}return new a(C,C[C.length-1]&-2147483648?-1:0)};function v(w,A){return w.add(m(A))}i.j=function(w){if(y(this)||y(w))return f;if(T(this))return T(w)?m(this).j(m(w)):m(m(this).j(w));if(T(w))return m(this.j(m(w)));if(0>this.l(g)&&0>w.l(g))return h(this.m()*w.m());for(var A=this.g.length+w.g.length,C=[],x=0;x<2*A;x++)C[x]=0;for(x=0;x<this.g.length;x++)for(var E=0;E<w.g.length;E++){var O=this.i(x)>>>16,I=this.i(x)&65535,j=w.i(E)>>>16,te=w.i(E)&65535;C[2*x+2*E]+=I*te,M(C,2*x+2*E),C[2*x+2*E+1]+=O*te,M(C,2*x+2*E+1),C[2*x+2*E+1]+=I*j,M(C,2*x+2*E+1),C[2*x+2*E+2]+=O*j,M(C,2*x+2*E+2)}for(x=0;x<A;x++)C[x]=C[2*x+1]<<16|C[2*x];for(x=A;x<2*A;x++)C[x]=0;return new a(C,0)};function M(w,A){for(;(w[A]&65535)!=w[A];)w[A+1]+=w[A]>>>16,w[A]&=65535,A++}function S(w,A){this.g=w,this.h=A}function L(w,A){if(y(A))throw Error("division by zero");if(y(w))return new S(f,f);if(T(w))return A=L(m(w),A),new S(m(A.g),m(A.h));if(T(A))return A=L(w,m(A)),new S(m(A.g),A.h);if(30<w.g.length){if(T(w)||T(A))throw Error("slowDivide_ only works with positive integers.");for(var C=p,x=A;0>=x.l(w);)C=V(C),x=V(x);var E=k(C,1),O=k(x,1);for(x=k(x,2),C=k(C,2);!y(x);){var I=O.add(x);0>=I.l(w)&&(E=E.add(C),O=I),x=k(x,1),C=k(C,1)}return A=v(w,E.j(A)),new S(E,A)}for(E=f;0<=w.l(A);){for(C=Math.max(1,Math.floor(w.m()/A.m())),x=Math.ceil(Math.log(C)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),O=h(C),I=O.j(A);T(I)||0<I.l(w);)C-=x,O=h(C),I=O.j(A);y(O)&&(O=p),E=E.add(O),w=v(w,I)}return new S(E,w)}i.A=function(w){return L(this,w).h},i.and=function(w){for(var A=Math.max(this.g.length,w.g.length),C=[],x=0;x<A;x++)C[x]=this.i(x)&w.i(x);return new a(C,this.h&w.h)},i.or=function(w){for(var A=Math.max(this.g.length,w.g.length),C=[],x=0;x<A;x++)C[x]=this.i(x)|w.i(x);return new a(C,this.h|w.h)},i.xor=function(w){for(var A=Math.max(this.g.length,w.g.length),C=[],x=0;x<A;x++)C[x]=this.i(x)^w.i(x);return new a(C,this.h^w.h)};function V(w){for(var A=w.g.length+1,C=[],x=0;x<A;x++)C[x]=w.i(x)<<1|w.i(x-1)>>>31;return new a(C,w.h)}function k(w,A){var C=A>>5;A%=32;for(var x=w.g.length-C,E=[],O=0;O<x;O++)E[O]=0<A?w.i(O+C)>>>A|w.i(O+C+1)<<32-A:w.i(O+C);return new a(E,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,K0=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,ir=a}).apply(typeof Kf<"u"?Kf:typeof self<"u"?self:typeof window<"u"?window:{});var jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var J0,Ba,Q0,yl,Xu,Z0,e_,t_;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,_,b){return u==Array.prototype||u==Object.prototype||(u[_]=b.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof jo=="object"&&jo];for(var _=0;_<u.length;++_){var b=u[_];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var n=t(this);function r(u,_){if(_)e:{var b=n;u=u.split(".");for(var P=0;P<u.length-1;P++){var z=u[P];if(!(z in b))break e;b=b[z]}u=u[u.length-1],P=b[u],_=_(P),_!=P&&_!=null&&e(b,u,{configurable:!0,writable:!0,value:_})}}function s(u,_){u instanceof String&&(u+="");var b=0,P=!1,z={next:function(){if(!P&&b<u.length){var K=b++;return{value:_(K,u[K]),done:!1}}return P=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}r("Array.prototype.values",function(u){return u||function(){return s(this,function(_,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var _=typeof u;return _=_!="object"?_:u?Array.isArray(u)?"array":_:"null",_=="array"||_=="object"&&typeof u.length=="number"}function h(u){var _=typeof u;return _=="object"&&u!=null||_=="function"}function d(u,_,b){return u.call.apply(u.bind,arguments)}function f(u,_,b){if(!u)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(z,P),u.apply(_,z)}}return function(){return u.apply(_,arguments)}}function p(u,_,b){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function g(u,_){var b=Array.prototype.slice.call(arguments,1);return function(){var P=b.slice();return P.push.apply(P,arguments),u.apply(this,P)}}function y(u,_){function b(){}b.prototype=_.prototype,u.aa=_.prototype,u.prototype=new b,u.prototype.constructor=u,u.Qb=function(P,z,K){for(var _e=Array(arguments.length-2),Tt=2;Tt<arguments.length;Tt++)_e[Tt-2]=arguments[Tt];return _.prototype[z].apply(P,_e)}}function T(u){const _=u.length;if(0<_){const b=Array(_);for(let P=0;P<_;P++)b[P]=u[P];return b}return[]}function m(u,_){for(let b=1;b<arguments.length;b++){const P=arguments[b];if(l(P)){const z=u.length||0,K=P.length||0;u.length=z+K;for(let _e=0;_e<K;_e++)u[z+_e]=P[_e]}else u.push(P)}}class v{constructor(_,b){this.i=_,this.j=b,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function M(u){return/^[\s\xa0]*$/.test(u)}function S(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function L(u){return L[" "](u),u}L[" "]=function(){};var V=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function k(u,_,b){for(const P in u)_.call(b,u[P],P,u)}function w(u,_){for(const b in u)_.call(void 0,u[b],b,u)}function A(u){const _={};for(const b in u)_[b]=u[b];return _}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(u,_){let b,P;for(let z=1;z<arguments.length;z++){P=arguments[z];for(b in P)u[b]=P[b];for(let K=0;K<C.length;K++)b=C[K],Object.prototype.hasOwnProperty.call(P,b)&&(u[b]=P[b])}}function E(u){var _=1;u=u.split(":");const b=[];for(;0<_&&u.length;)b.push(u.shift()),_--;return u.length&&b.push(u.join(":")),b}function O(u){o.setTimeout(()=>{throw u},0)}function I(){var u=ie;let _=null;return u.g&&(_=u.g,u.g=u.g.next,u.g||(u.h=null),_.next=null),_}class j{constructor(){this.h=this.g=null}add(_,b){const P=te.get();P.set(_,b),this.h?this.h.next=P:this.g=P,this.h=P}}var te=new v(()=>new Z,u=>u.reset());class Z{constructor(){this.next=this.g=this.h=null}set(_,b){this.h=_,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,ee=!1,ie=new j,pe=()=>{const u=o.Promise.resolve(void 0);ne=()=>{u.then(ge)}};var ge=()=>{for(var u;u=I();){try{u.h.call(u.g)}catch(b){O(b)}var _=te;_.j(u),100>_.h&&(_.h++,u.next=_.g,_.g=u)}ee=!1};function be(){this.s=this.s,this.C=this.C}be.prototype.s=!1,be.prototype.ma=function(){this.s||(this.s=!0,this.N())},be.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Re(u,_){this.type=u,this.g=this.target=_,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,_=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const b=()=>{};o.addEventListener("test",b,_),o.removeEventListener("test",b,_)}catch{}return u}();function ue(u,_){if(Re.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var b=this.type=u.type,P=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=_,_=u.relatedTarget){if(V){e:{try{L(_.nodeName);var z=!0;break e}catch{}z=!1}z||(_=null)}}else b=="mouseover"?_=u.fromElement:b=="mouseout"&&(_=u.toElement);this.relatedTarget=_,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Se[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&ue.aa.h.call(this)}}y(ue,Re);var Se={2:"touch",3:"pen",4:"mouse"};ue.prototype.h=function(){ue.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var je="closure_listenable_"+(1e6*Math.random()|0),Oe=0;function Te(u,_,b,P,z){this.listener=u,this.proxy=null,this.src=_,this.type=b,this.capture=!!P,this.ha=z,this.key=++Oe,this.da=this.fa=!1}function ht(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ve(u){this.src=u,this.g={},this.h=0}Ve.prototype.add=function(u,_,b,P,z){var K=u.toString();u=this.g[K],u||(u=this.g[K]=[],this.h++);var _e=Nt(u,_,P,z);return-1<_e?(_=u[_e],b||(_.fa=!1)):(_=new Te(_,this.src,K,!!P,z),_.fa=b,u.push(_)),_};function H(u,_){var b=_.type;if(b in u.g){var P=u.g[b],z=Array.prototype.indexOf.call(P,_,void 0),K;(K=0<=z)&&Array.prototype.splice.call(P,z,1),K&&(ht(_),u.g[b].length==0&&(delete u.g[b],u.h--))}}function Nt(u,_,b,P){for(var z=0;z<u.length;++z){var K=u[z];if(!K.da&&K.listener==_&&K.capture==!!b&&K.ha==P)return z}return-1}var De="closure_lm_"+(1e6*Math.random()|0),$e={};function Ue(u,_,b,P,z){if(Array.isArray(_)){for(var K=0;K<_.length;K++)Ue(u,_[K],b,P,z);return null}return b=he(b),u&&u[je]?u.K(_,b,h(P)?!!P.capture:!1,z):ut(u,_,b,!1,P,z)}function ut(u,_,b,P,z,K){if(!_)throw Error("Invalid event type");var _e=h(z)?!!z.capture:!!z,Tt=Q(u);if(Tt||(u[De]=Tt=new Ve(u)),b=Tt.add(_,b,P,_e,K),b.proxy)return b;if(P=Qe(),b.proxy=P,P.src=u,P.listener=b,u.addEventListener)J||(z=_e),z===void 0&&(z=!1),u.addEventListener(_.toString(),P,z);else if(u.attachEvent)u.attachEvent(D(_.toString()),P);else if(u.addListener&&u.removeListener)u.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return b}function Qe(){function u(b){return _.call(u.src,u.listener,b)}const _=R;return u}function Ze(u,_,b,P,z){if(Array.isArray(_))for(var K=0;K<_.length;K++)Ze(u,_[K],b,P,z);else P=h(P)?!!P.capture:!!P,b=he(b),u&&u[je]?(u=u.i,_=String(_).toString(),_ in u.g&&(K=u.g[_],b=Nt(K,b,P,z),-1<b&&(ht(K[b]),Array.prototype.splice.call(K,b,1),K.length==0&&(delete u.g[_],u.h--)))):u&&(u=Q(u))&&(_=u.g[_.toString()],u=-1,_&&(u=Nt(_,b,P,z)),(b=-1<u?_[u]:null)&&xt(b))}function xt(u){if(typeof u!="number"&&u&&!u.da){var _=u.src;if(_&&_[je])H(_.i,u);else{var b=u.type,P=u.proxy;_.removeEventListener?_.removeEventListener(b,P,u.capture):_.detachEvent?_.detachEvent(D(b),P):_.addListener&&_.removeListener&&_.removeListener(P),(b=Q(_))?(H(b,u),b.h==0&&(b.src=null,_[De]=null)):ht(u)}}}function D(u){return u in $e?$e[u]:$e[u]="on"+u}function R(u,_){if(u.da)u=!0;else{_=new ue(_,this);var b=u.listener,P=u.ha||u.src;u.fa&&xt(u),u=b.call(P,_)}return u}function Q(u){return u=u[De],u instanceof Ve?u:null}var re="__closure_events_fn_"+(1e9*Math.random()>>>0);function he(u){return typeof u=="function"?u:(u[re]||(u[re]=function(_){return u.handleEvent(_)}),u[re])}function se(){be.call(this),this.i=new Ve(this),this.M=this,this.F=null}y(se,be),se.prototype[je]=!0,se.prototype.removeEventListener=function(u,_,b,P){Ze(this,u,_,b,P)};function Ce(u,_){var b,P=u.F;if(P)for(b=[];P;P=P.F)b.push(P);if(u=u.M,P=_.type||_,typeof _=="string")_=new Re(_,u);else if(_ instanceof Re)_.target=_.target||u;else{var z=_;_=new Re(P,u),x(_,z)}if(z=!0,b)for(var K=b.length-1;0<=K;K--){var _e=_.g=b[K];z=ke(_e,P,!0,_)&&z}if(_e=_.g=u,z=ke(_e,P,!0,_)&&z,z=ke(_e,P,!1,_)&&z,b)for(K=0;K<b.length;K++)_e=_.g=b[K],z=ke(_e,P,!1,_)&&z}se.prototype.N=function(){if(se.aa.N.call(this),this.i){var u=this.i,_;for(_ in u.g){for(var b=u.g[_],P=0;P<b.length;P++)ht(b[P]);delete u.g[_],u.h--}}this.F=null},se.prototype.K=function(u,_,b,P){return this.i.add(String(u),_,!1,b,P)},se.prototype.L=function(u,_,b,P){return this.i.add(String(u),_,!0,b,P)};function ke(u,_,b,P){if(_=u.i.g[String(_)],!_)return!0;_=_.concat();for(var z=!0,K=0;K<_.length;++K){var _e=_[K];if(_e&&!_e.da&&_e.capture==b){var Tt=_e.listener,en=_e.ha||_e.src;_e.fa&&H(u.i,_e),z=Tt.call(en,P)!==!1&&z}}return z&&!P.defaultPrevented}function me(u,_,b){if(typeof u=="function")b&&(u=p(u,b));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(u,_||0)}function xe(u){u.g=me(()=>{u.g=null,u.i&&(u.i=!1,xe(u))},u.l);const _=u.h;u.h=null,u.m.apply(null,_)}class Ye extends be{constructor(_,b){super(),this.m=_,this.l=b,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fe(u){be.call(this),this.h=u,this.g={}}y(fe,be);var Mt=[];function nt(u){k(u.g,function(_,b){this.g.hasOwnProperty(b)&&xt(_)},u),u.g={}}fe.prototype.N=function(){fe.aa.N.call(this),nt(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ie=o.JSON.stringify,Ae=o.JSON.parse,Pe=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function U(){}U.prototype.h=null;function ae(u){return u.h||(u.h=u.i())}function Me(){}var F={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function de(){Re.call(this,"d")}y(de,Re);function W(){Re.call(this,"c")}y(W,Re);var le={},ye=null;function et(){return ye=ye||new se}le.La="serverreachability";function gt(u){Re.call(this,le.La,u)}y(gt,Re);function mt(u){const _=et();Ce(_,new gt(_))}le.STAT_EVENT="statevent";function Rt(u,_){Re.call(this,le.STAT_EVENT,u),this.stat=_}y(Rt,Re);function We(u){const _=et();Ce(_,new Rt(_,u))}le.Ma="timingevent";function Et(u,_){Re.call(this,le.Ma,u),this.size=_}y(Et,Re);function Ot(u,_){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},_)}function Sn(){this.g=!0}Sn.prototype.xa=function(){this.g=!1};function cs(u,_,b,P,z,K){u.info(function(){if(u.g)if(K)for(var _e="",Tt=K.split("&"),en=0;en<Tt.length;en++){var _t=Tt[en].split("=");if(1<_t.length){var on=_t[0];_t=_t[1];var ln=on.split("_");_e=2<=ln.length&&ln[1]=="type"?_e+(on+"="+_t+"&"):_e+(on+"=redacted&")}}else _e=null;else _e=K;return"XMLHTTP REQ ("+P+") [attempt "+z+"]: "+_+`
`+b+`
`+_e})}function us(u,_,b,P,z,K,_e){u.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+z+"]: "+_+`
`+b+`
`+K+" "+_e})}function pi(u,_,b,P){u.info(function(){return"XMLHTTP TEXT ("+_+"): "+Ro(u,b)+(P?" "+P:"")})}function hs(u,_){u.info(function(){return"TIMEOUT: "+_})}Sn.prototype.info=function(){};function Ro(u,_){if(!u.g)return _;if(!_)return null;try{var b=JSON.parse(_);if(b){for(u=0;u<b.length;u++)if(Array.isArray(b[u])){var P=b[u];if(!(2>P.length)){var z=P[1];if(Array.isArray(z)&&!(1>z.length)){var K=z[0];if(K!="noop"&&K!="stop"&&K!="close")for(var _e=1;_e<z.length;_e++)z[_e]=""}}}}return Ie(b)}catch{return _}}var wr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Co={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ea;function ds(){}y(ds,U),ds.prototype.g=function(){return new XMLHttpRequest},ds.prototype.i=function(){return{}},Ea=new ds;function N(u,_,b,P){this.j=u,this.i=_,this.l=b,this.R=P||1,this.U=new fe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new B}function B(){this.i=null,this.g="",this.h=!1}var $={},Y={};function X(u,_,b){u.L=1,u.v=Io(Tn(_)),u.m=b,u.P=!0,Ee(u,null)}function Ee(u,_){u.F=Date.now(),ze(u),u.A=Tn(u.v);var b=u.A,P=u.R;Array.isArray(P)||(P=[String(P)]),Fd(b.i,"t",P),u.C=0,b=u.j.J,u.h=new B,u.g=nf(u.j,b?_:null,!u.m),0<u.O&&(u.M=new Ye(p(u.Y,u,u.g),u.O)),_=u.U,b=u.g,P=u.ca;var z="readystatechange";Array.isArray(z)||(z&&(Mt[0]=z.toString()),z=Mt);for(var K=0;K<z.length;K++){var _e=Ue(b,z[K],P||_.handleEvent,!1,_.h||_);if(!_e)break;_.g[_e.key]=_e}_=u.H?A(u.H):{},u.m?(u.u||(u.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,_)):(u.u="GET",u.g.ea(u.A,u.u,null,_)),mt(),cs(u.i,u.u,u.A,u.l,u.R,u.m)}N.prototype.ca=function(u){u=u.target;const _=this.M;_&&mi(u)==3?_.j():this.Y(u)},N.prototype.Y=function(u){try{if(u==this.g)e:{const ln=mi(this.g);var _=this.g.Ba();const gs=this.g.Z();if(!(3>ln)&&(ln!=3||this.g&&(this.h.h||this.g.oa()||Wd(this.g)))){this.J||ln!=4||_==7||(_==8||0>=gs?mt(3):mt(2)),Xe(this);var b=this.g.Z();this.X=b;t:if(Ne(this)){var P=Wd(this.g);u="";var z=P.length,K=mi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yt(this),qe(this);var _e="";break t}this.h.i=new o.TextDecoder}for(_=0;_<z;_++)this.h.h=!0,u+=this.h.i.decode(P[_],{stream:!(K&&_==z-1)});P.length=0,this.h.g+=u,this.C=0,_e=this.h.g}else _e=this.g.oa();if(this.o=b==200,us(this.i,this.u,this.A,this.l,this.R,ln,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Tt,en=this.g;if((Tt=en.g?en.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(Tt)){var _t=Tt;break t}}_t=null}if(b=_t)pi(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zt(this,b);else{this.o=!1,this.s=3,We(12),yt(this),qe(this);break e}}if(this.P){b=!0;let jn;for(;!this.J&&this.C<_e.length;)if(jn=Be(this,_e),jn==Y){ln==4&&(this.s=4,We(14),b=!1),pi(this.i,this.l,null,"[Incomplete Response]");break}else if(jn==$){this.s=4,We(15),pi(this.i,this.l,_e,"[Invalid Chunk]"),b=!1;break}else pi(this.i,this.l,jn,null),Zt(this,jn);if(Ne(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ln!=4||_e.length!=0||this.h.h||(this.s=1,We(16),b=!1),this.o=this.o&&b,!b)pi(this.i,this.l,_e,"[Invalid Chunked Response]"),yt(this),qe(this);else if(0<_e.length&&!this.W){this.W=!0;var on=this.j;on.g==this&&on.ba&&!on.M&&(on.j.info("Great, no buffering proxy detected. Bytes received: "+_e.length),Lc(on),on.M=!0,We(11))}}else pi(this.i,this.l,_e,null),Zt(this,_e);ln==4&&yt(this),this.o&&!this.J&&(ln==4?Qd(this.j,this):(this.o=!1,ze(this)))}else Ax(this.g),b==400&&0<_e.indexOf("Unknown SID")?(this.s=3,We(12)):(this.s=0,We(13)),yt(this),qe(this)}}}catch{}finally{}};function Ne(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Be(u,_){var b=u.C,P=_.indexOf(`
`,b);return P==-1?Y:(b=Number(_.substring(b,P)),isNaN(b)?$:(P+=1,P+b>_.length?Y:(_=_.slice(P,P+b),u.C=P+b,_)))}N.prototype.cancel=function(){this.J=!0,yt(this)};function ze(u){u.S=Date.now()+u.I,it(u,u.I)}function it(u,_){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ot(p(u.ba,u),_)}function Xe(u){u.B&&(o.clearTimeout(u.B),u.B=null)}N.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(hs(this.i,this.A),this.L!=2&&(mt(),We(17)),yt(this),this.s=2,qe(this)):it(this,this.S-u)};function qe(u){u.j.G==0||u.J||Qd(u.j,u)}function yt(u){Xe(u);var _=u.M;_&&typeof _.ma=="function"&&_.ma(),u.M=null,nt(u.U),u.g&&(_=u.g,u.g=null,_.abort(),_.ma())}function Zt(u,_){try{var b=u.j;if(b.G!=0&&(b.g==u||Sr(b.h,u))){if(!u.K&&Sr(b.h,u)&&b.G==3){try{var P=b.Da.g.parse(_)}catch{P=null}if(Array.isArray(P)&&P.length==3){var z=P;if(z[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<u.F)ko(b),Do(b);else break e;Nc(b),We(18)}}else b.za=z[1],0<b.za-b.T&&37500>z[2]&&b.F&&b.v==0&&!b.C&&(b.C=Ot(p(b.Za,b),6e3));if(1>=tt(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else Mr(b,11)}else if((u.K||b.g==u)&&ko(b),!M(_))for(z=b.Da.g.parse(_),_=0;_<z.length;_++){let _t=z[_];if(b.T=_t[0],_t=_t[1],b.G==2)if(_t[0]=="c"){b.K=_t[1],b.ia=_t[2];const on=_t[3];on!=null&&(b.la=on,b.j.info("VER="+b.la));const ln=_t[4];ln!=null&&(b.Aa=ln,b.j.info("SVER="+b.Aa));const gs=_t[5];gs!=null&&typeof gs=="number"&&0<gs&&(P=1.5*gs,b.L=P,b.j.info("backChannelRequestTimeoutMs_="+P)),P=b;const jn=u.g;if(jn){const Fo=jn.g?jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fo){var K=P.h;K.g||Fo.indexOf("spdy")==-1&&Fo.indexOf("quic")==-1&&Fo.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(wt(K,K.h),K.h=null))}if(P.D){const Dc=jn.g?jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Dc&&(P.ya=Dc,Ct(P.I,P.D,Dc))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-u.F,b.j.info("Handshake RTT: "+b.R+"ms")),P=b;var _e=u;if(P.qa=tf(P,P.J?P.ia:null,P.W),_e.K){Yn(P.h,_e);var Tt=_e,en=P.L;en&&(Tt.I=en),Tt.B&&(Xe(Tt),ze(Tt)),P.g=_e}else Kd(P);0<b.i.length&&Oo(b)}else _t[0]!="stop"&&_t[0]!="close"||Mr(b,7);else b.G==3&&(_t[0]=="stop"||_t[0]=="close"?_t[0]=="stop"?Mr(b,7):Pc(b):_t[0]!="noop"&&b.l&&b.l.ta(_t),b.v=0)}}mt(4)}catch{}}var Ft=class{constructor(u,_){this.g=u,this.map=_}};function Ln(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function At(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function tt(u){return u.h?1:u.g?u.g.size:0}function Sr(u,_){return u.h?u.h==_:u.g?u.g.has(_):!1}function wt(u,_){u.g?u.g.add(_):u.h=_}function Yn(u,_){u.h&&u.h==_?u.h=null:u.g&&u.g.has(_)&&u.g.delete(_)}Ln.prototype.cancel=function(){if(this.i=wa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function wa(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let _=u.i;for(const b of u.g.values())_=_.concat(b.D);return _}return T(u.i)}function Tr(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var _=[],b=u.length,P=0;P<b;P++)_.push(u[P]);return _}_=[],b=0;for(P in u)_[b++]=u[P];return _}function Sa(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var _=[];u=u.length;for(var b=0;b<u;b++)_.push(b);return _}_=[],b=0;for(const P in u)_[b++]=P;return _}}}function Gt(u,_){if(u.forEach&&typeof u.forEach=="function")u.forEach(_,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,_,void 0);else for(var b=Sa(u),P=Tr(u),z=P.length,K=0;K<z;K++)_.call(void 0,P[K],b&&b[K],u)}var Kn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ta(u,_){if(u){u=u.split("&");for(var b=0;b<u.length;b++){var P=u[b].indexOf("="),z=null;if(0<=P){var K=u[b].substring(0,P);z=u[b].substring(P+1)}else K=u[b];_(K,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function Vt(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Vt){this.h=u.h,fs(this,u.j),this.o=u.o,this.g=u.g,Ar(this,u.s),this.l=u.l;var _=u.i,b=new Ra;b.i=_.i,_.g&&(b.g=new Map(_.g),b.h=_.h),Dd(this,b),this.m=u.m}else u&&(_=String(u).match(Kn))?(this.h=!1,fs(this,_[1]||"",!0),this.o=Aa(_[2]||""),this.g=Aa(_[3]||"",!0),Ar(this,_[4]),this.l=Aa(_[5]||"",!0),Dd(this,_[6]||"",!0),this.m=Aa(_[7]||"")):(this.h=!1,this.i=new Ra(null,this.h))}Vt.prototype.toString=function(){var u=[],_=this.j;_&&u.push(Ma(_,Od,!0),":");var b=this.g;return(b||_=="file")&&(u.push("//"),(_=this.o)&&u.push(Ma(_,Od,!0),"@"),u.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&u.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&u.push("/"),u.push(Ma(b,b.charAt(0)=="/"?gx:mx,!0))),(b=this.i.toString())&&u.push("?",b),(b=this.m)&&u.push("#",Ma(b,vx)),u.join("")};function Tn(u){return new Vt(u)}function fs(u,_,b){u.j=b?Aa(_,!0):_,u.j&&(u.j=u.j.replace(/:$/,""))}function Ar(u,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);u.s=_}else u.s=null}function Dd(u,_,b){_ instanceof Ra?(u.i=_,xx(u.i,u.h)):(b||(_=Ma(_,_x)),u.i=new Ra(_,u.h))}function Ct(u,_,b){u.i.set(_,b)}function Io(u){return Ct(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Aa(u,_){return u?_?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ma(u,_,b){return typeof u=="string"?(u=encodeURI(u).replace(_,px),b&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function px(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Od=/[#\/\?@]/g,mx=/[#\?:]/g,gx=/[#\?]/g,_x=/[#\?@]/g,vx=/#/g;function Ra(u,_){this.h=this.g=null,this.i=u||null,this.j=!!_}function ki(u){u.g||(u.g=new Map,u.h=0,u.i&&Ta(u.i,function(_,b){u.add(decodeURIComponent(_.replace(/\+/g," ")),b)}))}i=Ra.prototype,i.add=function(u,_){ki(this),this.i=null,u=ps(this,u);var b=this.g.get(u);return b||this.g.set(u,b=[]),b.push(_),this.h+=1,this};function kd(u,_){ki(u),_=ps(u,_),u.g.has(_)&&(u.i=null,u.h-=u.g.get(_).length,u.g.delete(_))}function Ud(u,_){return ki(u),_=ps(u,_),u.g.has(_)}i.forEach=function(u,_){ki(this),this.g.forEach(function(b,P){b.forEach(function(z){u.call(_,z,P,this)},this)},this)},i.na=function(){ki(this);const u=Array.from(this.g.values()),_=Array.from(this.g.keys()),b=[];for(let P=0;P<_.length;P++){const z=u[P];for(let K=0;K<z.length;K++)b.push(_[P])}return b},i.V=function(u){ki(this);let _=[];if(typeof u=="string")Ud(this,u)&&(_=_.concat(this.g.get(ps(this,u))));else{u=Array.from(this.g.values());for(let b=0;b<u.length;b++)_=_.concat(u[b])}return _},i.set=function(u,_){return ki(this),this.i=null,u=ps(this,u),Ud(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[_]),this.h+=1,this},i.get=function(u,_){return u?(u=this.V(u),0<u.length?String(u[0]):_):_};function Fd(u,_,b){kd(u,_),0<b.length&&(u.i=null,u.g.set(ps(u,_),T(b)),u.h+=b.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],_=Array.from(this.g.keys());for(var b=0;b<_.length;b++){var P=_[b];const K=encodeURIComponent(String(P)),_e=this.V(P);for(P=0;P<_e.length;P++){var z=K;_e[P]!==""&&(z+="="+encodeURIComponent(String(_e[P]))),u.push(z)}}return this.i=u.join("&")};function ps(u,_){return _=String(_),u.j&&(_=_.toLowerCase()),_}function xx(u,_){_&&!u.j&&(ki(u),u.i=null,u.g.forEach(function(b,P){var z=P.toLowerCase();P!=z&&(kd(this,P),Fd(this,z,b))},u)),u.j=_}function yx(u,_){const b=new Sn;if(o.Image){const P=new Image;P.onload=g(Ui,b,"TestLoadImage: loaded",!0,_,P),P.onerror=g(Ui,b,"TestLoadImage: error",!1,_,P),P.onabort=g(Ui,b,"TestLoadImage: abort",!1,_,P),P.ontimeout=g(Ui,b,"TestLoadImage: timeout",!1,_,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=u}else _(!1)}function bx(u,_){const b=new Sn,P=new AbortController,z=setTimeout(()=>{P.abort(),Ui(b,"TestPingServer: timeout",!1,_)},1e4);fetch(u,{signal:P.signal}).then(K=>{clearTimeout(z),K.ok?Ui(b,"TestPingServer: ok",!0,_):Ui(b,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(z),Ui(b,"TestPingServer: error",!1,_)})}function Ui(u,_,b,P,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),P(b)}catch{}}function Ex(){this.g=new Pe}function wx(u,_,b){const P=b||"";try{Gt(u,function(z,K){let _e=z;h(z)&&(_e=Ie(z)),_.push(P+K+"="+encodeURIComponent(_e))})}catch(z){throw _.push(P+"type="+encodeURIComponent("_badmap")),z}}function Po(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Po,U),Po.prototype.g=function(){return new No(this.l,this.j)},Po.prototype.i=function(u){return function(){return u}}({});function No(u,_){se.call(this),this.D=u,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(No,se),i=No.prototype,i.open=function(u,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=_,this.readyState=1,Ia(this)},i.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(_.body=u),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ca(this)),this.readyState=0},i.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ia(this)),this.g&&(this.readyState=3,Ia(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vd(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vd(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}i.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var _=u.value?u.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!u.done}))&&(this.response=this.responseText+=_)}u.done?Ca(this):Ia(this),this.readyState==3&&Vd(this)}},i.Ra=function(u){this.g&&(this.response=this.responseText=u,Ca(this))},i.Qa=function(u){this.g&&(this.response=u,Ca(this))},i.ga=function(){this.g&&Ca(this)};function Ca(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ia(u)}i.setRequestHeader=function(u,_){this.u.append(u,_)},i.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],_=this.h.entries();for(var b=_.next();!b.done;)b=b.value,u.push(b[0]+": "+b[1]),b=_.next();return u.join(`\r
`)};function Ia(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(No.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function jd(u){let _="";return k(u,function(b,P){_+=P,_+=":",_+=b,_+=`\r
`}),_}function Ic(u,_,b){e:{for(P in b){var P=!1;break e}P=!0}P||(b=jd(b),typeof u=="string"?b!=null&&encodeURIComponent(String(b)):Ct(u,_,b))}function kt(u){se.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(kt,se);var Sx=/^https?$/i,Tx=["POST","PUT"];i=kt.prototype,i.Ha=function(u){this.J=u},i.ea=function(u,_,b,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);_=_?_.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ea.g(),this.v=this.o?ae(this.o):ae(Ea),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(_,String(u),!0),this.B=!1}catch(K){Bd(this,K);return}if(u=b||"",b=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var z in P)b.set(z,P[z]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const K of P.keys())b.set(K,P.get(K));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(b.keys()).find(K=>K.toLowerCase()=="content-type"),z=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Tx,_,void 0))||P||z||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,_e]of b)this.g.setRequestHeader(K,_e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gd(this),this.u=!0,this.g.send(u),this.u=!1}catch(K){Bd(this,K)}};function Bd(u,_){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=_,u.m=5,zd(u),Lo(u)}function zd(u){u.A||(u.A=!0,Ce(u,"complete"),Ce(u,"error"))}i.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ce(this,"complete"),Ce(this,"abort"),Lo(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Lo(this,!0)),kt.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?Hd(this):this.bb())},i.bb=function(){Hd(this)};function Hd(u){if(u.h&&typeof a<"u"&&(!u.v[1]||mi(u)!=4||u.Z()!=2)){if(u.u&&mi(u)==4)me(u.Ea,0,u);else if(Ce(u,"readystatechange"),mi(u)==4){u.h=!1;try{const _e=u.Z();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var b;if(!(b=_)){var P;if(P=_e===0){var z=String(u.D).match(Kn)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),P=!Sx.test(z?z.toLowerCase():"")}b=P}if(b)Ce(u,"complete"),Ce(u,"success");else{u.m=6;try{var K=2<mi(u)?u.g.statusText:""}catch{K=""}u.l=K+" ["+u.Z()+"]",zd(u)}}finally{Lo(u)}}}}function Lo(u,_){if(u.g){Gd(u);const b=u.g,P=u.v[0]?()=>{}:null;u.g=null,u.v=null,_||Ce(u,"ready");try{b.onreadystatechange=P}catch{}}}function Gd(u){u.I&&(o.clearTimeout(u.I),u.I=null)}i.isActive=function(){return!!this.g};function mi(u){return u.g?u.g.readyState:0}i.Z=function(){try{return 2<mi(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(u){if(this.g){var _=this.g.responseText;return u&&_.indexOf(u)==0&&(_=_.substring(u.length)),Ae(_)}};function Wd(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ax(u){const _={};u=(u.g&&2<=mi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<u.length;P++){if(M(u[P]))continue;var b=E(u[P]);const z=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const K=_[z]||[];_[z]=K,K.push(b)}w(_,function(P){return P.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pa(u,_,b){return b&&b.internalChannelParams&&b.internalChannelParams[u]||_}function qd(u){this.Aa=0,this.i=[],this.j=new Sn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pa("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pa("baseRetryDelayMs",5e3,u),this.cb=Pa("retryDelaySeedMs",1e4,u),this.Wa=Pa("forwardChannelMaxRetries",2,u),this.wa=Pa("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ln(u&&u.concurrentRequestLimit),this.Da=new Ex,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=qd.prototype,i.la=8,i.G=1,i.connect=function(u,_,b,P){We(0),this.W=u,this.H=_||{},b&&P!==void 0&&(this.H.OSID=b,this.H.OAID=P),this.F=this.X,this.I=tf(this,null,this.W),Oo(this)};function Pc(u){if(Xd(u),u.G==3){var _=u.U++,b=Tn(u.I);if(Ct(b,"SID",u.K),Ct(b,"RID",_),Ct(b,"TYPE","terminate"),Na(u,b),_=new N(u,u.j,_),_.L=2,_.v=Io(Tn(b)),b=!1,o.navigator&&o.navigator.sendBeacon)try{b=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!b&&o.Image&&(new Image().src=_.v,b=!0),b||(_.g=nf(_.j,null),_.g.ea(_.v)),_.F=Date.now(),ze(_)}ef(u)}function Do(u){u.g&&(Lc(u),u.g.cancel(),u.g=null)}function Xd(u){Do(u),u.u&&(o.clearTimeout(u.u),u.u=null),ko(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Oo(u){if(!At(u.h)&&!u.s){u.s=!0;var _=u.Ga;ne||pe(),ee||(ne(),ee=!0),ie.add(_,u),u.B=0}}function Mx(u,_){return tt(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=_.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ot(p(u.Ga,u,_),Zd(u,u.B)),u.B++,!0)}i.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const z=new N(this,this.j,u);let K=this.o;if(this.S&&(K?(K=A(K),x(K,this.S)):K=this.S),this.m!==null||this.O||(z.H=K,K=null),this.P)e:{for(var _=0,b=0;b<this.i.length;b++){t:{var P=this.i[b];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(_+=P,4096<_){_=b;break e}if(_===4096||b===this.i.length-1){_=b+1;break e}}_=1e3}else _=1e3;_=Yd(this,z,_),b=Tn(this.I),Ct(b,"RID",u),Ct(b,"CVER",22),this.D&&Ct(b,"X-HTTP-Session-Id",this.D),Na(this,b),K&&(this.O?_="headers="+encodeURIComponent(String(jd(K)))+"&"+_:this.m&&Ic(b,this.m,K)),wt(this.h,z),this.Ua&&Ct(b,"TYPE","init"),this.P?(Ct(b,"$req",_),Ct(b,"SID","null"),z.T=!0,X(z,b,null)):X(z,b,_),this.G=2}}else this.G==3&&(u?$d(this,u):this.i.length==0||At(this.h)||$d(this))};function $d(u,_){var b;_?b=_.l:b=u.U++;const P=Tn(u.I);Ct(P,"SID",u.K),Ct(P,"RID",b),Ct(P,"AID",u.T),Na(u,P),u.m&&u.o&&Ic(P,u.m,u.o),b=new N(u,u.j,b,u.B+1),u.m===null&&(b.H=u.o),_&&(u.i=_.D.concat(u.i)),_=Yd(u,b,1e3),b.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),wt(u.h,b),X(b,P,_)}function Na(u,_){u.H&&k(u.H,function(b,P){Ct(_,P,b)}),u.l&&Gt({},function(b,P){Ct(_,P,b)})}function Yd(u,_,b){b=Math.min(u.i.length,b);var P=u.l?p(u.l.Na,u.l,u):null;e:{var z=u.i;let K=-1;for(;;){const _e=["count="+b];K==-1?0<b?(K=z[0].g,_e.push("ofs="+K)):K=0:_e.push("ofs="+K);let Tt=!0;for(let en=0;en<b;en++){let _t=z[en].g;const on=z[en].map;if(_t-=K,0>_t)K=Math.max(0,z[en].g-100),Tt=!1;else try{wx(on,_e,"req"+_t+"_")}catch{P&&P(on)}}if(Tt){P=_e.join("&");break e}}}return u=u.i.splice(0,b),_.D=u,P}function Kd(u){if(!u.g&&!u.u){u.Y=1;var _=u.Fa;ne||pe(),ee||(ne(),ee=!0),ie.add(_,u),u.v=0}}function Nc(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ot(p(u.Fa,u),Zd(u,u.v)),u.v++,!0)}i.Fa=function(){if(this.u=null,Jd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ot(p(this.ab,this),u)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,We(10),Do(this),Jd(this))};function Lc(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function Jd(u){u.g=new N(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var _=Tn(u.qa);Ct(_,"RID","rpc"),Ct(_,"SID",u.K),Ct(_,"AID",u.T),Ct(_,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ct(_,"TO",u.ja),Ct(_,"TYPE","xmlhttp"),Na(u,_),u.m&&u.o&&Ic(_,u.m,u.o),u.L&&(u.g.I=u.L);var b=u.g;u=u.ia,b.L=1,b.v=Io(Tn(_)),b.m=null,b.P=!0,Ee(b,u)}i.Za=function(){this.C!=null&&(this.C=null,Do(this),Nc(this),We(19))};function ko(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function Qd(u,_){var b=null;if(u.g==_){ko(u),Lc(u),u.g=null;var P=2}else if(Sr(u.h,_))b=_.D,Yn(u.h,_),P=1;else return;if(u.G!=0){if(_.o)if(P==1){b=_.m?_.m.length:0,_=Date.now()-_.F;var z=u.B;P=et(),Ce(P,new Et(P,b)),Oo(u)}else Kd(u);else if(z=_.s,z==3||z==0&&0<_.X||!(P==1&&Mx(u,_)||P==2&&Nc(u)))switch(b&&0<b.length&&(_=u.h,_.i=_.i.concat(b)),z){case 1:Mr(u,5);break;case 4:Mr(u,10);break;case 3:Mr(u,6);break;default:Mr(u,2)}}}function Zd(u,_){let b=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(b*=2),b*_}function Mr(u,_){if(u.j.info("Error code "+_),_==2){var b=p(u.fb,u),P=u.Xa;const z=!P;P=new Vt(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||fs(P,"https"),Io(P),z?yx(P.toString(),b):bx(P.toString(),b)}else We(2);u.G=0,u.l&&u.l.sa(_),ef(u),Xd(u)}i.fb=function(u){u?(this.j.info("Successfully pinged google.com"),We(2)):(this.j.info("Failed to ping google.com"),We(1))};function ef(u){if(u.G=0,u.ka=[],u.l){const _=wa(u.h);(_.length!=0||u.i.length!=0)&&(m(u.ka,_),m(u.ka,u.i),u.h.i.length=0,T(u.i),u.i.length=0),u.l.ra()}}function tf(u,_,b){var P=b instanceof Vt?Tn(b):new Vt(b);if(P.g!="")_&&(P.g=_+"."+P.g),Ar(P,P.s);else{var z=o.location;P=z.protocol,_=_?_+"."+z.hostname:z.hostname,z=+z.port;var K=new Vt(null);P&&fs(K,P),_&&(K.g=_),z&&Ar(K,z),b&&(K.l=b),P=K}return b=u.D,_=u.ya,b&&_&&Ct(P,b,_),Ct(P,"VER",u.la),Na(u,P),P}function nf(u,_,b){if(_&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=u.Ca&&!u.pa?new kt(new Po({eb:b})):new kt(u.pa),_.Ha(u.J),_}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function rf(){}i=rf.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Uo(){}Uo.prototype.g=function(u,_){return new An(u,_)};function An(u,_){se.call(this),this.g=new qd(_),this.l=u,this.h=_&&_.messageUrlParams||null,u=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(u?u["X-WebChannel-Content-Type"]=_.messageContentType:u={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(u?u["X-WebChannel-Client-Profile"]=_.va:u={"X-WebChannel-Client-Profile":_.va}),this.g.S=u,(u=_&&_.Sb)&&!M(u)&&(this.g.m=u),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!M(_)&&(this.g.D=_,u=this.h,u!==null&&_ in u&&(u=this.h,_ in u&&delete u[_])),this.j=new ms(this)}y(An,se),An.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){Pc(this.g)},An.prototype.o=function(u){var _=this.g;if(typeof u=="string"){var b={};b.__data__=u,u=b}else this.u&&(b={},b.__data__=Ie(u),u=b);_.i.push(new Ft(_.Ya++,u)),_.G==3&&Oo(_)},An.prototype.N=function(){this.g.l=null,delete this.j,Pc(this.g),delete this.g,An.aa.N.call(this)};function sf(u){de.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var _=u.__sm__;if(_){e:{for(const b in _){u=b;break e}u=void 0}(this.i=u)&&(u=this.i,_=_!==null&&u in _?_[u]:void 0),this.data=_}else this.data=u}y(sf,de);function af(){W.call(this),this.status=1}y(af,W);function ms(u){this.g=u}y(ms,rf),ms.prototype.ua=function(){Ce(this.g,"a")},ms.prototype.ta=function(u){Ce(this.g,new sf(u))},ms.prototype.sa=function(u){Ce(this.g,new af)},ms.prototype.ra=function(){Ce(this.g,"b")},Uo.prototype.createWebChannel=Uo.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,t_=function(){return new Uo},e_=function(){return et()},Z0=le,Xu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},wr.NO_ERROR=0,wr.TIMEOUT=8,wr.HTTP_ERROR=6,yl=wr,Co.COMPLETE="complete",Q0=Co,Me.EventType=F,F.OPEN="a",F.CLOSE="b",F.ERROR="c",F.MESSAGE="d",se.prototype.listen=se.prototype.K,Ba=Me,kt.prototype.listenOnce=kt.prototype.L,kt.prototype.getLastError=kt.prototype.Ka,kt.prototype.getLastErrorCode=kt.prototype.Ba,kt.prototype.getStatus=kt.prototype.Z,kt.prototype.getResponseJson=kt.prototype.Oa,kt.prototype.getResponseText=kt.prototype.oa,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Ha,J0=kt}).apply(typeof jo<"u"?jo:typeof self<"u"?self:typeof window<"u"?window:{});const Jf="@firebase/firestore",Qf="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ma="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Th("@firebase/firestore");function Fs(){return Jr.logLevel}function we(i,...e){if(Jr.logLevel<=dt.DEBUG){const t=e.map(Vh);Jr.debug(`Firestore (${ma}): ${i}`,...t)}}function Ni(i,...e){if(Jr.logLevel<=dt.ERROR){const t=e.map(Vh);Jr.error(`Firestore (${ma}): ${i}`,...t)}}function cr(i,...e){if(Jr.logLevel<=dt.WARN){const t=e.map(Vh);Jr.warn(`Firestore (${ma}): ${i}`,...t)}}function Vh(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,n_(i,n,t)}function n_(i,e,t){let n=`FIRESTORE (${ma}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Ni(n),new Error(n)}function vt(i,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,i||n_(e,r,n)}function Je(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Le extends Di{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(dn.UNAUTHENTICATED))}shutdown(){}}class GS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class WS{constructor(e){this.t=e,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){vt(this.o===void 0,42304);let n=this.i;const r=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let s=new rr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rr,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},o=l=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rr)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(vt(typeof n.accessToken=="string",31837,{l:n}),new i_(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return vt(e===null||typeof e=="string",2055,{h:e}),new dn(e)}}class qS{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class XS{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new qS(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Zf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $S{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,In(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){vt(this.o===void 0,3512);const n=s=>{s.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,we("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Zf(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(vt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Zf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=YS(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function lt(i,e){return i<e?-1:i>e?1:0}function $u(i,e){let t=0;for(;t<i.length&&t<e.length;){const n=i.codePointAt(t),r=e.codePointAt(t);if(n!==r){if(n<128&&r<128)return lt(n,r);{const s=r_(),a=KS(s.encode(ep(i,t)),s.encode(ep(e,t)));return a!==0?a:lt(n,r)}}t+=n>65535?2:1}return lt(i.length,e.length)}function ep(i,e){return i.codePointAt(e)>65535?i.substring(e,e+2):i.substring(e,e+1)}function KS(i,e){for(let t=0;t<i.length&&t<e.length;++t)if(i[t]!==e[t])return lt(i[t],e[t]);return lt(i.length,e.length)}function ea(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp="__name__";class Jn{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ge(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ge(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Jn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=Jn.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return lt(e.length,t.length)}static compareSegments(e,t){const n=Jn.isNumericId(e),r=Jn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Jn.extractNumericId(e).compare(Jn.extractNumericId(t)):$u(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ir.fromString(e.substring(4,e.length-2))}}class Lt extends Jn{construct(e,t,n){return new Lt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Le(ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Lt(t)}static emptyPath(){return new Lt([])}}const JS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nn extends Jn{construct(e,t,n){return new nn(e,t,n)}static isValidIdentifier(e){return JS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tp}static keyField(){return new nn([tp])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(n.length===0)throw new Le(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;r<e.length;){const o=e[r];if(o==="\\"){if(r+1===e.length)throw new Le(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Le(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,r+=2}else o==="`"?(a=!a,r++):o!=="."||a?(n+=o,r++):(s(),r++)}if(s(),a)throw new Le(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nn(t)}static emptyPath(){return new nn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Lt.fromString(e))}static fromName(e){return new Fe(Lt.fromString(e).popFirst(5))}static empty(){return new Fe(Lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Lt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Lt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Lt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(i,e,t){if(!t)throw new Le(ce.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function ZS(i,e,t,n){if(e===!0&&n===!0)throw new Le(ce.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function np(i){if(!Fe.isDocumentKey(i))throw new Le(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function s_(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Bh(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Ge(12329,{type:typeof i})}function Qr(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new Le(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bh(i);throw new Le(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(i,e){const t={typeString:i};return e&&(t.value=e),t}function xo(i,e){if(!s_(i))throw new Le(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const a=i[n];if(r&&typeof a!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new Le(ce.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=-62135596800,rp=1e6;class Pt{static now(){return Pt.fromMillis(Date.now())}static fromDate(e){return Pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*rp);return new Pt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Le(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Le(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ip)throw new Le(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Le(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rp}_compareTo(e){return this.seconds===e.seconds?lt(this.nanoseconds,e.nanoseconds):lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xo(e,Pt._jsonSchema))return new Pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ip;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pt._jsonSchemaVersion="firestore/timestamp/1.0",Pt._jsonSchema={type:zt("string",Pt._jsonSchemaVersion),seconds:zt("number"),nanoseconds:zt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{static fromTimestamp(e){return new Ke(e)}static min(){return new Ke(new Pt(0,0))}static max(){return new Ke(new Pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=-1;function eT(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=Ke.fromTimestamp(n===1e9?new Pt(t+1,0):new Pt(t,n));return new ur(r,Fe.empty(),e)}function tT(i){return new ur(i.readTime,i.key,io)}class ur{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ur(Ke.min(),Fe.empty(),io)}static max(){return new ur(Ke.max(),Fe.empty(),io)}}function nT(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=Fe.comparator(i.documentKey,e.documentKey),t!==0?t:lt(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ga(i){if(i.code!==ce.FAILED_PRECONDITION||i.message!==iT)throw i;we("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ge(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.reject(t)}static resolve(e){return new oe((t,n)=>{t(e)})}static reject(e){return new oe((t,n)=>{n(e)})}static waitFor(e){return new oe((t,n)=>{let r=0,s=0,a=!1;e.forEach(o=>{++r,o.next(()=>{++s,a&&s===r&&t()},l=>n(l))}),a=!0,s===r&&t()})}static or(e){let t=oe.resolve(!1);for(const n of e)t=t.next(r=>r?oe.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new oe((n,r)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const h=l;t(e[h]).next(d=>{a[h]=d,++o,o===s&&n(a)},d=>r(d))}})}static doWhile(e,t){return new oe((n,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):n()};s()})}}function sT(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _a(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this._e(n),this.ae=n=>t.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}oc.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=-1;function lc(i){return i==null}function kl(i){return i===0&&1/i==-1/0}function aT(i){return typeof i=="number"&&Number.isInteger(i)&&!kl(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="";function oT(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=sp(e)),e=lT(i.get(t),e);return sp(e)}function lT(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="";break;case a_:t+="";break;default:t+=s}}return t}function sp(i){return i+a_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function yr(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function o_(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,t){this.comparator=e,this.root=t||tn.EMPTY}insert(e,t){return new Dt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tn.BLACK,null,null))}remove(e){return new Dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bo(this.root,e,this.comparator,!0)}}class Bo{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tn{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??tn.RED,this.left=r??tn.EMPTY,this.right=s??tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new tn(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return tn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return tn.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ge(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ge(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ge(27949);return e+(this.isRed()?0:1)}}tn.EMPTY=null,tn.RED=!0,tn.BLACK=!1;tn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ge(57766)}get value(){throw Ge(16141)}get color(){throw Ge(16727)}get left(){throw Ge(29726)}get right(){throw Ge(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new tn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.comparator=e,this.data=new Dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new op(this.data.getIterator())}getIteratorFrom(e){return new op(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Xt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Xt(this.comparator);return t.data=e,t}}class op{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.fields=e,e.sort(nn.comparator)}static empty(){return new Pn([])}unionWith(e){let t=new Xt(nn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Pn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ea(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new l_("Invalid base64 string: "+s):s}}(e);return new an(t)}static fromUint8Array(e){const t=function(r){let s="";for(let a=0;a<r.length;++a)s+=String.fromCharCode(r[a]);return s}(e);return new an(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}an.EMPTY_BYTE_STRING=new an("");const cT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hr(i){if(vt(!!i,39018),typeof i=="string"){let e=0;const t=cT.exec(i);if(vt(!!t,46558,{timestamp:i}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ut(i.seconds),nanos:Ut(i.nanos)}}function Ut(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function dr(i){return typeof i=="string"?an.fromBase64String(i):an.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="server_timestamp",u_="__type__",h_="__previous_value__",d_="__local_write_time__";function Hh(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[u_])===null||t===void 0?void 0:t.stringValue)===c_}function cc(i){const e=i.mapValue.fields[h_];return Hh(e)?cc(e):e}function ro(i){const e=hr(i.mapValue.fields[d_].timestampValue);return new Pt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,t,n,r,s,a,o,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Ul="(default)";class so{constructor(e,t){this.projectId=e,this.database=t||Ul}static empty(){return new so("","")}get isDefaultDatabase(){return this.database===Ul}isEqual(e){return e instanceof so&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_="__type__",hT="__max__",zo={mapValue:{}},p_="__vector__",Fl="value";function fr(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?Hh(i)?4:fT(i)?9007199254740991:dT(i)?10:11:Ge(28295,{value:i})}function li(i,e){if(i===e)return!0;const t=fr(i);if(t!==fr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return ro(i).isEqual(ro(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const a=hr(r.timestampValue),o=hr(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(r,s){return dr(r.bytesValue).isEqual(dr(s.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(r,s){return Ut(r.geoPointValue.latitude)===Ut(s.geoPointValue.latitude)&&Ut(r.geoPointValue.longitude)===Ut(s.geoPointValue.longitude)}(i,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Ut(r.integerValue)===Ut(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const a=Ut(r.doubleValue),o=Ut(s.doubleValue);return a===o?kl(a)===kl(o):isNaN(a)&&isNaN(o)}return!1}(i,e);case 9:return ea(i.arrayValue.values||[],e.arrayValue.values||[],li);case 10:case 11:return function(r,s){const a=r.mapValue.fields||{},o=s.mapValue.fields||{};if(ap(a)!==ap(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!li(a[l],o[l])))return!1;return!0}(i,e);default:return Ge(52216,{left:i})}}function ao(i,e){return(i.values||[]).find(t=>li(t,e))!==void 0}function ta(i,e){if(i===e)return 0;const t=fr(i),n=fr(e);if(t!==n)return lt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return lt(i.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Ut(s.integerValue||s.doubleValue),l=Ut(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(i,e);case 3:return lp(i.timestampValue,e.timestampValue);case 4:return lp(ro(i),ro(e));case 5:return $u(i.stringValue,e.stringValue);case 6:return function(s,a){const o=dr(s),l=dr(a);return o.compareTo(l)}(i.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let h=0;h<o.length&&h<l.length;h++){const d=lt(o[h],l[h]);if(d!==0)return d}return lt(o.length,l.length)}(i.referenceValue,e.referenceValue);case 8:return function(s,a){const o=lt(Ut(s.latitude),Ut(a.latitude));return o!==0?o:lt(Ut(s.longitude),Ut(a.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return cp(i.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,h,d;const f=s.fields||{},p=a.fields||{},g=(o=f[Fl])===null||o===void 0?void 0:o.arrayValue,y=(l=p[Fl])===null||l===void 0?void 0:l.arrayValue,T=lt(((h=g?.values)===null||h===void 0?void 0:h.length)||0,((d=y?.values)===null||d===void 0?void 0:d.length)||0);return T!==0?T:cp(g,y)}(i.mapValue,e.mapValue);case 11:return function(s,a){if(s===zo.mapValue&&a===zo.mapValue)return 0;if(s===zo.mapValue)return 1;if(a===zo.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=$u(l[f],d[f]);if(p!==0)return p;const g=ta(o[l[f]],h[d[f]]);if(g!==0)return g}return lt(l.length,d.length)}(i.mapValue,e.mapValue);default:throw Ge(23264,{le:t})}}function lp(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return lt(i,e);const t=hr(i),n=hr(e),r=lt(t.seconds,n.seconds);return r!==0?r:lt(t.nanos,n.nanos)}function cp(i,e){const t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const s=ta(t[r],n[r]);if(s)return s}return lt(t.length,n.length)}function na(i){return Yu(i)}function Yu(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const n=hr(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return dr(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return Fe.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",r=!0;for(const s of t.values||[])r?r=!1:n+=",",n+=Yu(s);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const a of n)s?s=!1:r+=",",r+=`${a}:${Yu(t.fields[a])}`;return r+"}"}(i.mapValue):Ge(61005,{value:i})}function bl(i){switch(fr(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cc(i);return e?16+bl(e):16;case 5:return 2*i.stringValue.length;case 6:return dr(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,s)=>r+bl(s),0)}(i.arrayValue);case 10:case 11:return function(n){let r=0;return yr(n.fields,(s,a)=>{r+=s.length+bl(a)}),r}(i.mapValue);default:throw Ge(13486,{value:i})}}function Ku(i){return!!i&&"integerValue"in i}function Gh(i){return!!i&&"arrayValue"in i}function up(i){return!!i&&"nullValue"in i}function hp(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function El(i){return!!i&&"mapValue"in i}function dT(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[f_])===null||t===void 0?void 0:t.stringValue)===p_}function Xa(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return yr(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Xa(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xa(i.arrayValue.values[t]);return e}return Object.assign({},i)}function fT(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===hT}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.value=e}static empty(){return new bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!El(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xa(t)}setAll(e){let t=nn.emptyPath(),n={},r=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,n,r),n={},r=[],t=o.popLast()}a?n[o.lastSegment()]=Xa(a):r.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());El(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return li(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];El(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){yr(t,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new bn(Xa(this.value))}}function m_(i){const e=[];return yr(i.fields,(t,n)=>{const r=new nn([t]);if(El(n)){const s=m_(n.mapValue).fields;if(s.length===0)e.push(r);else for(const a of s)e.push(r.child(a))}else e.push(r)}),new Pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e,t,n,r,s,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new fn(e,0,Ke.min(),Ke.min(),Ke.min(),bn.empty(),0)}static newFoundDocument(e,t,n,r){return new fn(e,1,t,Ke.min(),n,r,0)}static newNoDocument(e,t){return new fn(e,2,t,Ke.min(),Ke.min(),bn.empty(),0)}static newUnknownDocument(e,t){return new fn(e,3,t,Ke.min(),Ke.min(),bn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof fn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new fn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t){this.position=e,this.inclusive=t}}function dp(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],a=i.position[r];if(s.field.isKeyField()?n=Fe.comparator(Fe.fromName(a.referenceValue),t.key):n=ta(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function fp(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!li(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,t="asc"){this.field=e,this.dir=t}}function pT(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{}class Wt extends g_{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new gT(e,t,n):t==="array-contains"?new xT(e,n):t==="in"?new yT(e,n):t==="not-in"?new bT(e,n):t==="array-contains-any"?new ET(e,n):new Wt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new _T(e,n):new vT(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ta(t,this.value)):t!==null&&fr(this.value)===fr(t)&&this.matchesComparison(ta(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ge(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ci extends g_{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new ci(e,t)}matches(e){return __(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function __(i){return i.op==="and"}function v_(i){return mT(i)&&__(i)}function mT(i){for(const e of i.filters)if(e instanceof ci)return!1;return!0}function Ju(i){if(i instanceof Wt)return i.field.canonicalString()+i.op.toString()+na(i.value);if(v_(i))return i.filters.map(e=>Ju(e)).join(",");{const e=i.filters.map(t=>Ju(t)).join(",");return`${i.op}(${e})`}}function x_(i,e){return i instanceof Wt?function(n,r){return r instanceof Wt&&n.op===r.op&&n.field.isEqual(r.field)&&li(n.value,r.value)}(i,e):i instanceof ci?function(n,r){return r instanceof ci&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,a,o)=>s&&x_(a,r.filters[o]),!0):!1}(i,e):void Ge(19439)}function y_(i){return i instanceof Wt?function(t){return`${t.field.canonicalString()} ${t.op} ${na(t.value)}`}(i):i instanceof ci?function(t){return t.op.toString()+" {"+t.getFilters().map(y_).join(" ,")+"}"}(i):"Filter"}class gT extends Wt{constructor(e,t,n){super(e,t,n),this.key=Fe.fromName(n.referenceValue)}matches(e){const t=Fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class _T extends Wt{constructor(e,t){super(e,"in",t),this.keys=b_("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class vT extends Wt{constructor(e,t){super(e,"not-in",t),this.keys=b_("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function b_(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class xT extends Wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gh(t)&&ao(t.arrayValue,this.value)}}class yT extends Wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ao(this.value.arrayValue,t)}}class bT extends Wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ao(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ao(this.value.arrayValue,t)}}class ET extends Wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>ao(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,t=null,n=[],r=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=a,this.endAt=o,this.Pe=null}}function pp(i,e=null,t=[],n=[],r=null,s=null,a=null){return new wT(i,e,t,n,r,s,a)}function Wh(i){const e=Je(i);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Ju(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),lc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>na(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>na(n)).join(",")),e.Pe=t}return e.Pe}function qh(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!pT(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!x_(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!fp(i.startAt,e.startAt)&&fp(i.endAt,e.endAt)}function Qu(i){return Fe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,t=null,n=[],r=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function ST(i,e,t,n,r,s,a,o){return new uc(i,e,t,n,r,s,a,o)}function Xh(i){return new uc(i)}function mp(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function TT(i){return i.collectionGroup!==null}function $a(i){const e=Je(i);if(e.Te===null){e.Te=[];const t=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Xt(nn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(o=o.add(h.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new jl(s,n))}),t.has(nn.keyField().canonicalString())||e.Te.push(new jl(nn.keyField(),n))}return e.Te}function ni(i){const e=Je(i);return e.Ie||(e.Ie=AT(e,$a(i))),e.Ie}function AT(i,e){if(i.limitType==="F")return pp(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new jl(r.field,s)});const t=i.endAt?new Vl(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Vl(i.startAt.position,i.startAt.inclusive):null;return pp(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function Zu(i,e,t){return new uc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function hc(i,e){return qh(ni(i),ni(e))&&i.limitType===e.limitType}function E_(i){return`${Wh(ni(i))}|lt:${i.limitType}`}function Vs(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>y_(r)).join(", ")}]`),lc(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>na(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>na(r)).join(",")),`Target(${n})`}(ni(i))}; limitType=${i.limitType})`}function dc(i,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Fe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(i,e)&&function(n,r){for(const s of $a(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(i,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(i,e)&&function(n,r){return!(n.startAt&&!function(a,o,l){const h=dp(a,o,l);return a.inclusive?h<=0:h<0}(n.startAt,$a(n),r)||n.endAt&&!function(a,o,l){const h=dp(a,o,l);return a.inclusive?h>=0:h>0}(n.endAt,$a(n),r))}(i,e)}function MT(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function w_(i){return(e,t)=>{let n=!1;for(const r of $a(i)){const s=RT(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function RT(i,e,t){const n=i.field.isKeyField()?Fe.comparator(e.key,t.key):function(s,a,o){const l=a.data.field(s),h=o.data.field(s);return l!==null&&h!==null?ta(l,h):Ge(42886)}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Ge(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){yr(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return o_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=new Dt(Fe.comparator);function Li(){return CT}const S_=new Dt(Fe.comparator);function za(...i){let e=S_;for(const t of i)e=e.insert(t.key,t);return e}function T_(i){let e=S_;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Vr(){return Ya()}function A_(){return Ya()}function Ya(){return new ss(i=>i.toString(),(i,e)=>i.isEqual(e))}const IT=new Dt(Fe.comparator),PT=new Xt(Fe.comparator);function ft(...i){let e=PT;for(const t of i)e=e.add(t);return e}const NT=new Xt(lt);function LT(){return NT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kl(e)?"-0":e}}function M_(i){return{integerValue:""+i}}function DT(i,e){return aT(e)?M_(e):$h(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(){this._=void 0}}function OT(i,e,t){return i instanceof Bl?function(r,s){const a={fields:{[u_]:{stringValue:c_},[d_]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Hh(s)&&(s=cc(s)),s&&(a.fields[h_]=s),{mapValue:a}}(t,e):i instanceof oo?C_(i,e):i instanceof lo?I_(i,e):function(r,s){const a=R_(r,s),o=gp(a)+gp(r.Ee);return Ku(a)&&Ku(r.Ee)?M_(o):$h(r.serializer,o)}(i,e)}function kT(i,e,t){return i instanceof oo?C_(i,e):i instanceof lo?I_(i,e):t}function R_(i,e){return i instanceof zl?function(n){return Ku(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Bl extends fc{}class oo extends fc{constructor(e){super(),this.elements=e}}function C_(i,e){const t=P_(e);for(const n of i.elements)t.some(r=>li(r,n))||t.push(n);return{arrayValue:{values:t}}}class lo extends fc{constructor(e){super(),this.elements=e}}function I_(i,e){let t=P_(e);for(const n of i.elements)t=t.filter(r=>!li(r,n));return{arrayValue:{values:t}}}class zl extends fc{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function gp(i){return Ut(i.integerValue||i.doubleValue)}function P_(i){return Gh(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function UT(i,e){return i.field.isEqual(e.field)&&function(n,r){return n instanceof oo&&r instanceof oo||n instanceof lo&&r instanceof lo?ea(n.elements,r.elements,li):n instanceof zl&&r instanceof zl?li(n.Ee,r.Ee):n instanceof Bl&&r instanceof Bl}(i.transform,e.transform)}class FT{constructor(e,t){this.version=e,this.transformResults=t}}class ii{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ii}static exists(e){return new ii(void 0,e)}static updateTime(e){return new ii(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wl(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class pc{}function N_(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new D_(i.key,ii.none()):new yo(i.key,i.data,ii.none());{const t=i.data,n=bn.empty();let r=new Xt(nn.comparator);for(let s of e.fields)if(!r.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),r=r.add(s)}return new br(i.key,n,new Pn(r.toArray()),ii.none())}}function VT(i,e,t){i instanceof yo?function(r,s,a){const o=r.value.clone(),l=vp(r.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(i,e,t):i instanceof br?function(r,s,a){if(!wl(r.precondition,s))return void s.convertToUnknownDocument(a.version);const o=vp(r.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(L_(r)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(i,e,t):function(r,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ka(i,e,t,n){return i instanceof yo?function(s,a,o,l){if(!wl(s.precondition,a))return o;const h=s.value.clone(),d=xp(s.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(i,e,t,n):i instanceof br?function(s,a,o,l){if(!wl(s.precondition,a))return o;const h=xp(s.fieldTransforms,l,a),d=a.data;return d.setAll(L_(s)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(i,e,t,n):function(s,a,o){return wl(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(i,e,t)}function jT(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=R_(n.transform,r||null);s!=null&&(t===null&&(t=bn.empty()),t.set(n.field,s))}return t||null}function _p(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&ea(n,r,(s,a)=>UT(s,a))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class yo extends pc{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class br extends pc{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function L_(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function vp(i,e,t){const n=new Map;vt(i.length===t.length,32656,{Ae:t.length,Re:i.length});for(let r=0;r<t.length;r++){const s=i[r],a=s.transform,o=e.data.field(s.field);n.set(s.field,kT(a,o,t[r]))}return n}function xp(i,e,t){const n=new Map;for(const r of i){const s=r.transform,a=t.data.field(r.field);n.set(r.field,OT(s,a,e))}return n}class D_ extends pc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BT extends pc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&VT(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ka(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ka(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=A_();return this.mutations.forEach(r=>{const s=e.get(r.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(r.key)?null:o;const l=N_(a,o);l!==null&&n.set(r.key,l),a.isValidDocument()||a.convertToNoDocument(Ke.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ft())}isEqual(e){return this.batchId===e.batchId&&ea(this.mutations,e.mutations,(t,n)=>_p(t,n))&&ea(this.baseMutations,e.baseMutations,(t,n)=>_p(t,n))}}class Yh{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){vt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let r=function(){return IT}();const s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,n[a].version);return new Yh(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt,pt;function WT(i){switch(i){case ce.OK:return Ge(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Ge(15467,{code:i})}}function O_(i){if(i===void 0)return Ni("GRPC error has no .code"),ce.UNKNOWN;switch(i){case Bt.OK:return ce.OK;case Bt.CANCELLED:return ce.CANCELLED;case Bt.UNKNOWN:return ce.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return ce.INTERNAL;case Bt.UNAVAILABLE:return ce.UNAVAILABLE;case Bt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Bt.NOT_FOUND:return ce.NOT_FOUND;case Bt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Bt.ABORTED:return ce.ABORTED;case Bt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Bt.DATA_LOSS:return ce.DATA_LOSS;default:return Ge(39323,{code:i})}}(pt=Bt||(Bt={}))[pt.OK=0]="OK",pt[pt.CANCELLED=1]="CANCELLED",pt[pt.UNKNOWN=2]="UNKNOWN",pt[pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pt[pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pt[pt.NOT_FOUND=5]="NOT_FOUND",pt[pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",pt[pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",pt[pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",pt[pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pt[pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pt[pt.ABORTED=10]="ABORTED",pt[pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",pt[pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",pt[pt.INTERNAL=13]="INTERNAL",pt[pt.UNAVAILABLE=14]="UNAVAILABLE",pt[pt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qT=new ir([4294967295,4294967295],0);function yp(i){const e=r_().encode(i),t=new K0;return t.update(e),new Uint8Array(t.digest())}function bp(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ir([t,n],0),new ir([r,s],0)]}class Kh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ha(`Invalid padding: ${t}`);if(n<0)throw new Ha(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ha(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ha(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ir.fromNumber(this.fe)}pe(e,t,n){let r=e.add(t.multiply(ir.fromNumber(n)));return r.compare(qT)===1&&(r=new ir([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=yp(e),[n,r]=bp(t);for(let s=0;s<this.hashCount;s++){const a=this.pe(n,r,s);if(!this.ye(a))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Kh(s,r,t);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.fe===0)return;const t=yp(e),[n,r]=bp(t);for(let s=0;s<this.hashCount;s++){const a=this.pe(n,r,s);this.we(a)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ha extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,bo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new mc(Ke.min(),r,new Dt(lt),Li(),ft())}}class bo{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new bo(n,t,ft(),ft(),ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=r}}class k_{constructor(e,t){this.targetId=e,this.De=t}}class U_{constructor(e,t,n=an.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Ep{constructor(){this.ve=0,this.Ce=wp(),this.Fe=an.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ft(),t=ft(),n=ft();return this.Ce.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ge(38017,{changeType:s})}}),new bo(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=wp()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,vt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class XT{constructor(e){this.We=e,this.Ge=new Map,this.ze=Li(),this.je=Ho(),this.Je=Ho(),this.He=new Dt(lt)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:Ge(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((n,r)=>{this.nt(r)&&t(r)})}it(e){const t=e.targetId,n=e.De.count,r=this.st(t);if(r){const s=r.target;if(Qu(s))if(n===0){const a=new Fe(s.path);this.Xe(t,a,fn.newNoDocument(a,Ke.min()))}else vt(n===1,20013,{expectedCount:n});else{const a=this.ot(t);if(a!==n){const o=this._t(e),l=o?this.ut(o,e,a):1;if(l!==0){this.rt(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,h)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let a,o;try{a=dr(n).toUint8Array()}catch(l){if(l instanceof l_)return cr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Kh(a,r,s)}catch(l){return cr(l instanceof Ha?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.fe===0?null:o}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let r=0;return n.forEach(s=>{const a=this.We.lt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Xe(t,s,null),r++)}),r}Pt(e){const t=new Map;this.Ge.forEach((s,a)=>{const o=this.st(a);if(o){if(s.current&&Qu(o.target)){const l=new Fe(o.target.path);this.Tt(l).has(a)||this.It(a,l)||this.Xe(a,l,fn.newNoDocument(l,e))}s.Ne&&(t.set(a,s.Le()),s.ke())}});let n=ft();this.Je.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const h=this.st(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ze.forEach((s,a)=>a.setReadTime(e));const r=new mc(e,t,this.He,this.ze,n);return this.ze=Li(),this.je=Ho(),this.Je=Ho(),this.He=new Dt(lt),r}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Ep,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Xt(lt),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Xt(lt),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||we("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ep),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Ho(){return new Dt(Fe.comparator)}function wp(){return new Dt(Fe.comparator)}const $T={asc:"ASCENDING",desc:"DESCENDING"},YT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KT={and:"AND",or:"OR"};class JT{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function eh(i,e){return i.useProto3Json||lc(e)?e:{value:e}}function Hl(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F_(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function QT(i,e){return Hl(i,e.toTimestamp())}function ri(i){return vt(!!i,49232),Ke.fromTimestamp(function(t){const n=hr(t);return new Pt(n.seconds,n.nanos)}(i))}function Jh(i,e){return th(i,e).canonicalString()}function th(i,e){const t=function(r){return new Lt(["projects",r.projectId,"databases",r.database])}(i).child("documents");return e===void 0?t:t.child(e)}function V_(i){const e=Lt.fromString(i);return vt(G_(e),10190,{key:e.toString()}),e}function nh(i,e){return Jh(i.databaseId,e.path)}function Hc(i,e){const t=V_(e);if(t.get(1)!==i.databaseId.projectId)throw new Le(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new Le(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new Fe(B_(t))}function j_(i,e){return Jh(i.databaseId,e)}function ZT(i){const e=V_(i);return e.length===4?Lt.emptyPath():B_(e)}function ih(i){return new Lt(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function B_(i){return vt(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Sp(i,e,t){return{name:nh(i,e),fields:t.value.mapValue.fields}}function eA(i,e){let t;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ge(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(h,d){return h.useProto3Json?(vt(d===void 0||typeof d=="string",58123),an.fromBase64String(d||"")):(vt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),an.fromUint8Array(d||new Uint8Array))}(i,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(h){const d=h.code===void 0?ce.UNKNOWN:O_(h.code);return new Le(d,h.message||"")}(a);t=new U_(n,r,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Hc(i,n.document.name),s=ri(n.document.updateTime),a=n.document.createTime?ri(n.document.createTime):Ke.min(),o=new bn({mapValue:{fields:n.document.fields}}),l=fn.newFoundDocument(r,s,a,o),h=n.targetIds||[],d=n.removedTargetIds||[];t=new Sl(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Hc(i,n.document),s=n.readTime?ri(n.readTime):Ke.min(),a=fn.newNoDocument(r,s),o=n.removedTargetIds||[];t=new Sl([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Hc(i,n.document),s=n.removedTargetIds||[];t=new Sl([],s,r,null)}else{if(!("filter"in e))return Ge(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:s}=n,a=new GT(r,s),o=n.targetId;t=new k_(o,a)}}return t}function tA(i,e){let t;if(e instanceof yo)t={update:Sp(i,e.key,e.value)};else if(e instanceof D_)t={delete:nh(i,e.key)};else if(e instanceof br)t={update:Sp(i,e.key,e.data),updateMask:uA(e.fieldMask)};else{if(!(e instanceof BT))return Ge(16599,{Rt:e.type});t={verify:nh(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Bl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof oo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof lo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof zl)return{fieldPath:a.field.canonicalString(),increment:o.Ee};throw Ge(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:QT(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ge(27497)}(i,e.precondition)),t}function nA(i,e){return i&&i.length>0?(vt(e!==void 0,14353),i.map(t=>function(r,s){let a=r.updateTime?ri(r.updateTime):ri(s);return a.isEqual(Ke.min())&&(a=ri(s)),new FT(a,r.transformResults||[])}(t,e))):[]}function iA(i,e){return{documents:[j_(i,e.path)]}}function rA(i,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=j_(i,r);const s=function(h){if(h.length!==0)return H_(ci.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(h){if(h.length!==0)return h.map(d=>function(p){return{field:js(p.field),direction:oA(p.dir)}}(d))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=eh(i,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{Vt:t,parent:r}}function sA(i){let e=ZT(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){vt(n===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){const p=z_(f);return p instanceof ci&&v_(p)?p.getFilters():[p]}(t.where));let a=[];t.orderBy&&(a=function(f){return f.map(p=>function(y){return new jl(Bs(y.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let o=null;t.limit&&(o=function(f){let p;return p=typeof f=="object"?f.value:f,lc(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new Vl(g,p)}(t.startAt));let h=null;return t.endAt&&(h=function(f){const p=!f.before,g=f.values||[];return new Vl(g,p)}(t.endAt)),ST(e,r,a,s,o,"F",l,h)}function aA(i,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ge(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function z_(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Bs(t.unaryFilter.field);return Wt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Bs(t.unaryFilter.field);return Wt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Bs(t.unaryFilter.field);return Wt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Bs(t.unaryFilter.field);return Wt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ge(61313);default:return Ge(60726)}}(i):i.fieldFilter!==void 0?function(t){return Wt.create(Bs(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ge(58110);default:return Ge(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return ci.create(t.compositeFilter.filters.map(n=>z_(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ge(1026)}}(t.compositeFilter.op))}(i):Ge(30097,{filter:i})}function oA(i){return $T[i]}function lA(i){return YT[i]}function cA(i){return KT[i]}function js(i){return{fieldPath:i.canonicalString()}}function Bs(i){return nn.fromServerFormat(i.fieldPath)}function H_(i){return i instanceof Wt?function(t){if(t.op==="=="){if(hp(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NAN"}};if(up(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(hp(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NOT_NAN"}};if(up(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:js(t.field),op:lA(t.op),value:t.value}}}(i):i instanceof ci?function(t){const n=t.getFilters().map(r=>H_(r));return n.length===1?n[0]:{compositeFilter:{op:cA(t.op),filters:n}}}(i):Ge(54877,{filter:i})}function uA(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function G_(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,t,n,r,s=Ke.min(),a=Ke.min(),o=an.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ji(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ji(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ji(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ji(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(e){this.gt=e}}function dA(i){const e=sA({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Zu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(){this.Dn=new pA}addToCollectionParentIndex(e,t){return this.Dn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(ur.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(ur.min())}updateCollectionGroup(e,t,n){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class pA{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Xt(Lt.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Xt(Lt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},W_=41943040;class xn{static withCacheSize(e){return new xn(e,xn.DEFAULT_COLLECTION_PERCENTILE,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xn.DEFAULT_COLLECTION_PERCENTILE=10,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xn.DEFAULT=new xn(W_,xn.DEFAULT_COLLECTION_PERCENTILE,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xn.DISABLED=new xn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new ia(0)}static ur(){return new ia(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="LruGarbageCollector",mA=1048576;function Mp([i,e],[t,n]){const r=lt(i,t);return r===0?lt(e,n):r}class gA{constructor(e){this.Tr=e,this.buffer=new Xt(Mp),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Mp(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _A{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){we(Ap,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_a(t)?we(Ap,"Ignoring IndexedDB error during garbage collection: ",t):await ga(t)}await this.Rr(3e5)})}}class vA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(oc.ue);const n=new gA(t);return this.Vr.forEachTarget(e,r=>n.Er(r.sequenceNumber)).next(()=>this.Vr.gr(e,r=>n.Er(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(Tp)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tp):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,r,s,a,o,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,a=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(n=f,o=Date.now(),this.removeTargets(e,n,t))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(h=Date.now(),Fs()<=dt.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${r} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:f})))}}function xA(i,e){return new vA(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this.changes=new ss(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,fn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?oe.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Ka(n.mutation,r,Pn.empty(),Pt.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,ft()).next(()=>n))}getLocalViewOfDocuments(e,t,n=ft()){const r=Vr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let a=za();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=Vr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,ft()))}populateOverlays(e,t,n){const r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,n,r){let s=Li();const a=Ya(),o=function(){return Ya()}();return t.forEach((l,h)=>{const d=n.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof br)?s=s.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),Ka(d.mutation,h,d.mutation.getFieldMask(),Pt.now())):a.set(h.key,Pn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,d)=>a.set(h,d)),t.forEach((h,d)=>{var f;return o.set(h,new bA(d,(f=a.get(h))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Ya();let r=new Dt((a,o)=>a-o),s=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(l=>{const h=t.get(l);if(h===null)return;let d=n.get(l)||Pn.empty();d=o.applyToLocalView(h,d),n.set(l,d);const f=(r.get(o.batchId)||ft()).add(l);r=r.insert(o.batchId,f)})}).next(()=>{const a=[],o=r.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),h=l.key,d=l.value,f=A_();d.forEach(p=>{if(!s.has(p)){const g=N_(t.get(p),n.get(p));g!==null&&f.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,f))}return oe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(a){return Fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):TT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):oe.resolve(Vr());let o=io,l=s;return a.next(h=>oe.forEach(h,(d,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(d)?oe.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,ft())).next(d=>({batchId:o,changes:T_(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Fe(t)).next(n=>{let r=za();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let a=za();return this.indexManager.getCollectionParents(e,s).next(o=>oe.forEach(o,l=>{const h=function(f,p){return new uc(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,r).next(d=>{d.forEach((f,p)=>{a=a.insert(f,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(a=>{s.forEach((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,fn.newInvalidDocument(d)))});let o=za();return a.forEach((l,h)=>{const d=s.get(l);d!==void 0&&Ka(d.mutation,h,Pn.empty(),Pt.now()),dc(t,h)&&(o=o.insert(l,h))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return oe.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(r){return{id:r.id,version:r.version,createTime:ri(r.createTime)}}(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(r){return{name:r.name,query:dA(r.bundledQuery),readTime:ri(r.readTime)}}(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.overlays=new Dt(Fe.comparator),this.kr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Vr();return oe.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.wt(e,t,s)}),oe.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.kr.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(n)),oe.resolve()}getOverlaysForCollection(e,t,n){const r=Vr(),s=t.length+1,a=new Fe(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>n&&r.set(l.getKey(),l)}return oe.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Dt((h,d)=>h-d);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let d=s.get(h.largestBatchId);d===null&&(d=Vr(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const o=Vr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,d)=>o.set(h,d)),!(o.size()>=r)););return oe.resolve(o)}wt(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const a=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new HT(t,n));let s=this.kr.get(t);s===void 0&&(s=ft(),this.kr.set(t,s)),this.kr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(){this.sessionToken=an.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(){this.qr=new Xt(Qt.Qr),this.$r=new Xt(Qt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new Qt(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Wr(new Qt(e,t))}Gr(e,t){e.forEach(n=>this.removeReference(n,t))}zr(e){const t=new Fe(new Lt([])),n=new Qt(t,e),r=new Qt(t,e+1),s=[];return this.$r.forEachInRange([n,r],a=>{this.Wr(a),s.push(a.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Fe(new Lt([])),n=new Qt(t,e),r=new Qt(t,e+1);let s=ft();return this.$r.forEachInRange([n,r],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new Qt(e,0),n=this.qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Qt{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Fe.comparator(e.key,t.key)||lt(e.Hr,t.Hr)}static Ur(e,t){return lt(e.Hr,t.Hr)||Fe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Xt(Qt.Qr)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new zT(s,t,n,r);this.mutationQueue.push(a);for(const o of r)this.Yr=this.Yr.add(new Qt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return oe.resolve(a)}lookupMutationBatch(e,t){return oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),s=r<0?0:r;return oe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?zh:this.er-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Qt(t,0),r=new Qt(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([n,r],a=>{const o=this.Zr(a.Hr);s.push(o)}),oe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Xt(lt);return t.forEach(r=>{const s=new Qt(r,0),a=new Qt(r,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],o=>{n=n.add(o.Hr)})}),oe.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;Fe.isDocumentKey(s)||(s=s.child(""));const a=new Qt(new Fe(s),0);let o=new Xt(lt);return this.Yr.forEachWhile(l=>{const h=l.key.path;return!!n.isPrefixOf(h)&&(h.length===r&&(o=o.add(l.Hr)),!0)},a),oe.resolve(this.ei(o))}ei(e){const t=[];return e.forEach(n=>{const r=this.Zr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){vt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return oe.forEach(t.mutations,r=>{const s=new Qt(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new Qt(t,0),r=this.Yr.firstAfterOrEqual(n);return oe.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e){this.ni=e,this.docs=function(){return new Dt(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,a=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return oe.resolve(n?n.document.mutableCopy():fn.newInvalidDocument(t))}getEntries(e,t){let n=Li();return t.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():fn.newInvalidDocument(r))}),oe.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Li();const a=t.path,o=new Fe(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||nT(tT(d),n)<=0||(r.has(d.key)||dc(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return oe.resolve(s)}getAllFromCollectionGroup(e,t,n,r){Ge(9500)}ri(e,t){return oe.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new RA(this)}getSize(e){return oe.resolve(this.size)}}class RA extends yA{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(n)}),oe.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e){this.persistence=e,this.ii=new ss(t=>Wh(t),qh),this.lastRemoteSnapshotVersion=Ke.min(),this.highestTargetId=0,this.si=0,this.oi=new Qh,this.targetCount=0,this._i=ia.ar()}forEachTarget(e,t){return this.ii.forEach((n,r)=>t(r)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),oe.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new ia(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.hr(t),oe.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.ii.forEach((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),oe.waitFor(s).next(()=>r)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return oe.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),oe.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),oe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return oe.resolve(n)}containsKey(e,t){return oe.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,t){this.ai={},this.overlays={},this.ui=new oc(0),this.ci=!1,this.ci=!0,this.li=new TA,this.referenceDelegate=e(this),this.hi=new CA(this),this.indexManager=new fA,this.remoteDocumentCache=function(r){return new MA(r)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new hA(t),this.Ti=new wA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new SA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new AA(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){we("MemoryPersistence","Starting transaction:",e);const r=new IA(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(s=>this.referenceDelegate.di(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ei(e,t){return oe.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class IA extends rT{constructor(e){super(),this.currentSequenceNumber=e}}class Zh{constructor(e){this.persistence=e,this.Ai=new Qh,this.Ri=null}static Vi(e){return new Zh(e)}get mi(){if(this.Ri)return this.Ri;throw Ge(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),oe.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(r=>this.mi.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.mi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.mi,n=>{const r=Fe.fromPath(n);return this.fi(e,r).next(s=>{s||t.removeEntry(r,Ke.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(n=>{n?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return oe.or([()=>oe.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Gl{constructor(e,t){this.persistence=e,this.gi=new ss(n=>oT(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=xA(this,t)}static Vi(e,t){return new Gl(e,t)}Ii(){}di(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}yr(e){let t=0;return this.gr(e,n=>{t++}).next(()=>t)}gr(e,t){return oe.forEach(this.gi,(n,r)=>this.Sr(e,n,r).next(s=>s?oe.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ri(e,a=>this.Sr(e,a,t).next(o=>{o||(n++,s.removeEntry(a,Ke.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),oe.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=bl(e.data.value)),t}Sr(e,t,n){return oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.gi.get(t);return oe.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=r}static Es(e,t){let n=ft(),r=ft();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new ed(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return lb()?8:sT(pn())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ps(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ys(e,t,r,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new PA;return this.ws(e,t,a).next(o=>{if(s.result=o,this.Rs)return this.Ss(e,t,a,o.size)})}).next(()=>s.result)}Ss(e,t,n,r){return n.documentReadCount<this.Vs?(Fs()<=dt.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",Vs(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),oe.resolve()):(Fs()<=dt.DEBUG&&we("QueryEngine","Query:",Vs(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(Fs()<=dt.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",Vs(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ni(t))):oe.resolve())}ps(e,t){if(mp(t))return oe.resolve(null);let n=ni(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Zu(t,null,"F"),n=ni(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=ft(...s);return this.gs.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const h=this.bs(t,o);return this.Ds(t,h,a,l.readTime)?this.ps(e,Zu(t,null,"F")):this.vs(e,h,t,l)}))})))}ys(e,t,n,r){return mp(t)||r.isEqual(Ke.min())?oe.resolve(null):this.gs.getDocuments(e,n).next(s=>{const a=this.bs(t,s);return this.Ds(t,a,n,r)?oe.resolve(null):(Fs()<=dt.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Vs(t)),this.vs(e,a,t,eT(r,io)).next(o=>o))})}bs(e,t){let n=new Xt(w_(e));return t.forEach((r,s)=>{dc(e,s)&&(n=n.add(s))}),n}Ds(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ws(e,t,n){return Fs()<=dt.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",Vs(t)),this.gs.getDocumentsMatchingQuery(e,t,ur.min(),n)}vs(e,t,n,r){return this.gs.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td="LocalStore",LA=3e8;class DA{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Dt(lt),this.Ms=new ss(s=>Wh(s),qh),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new EA(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function OA(i,e,t,n){return new DA(i,e,t,n)}async function X_(i,e){const t=Je(i);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=ft();for(const h of r){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of s){o.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(n,l).next(h=>({Bs:h,removedBatchIds:a,addedBatchIds:o}))})})}function kA(i,e){const t=Je(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return function(o,l,h,d){const f=h.batch,p=f.keys();let g=oe.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(l,y)).next(T=>{const m=h.docVersions.get(y);vt(m!==null,48541),T.version.compareTo(m)<0&&(f.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),d.addEntry(T)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=ft();for(let h=0;h<o.mutationResults.length;++h)o.mutationResults[h].transformResults.length>0&&(l=l.add(o.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function $_(i){const e=Je(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function UA(i,e){const t=Je(i),n=e.snapshotVersion;let r=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Os.newChangeBuffer({trackRemovals:!0});r=t.Fs;const o=[];e.targetChanges.forEach((d,f)=>{const p=r.get(f);if(!p)return;o.push(t.hi.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.hi.addMatchingKeys(s,d.addedDocuments,f)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(an.EMPTY_BYTE_STRING,Ke.min()).withLastLimboFreeSnapshotVersion(Ke.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,n)),r=r.insert(f,g),function(T,m,v){return T.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=LA?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,g,d)&&o.push(t.hi.updateTargetData(s,g))});let l=Li(),h=ft();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(FA(s,a,e.documentUpdates).next(d=>{l=d.Ls,h=d.ks})),!n.isEqual(Ke.min())){const d=t.hi.getLastRemoteSnapshotVersion(s).next(f=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return oe.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.Fs=r,s))}function FA(i,e,t){let n=ft(),r=ft();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let a=Li();return t.forEach((o,l)=>{const h=s.get(o);l.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(o)),l.isNoDocument()&&l.version.isEqual(Ke.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):we(td,"Ignoring outdated watch update for ",o,". Current version:",h.version," Watch version:",l.version)}),{Ls:a,ks:r}})}function VA(i,e){const t=Je(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=zh),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function jA(i,e){const t=Je(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.hi.getTargetData(n,e).next(s=>s?(r=s,oe.resolve(r)):t.hi.allocateTargetId(n).next(a=>(r=new Ji(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.hi.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Fs.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(n.targetId,n),t.Ms.set(e,n.targetId)),n})}async function rh(i,e,t){const n=Je(i),r=n.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!_a(a))throw a;we(td,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(r.target)}function Rp(i,e,t){const n=Je(i);let r=Ke.min(),s=ft();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,h,d){const f=Je(l),p=f.Ms.get(d);return p!==void 0?oe.resolve(f.Fs.get(p)):f.hi.getTargetData(h,d)}(n,a,ni(e)).next(o=>{if(o)return r=o.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.Cs.getDocumentsMatchingQuery(a,e,t?r:Ke.min(),t?s:ft())).next(o=>(BA(n,MT(e),o),{documents:o,qs:s})))}function BA(i,e,t){let n=i.xs.get(e)||Ke.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.xs.set(e,n)}class Cp{constructor(){this.activeTargetIds=LT()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zA{constructor(){this.Fo=new Cp,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Cp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="ConnectivityMonitor";class Pp{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){we(Ip,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){we(Ip,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Go=null;function sh(){return Go===null?Go=function(){return 268435456+Math.round(2147483648*Math.random())}():Go++,"0x"+Go.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc="RestConnection",GA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class WA{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.Ko=this.databaseId.database===Ul?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,s){const a=sh(),o=this.Go(e,t.toUriEncodedString());we(Gc,`Sending RPC '${e}' ${a}:`,o,n);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,r,s);const{host:h}=new URL(o),d=da(h);return this.jo(e,o,l,n,d).then(f=>(we(Gc,`Received RPC '${e}' ${a}: `,f),f),f=>{throw cr(Gc,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",n),f})}Jo(e,t,n,r,s,a){return this.Wo(e,t,n,r,s)}zo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ma}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}Go(e,t){const n=GA[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn="WebChannelConnection";class XA extends WA{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,r,s){const a=sh();return new Promise((o,l)=>{const h=new J0;h.setWithCredentials(!0),h.listenOnce(Q0.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case yl.NO_ERROR:const f=h.getResponseJson();we(cn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case yl.TIMEOUT:we(cn,`RPC '${e}' ${a} timed out`),l(new Le(ce.DEADLINE_EXCEEDED,"Request time out"));break;case yl.HTTP_ERROR:const p=h.getStatus();if(we(cn,`RPC '${e}' ${a} failed with status:`,p,"response text:",h.getResponseText()),p>0){let g=h.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g?.error;if(y&&y.status&&y.message){const T=function(v){const M=v.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(M)>=0?M:ce.UNKNOWN}(y.status);l(new Le(T,y.message))}else l(new Le(ce.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Le(ce.UNAVAILABLE,"Connection failed."));break;default:Ge(9055,{c_:e,streamId:a,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{we(cn,`RPC '${e}' ${a} completed.`)}});const d=JSON.stringify(r);we(cn,`RPC '${e}' ${a} sending request:`,r),h.send(t,"POST",d,n,15)})}P_(e,t,n){const r=sh(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=t_(),o=e_(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const d=s.join("");we(cn,`Creating RPC '${e}' stream ${r}: ${d}`,l);const f=a.createWebChannel(d,l);this.T_(f);let p=!1,g=!1;const y=new qA({Ho:m=>{g?we(cn,`Not sending because RPC '${e}' stream ${r} is closed:`,m):(p||(we(cn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),p=!0),we(cn,`RPC '${e}' stream ${r} sending:`,m),f.send(m))},Yo:()=>f.close()}),T=(m,v,M)=>{m.listen(v,S=>{try{M(S)}catch(L){setTimeout(()=>{throw L},0)}})};return T(f,Ba.EventType.OPEN,()=>{g||(we(cn,`RPC '${e}' stream ${r} transport opened.`),y.s_())}),T(f,Ba.EventType.CLOSE,()=>{g||(g=!0,we(cn,`RPC '${e}' stream ${r} transport closed`),y.__(),this.I_(f))}),T(f,Ba.EventType.ERROR,m=>{g||(g=!0,cr(cn,`RPC '${e}' stream ${r} transport errored. Name:`,m.name,"Message:",m.message),y.__(new Le(ce.UNAVAILABLE,"The operation could not be completed")))}),T(f,Ba.EventType.MESSAGE,m=>{var v;if(!g){const M=m.data[0];vt(!!M,16349);const S=M,L=S?.error||((v=S[0])===null||v===void 0?void 0:v.error);if(L){we(cn,`RPC '${e}' stream ${r} received error:`,L);const V=L.status;let k=function(C){const x=Bt[C];if(x!==void 0)return O_(x)}(V),w=L.message;k===void 0&&(k=ce.INTERNAL,w="Unknown error status: "+V+" with message "+L.message),g=!0,y.__(new Le(k,w)),f.close()}else we(cn,`RPC '${e}' stream ${r} received:`,M),y.a_(M)}}),T(o,Z0.STAT_EVENT,m=>{m.stat===Xu.PROXY?we(cn,`RPC '${e}' stream ${r} detected buffering proxy`):m.stat===Xu.NOPROXY&&we(cn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{y.o_()},0),y}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function Wc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(i){return new JT(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=n,this.E_=r,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-n);r>0&&we("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np="PersistentStream";class K_{constructor(e,t,n,r,s,a,o,l){this.Fi=e,this.w_=n,this.S_=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Y_(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Ni(t.toString()),Ni("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.b_===t&&this.W_(n,r)},n=>{e(()=>{const r=new Le(ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(r)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(r=>{n(()=>this.G_(r))}),this.stream.onMessage(r=>{n(()=>++this.C_==1?this.j_(r):this.onNext(r))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return we(Np,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(we(Np,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $A extends K_{constructor(e,t,n,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=eA(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ke.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ke.min():a.readTime?ri(a.readTime):Ke.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=ih(this.serializer),t.addTarget=function(s,a){let o;const l=a.target;if(o=Qu(l)?{documents:iA(s,l)}:{query:rA(s,l).Vt},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=F_(s,a.resumeToken);const h=eh(s,a.expectedCount);h!==null&&(o.expectedCount=h)}else if(a.snapshotVersion.compareTo(Ke.min())>0){o.readTime=Hl(s,a.snapshotVersion.toTimestamp());const h=eh(s,a.expectedCount);h!==null&&(o.expectedCount=h)}return o}(this.serializer,e);const n=aA(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=ih(this.serializer),t.removeTarget=e,this.k_(t)}}class YA extends K_{constructor(e,t,n,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return vt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,vt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){vt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=nA(e.writeResults,e.commitTime),n=ri(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=ih(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>tA(this.serializer,n))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{}class JA extends KA{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new Le(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(e,th(t,n),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Le(ce.UNKNOWN,s.toString())})}Jo(e,t,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Jo(e,th(t,n),r,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Le(ce.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class QA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ni(t),this._a=!1):we("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="RemoteStore";class ZA{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(a=>{n.enqueueAndForget(async()=>{as(this)&&(we(Zr,"Restarting streams for network reachability change."),await async function(l){const h=Je(l);h.Ia.add(4),await Eo(h),h.Aa.set("Unknown"),h.Ia.delete(4),await _c(h)}(this))})}),this.Aa=new QA(n,r)}}async function _c(i){if(as(i))for(const e of i.da)await e(!0)}async function Eo(i){for(const e of i.da)await e(!1)}function J_(i,e){const t=Je(i);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),sd(t)?rd(t):va(t).x_()&&id(t,e))}function nd(i,e){const t=Je(i),n=va(t);t.Ta.delete(e),n.x_()&&Q_(t,e),t.Ta.size===0&&(n.x_()?n.B_():as(t)&&t.Aa.set("Unknown"))}function id(i,e){if(i.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ke.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}va(i).H_(e)}function Q_(i,e){i.Ra.$e(e),va(i).Y_(e)}function rd(i){i.Ra=new XT({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>i.Ta.get(e)||null,lt:()=>i.datastore.serializer.databaseId}),va(i).start(),i.Aa.aa()}function sd(i){return as(i)&&!va(i).M_()&&i.Ta.size>0}function as(i){return Je(i).Ia.size===0}function Z_(i){i.Ra=void 0}async function eM(i){i.Aa.set("Online")}async function tM(i){i.Ta.forEach((e,t)=>{id(i,e)})}async function nM(i,e){Z_(i),sd(i)?(i.Aa.la(e),rd(i)):i.Aa.set("Unknown")}async function iM(i,e,t){if(i.Aa.set("Online"),e instanceof U_&&e.state===2&&e.cause)try{await async function(r,s){const a=s.cause;for(const o of s.targetIds)r.Ta.has(o)&&(await r.remoteSyncer.rejectListen(o,a),r.Ta.delete(o),r.Ra.removeTarget(o))}(i,e)}catch(n){we(Zr,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Wl(i,n)}else if(e instanceof Sl?i.Ra.Ye(e):e instanceof k_?i.Ra.it(e):i.Ra.et(e),!t.isEqual(Ke.min()))try{const n=await $_(i.localStore);t.compareTo(n)>=0&&await function(s,a){const o=s.Ra.Pt(a);return o.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.Ta.get(h);d&&s.Ta.set(h,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,h)=>{const d=s.Ta.get(l);if(!d)return;s.Ta.set(l,d.withResumeToken(an.EMPTY_BYTE_STRING,d.snapshotVersion)),Q_(s,l);const f=new Ji(d.target,l,h,d.sequenceNumber);id(s,f)}),s.remoteSyncer.applyRemoteEvent(o)}(i,t)}catch(n){we(Zr,"Failed to raise snapshot:",n),await Wl(i,n)}}async function Wl(i,e,t){if(!_a(e))throw e;i.Ia.add(1),await Eo(i),i.Aa.set("Offline"),t||(t=()=>$_(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{we(Zr,"Retrying IndexedDB access"),await t(),i.Ia.delete(1),await _c(i)})}function ev(i,e){return e().catch(t=>Wl(i,t,e))}async function vc(i){const e=Je(i),t=pr(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:zh;for(;rM(e);)try{const r=await VA(e.localStore,n);if(r===null){e.Pa.length===0&&t.B_();break}n=r.batchId,sM(e,r)}catch(r){await Wl(e,r)}tv(e)&&nv(e)}function rM(i){return as(i)&&i.Pa.length<10}function sM(i,e){i.Pa.push(e);const t=pr(i);t.x_()&&t.Z_&&t.X_(e.mutations)}function tv(i){return as(i)&&!pr(i).M_()&&i.Pa.length>0}function nv(i){pr(i).start()}async function aM(i){pr(i).na()}async function oM(i){const e=pr(i);for(const t of i.Pa)e.X_(t.mutations)}async function lM(i,e,t){const n=i.Pa.shift(),r=Yh.from(n,e,t);await ev(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),await vc(i)}async function cM(i,e){e&&pr(i).Z_&&await async function(n,r){if(function(a){return WT(a)&&a!==ce.ABORTED}(r.code)){const s=n.Pa.shift();pr(n).N_(),await ev(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await vc(n)}}(i,e),tv(i)&&nv(i)}async function Lp(i,e){const t=Je(i);t.asyncQueue.verifyOperationInProgress(),we(Zr,"RemoteStore received new credentials");const n=as(t);t.Ia.add(3),await Eo(t),n&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await _c(t)}async function uM(i,e){const t=Je(i);e?(t.Ia.delete(2),await _c(t)):e||(t.Ia.add(2),await Eo(t),t.Aa.set("Unknown"))}function va(i){return i.Va||(i.Va=function(t,n,r){const s=Je(t);return s.ia(),new $A(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{Zo:eM.bind(null,i),e_:tM.bind(null,i),n_:nM.bind(null,i),J_:iM.bind(null,i)}),i.da.push(async e=>{e?(i.Va.N_(),sd(i)?rd(i):i.Aa.set("Unknown")):(await i.Va.stop(),Z_(i))})),i.Va}function pr(i){return i.ma||(i.ma=function(t,n,r){const s=Je(t);return s.ia(),new YA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),e_:aM.bind(null,i),n_:cM.bind(null,i),ea:oM.bind(null,i),ta:lM.bind(null,i)}),i.da.push(async e=>{e?(i.ma.N_(),await vc(i)):(await i.ma.stop(),i.Pa.length>0&&(we(Zr,`Stopping write stream with ${i.Pa.length} pending writes`),i.Pa=[]))})),i.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const a=Date.now()+n,o=new ad(e,t,a,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Le(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function od(i,e){if(Ni("AsyncQueue",`${e}: ${i}`),_a(i))return new Le(ce.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{static emptySet(e){return new Ys(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Fe.comparator(t.key,n.key):(t,n)=>Fe.comparator(t.key,n.key),this.keyedMap=za(),this.sortedSet=new Dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ys)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Ys;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this.fa=new Dt(Fe.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(t,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(t):e.type===1&&n.type===2?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ge(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class ra{constructor(e,t,n,r,s,a,o,l,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,r,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new ra(e,t,Ys.emptySet(t),a,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class dM{constructor(){this.queries=Op(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,n){const r=Je(t),s=r.queries;r.queries=Op(),s.forEach((a,o)=>{for(const l of o.wa)l.onError(n)})})(this,new Le(ce.ABORTED,"Firestore shutting down"))}}function Op(){return new ss(i=>E_(i),hc)}async function fM(i,e){const t=Je(i);let n=3;const r=e.query;let s=t.queries.get(r);s?!s.Sa()&&e.ba()&&(n=2):(s=new hM,n=e.ba()?0:1);try{switch(n){case 0:s.ya=await t.onListen(r,!0);break;case 1:s.ya=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(a){const o=od(a,`Initialization of query '${Vs(e.query)}' failed`);return void e.onError(o)}t.queries.set(r,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&ld(t)}async function pM(i,e){const t=Je(i),n=e.query;let r=3;const s=t.queries.get(n);if(s){const a=s.wa.indexOf(e);a>=0&&(s.wa.splice(a,1),s.wa.length===0?r=e.ba()?0:1:!s.Sa()&&e.ba()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function mM(i,e){const t=Je(i);let n=!1;for(const r of e){const s=r.query,a=t.queries.get(s);if(a){for(const o of a.wa)o.Ca(r)&&(n=!0);a.ya=r}}n&&ld(t)}function gM(i,e,t){const n=Je(i),r=n.queries.get(e);if(r)for(const s of r.wa)s.onError(t);n.queries.delete(e)}function ld(i){i.Da.forEach(e=>{e.next()})}var ah,kp;(kp=ah||(ah={})).Fa="default",kp.Cache="cache";class _M{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new ra(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const n=t!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=ra.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==ah.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e){this.key=e}}class rv{constructor(e){this.key=e}}class vM{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ft(),this.mutatedKeys=ft(),this.Xa=w_(e),this.eu=new Ys(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new Dp,r=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,a=r,o=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const p=r.get(d),g=dc(this.query,f)?f:null,y=!!p&&this.mutatedKeys.has(p.key),T=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let m=!1;p&&g?p.data.isEqual(g.data)?y!==T&&(n.track({type:3,doc:g}),m=!0):this.iu(p,g)||(n.track({type:2,doc:g}),m=!0,(l&&this.Xa(g,l)>0||h&&this.Xa(g,h)<0)&&(o=!0)):!p&&g?(n.track({type:0,doc:g}),m=!0):p&&!g&&(n.track({type:1,doc:p}),m=!0,(l||h)&&(o=!0)),m&&(g?(a=a.add(g),s=T?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{eu:a,ru:n,Ds:o,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const a=e.ru.pa();a.sort((d,f)=>function(g,y){const T=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ge(20277,{At:m})}};return T(g)-T(y)}(d.type,f.type)||this.Xa(d.doc,f.doc)),this.su(n),r=r!=null&&r;const o=t&&!r?this.ou():[],l=this.Za.size===0&&this.current&&!r?1:0,h=l!==this.Ya;return this.Ya=l,a.length!==0||h?{snapshot:new ra(this.query,e.eu,s,a,e.mutatedKeys,l===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Dp,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ft(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const t=[];return e.forEach(n=>{this.Za.has(n)||t.push(new rv(n))}),this.Za.forEach(n=>{e.has(n)||t.push(new iv(n))}),t}uu(e){this.Ha=e.qs,this.Za=ft();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return ra.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const cd="SyncEngine";class xM{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class yM{constructor(e){this.key=e,this.lu=!1}}class bM{constructor(e,t,n,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new ss(o=>E_(o),hc),this.Tu=new Map,this.Iu=new Set,this.du=new Dt(Fe.comparator),this.Eu=new Map,this.Au=new Qh,this.Ru={},this.Vu=new Map,this.mu=ia.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function EM(i,e,t=!0){const n=uv(i);let r;const s=n.Pu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.cu()):r=await sv(n,e,t,!0),r}async function wM(i,e){const t=uv(i);await sv(t,e,!0,!1)}async function sv(i,e,t,n){const r=await jA(i.localStore,ni(e)),s=r.targetId,a=i.sharedClientState.addLocalQueryTarget(s,t);let o;return n&&(o=await SM(i,e,s,a==="current",r.resumeToken)),i.isPrimaryClient&&t&&J_(i.remoteStore,r),o}async function SM(i,e,t,n,r){i.gu=(f,p,g)=>async function(T,m,v,M){let S=m.view.nu(v);S.Ds&&(S=await Rp(T.localStore,m.query,!1).then(({documents:w})=>m.view.nu(w,S)));const L=M&&M.targetChanges.get(m.targetId),V=M&&M.targetMismatches.get(m.targetId)!=null,k=m.view.applyChanges(S,T.isPrimaryClient,L,V);return Fp(T,m.targetId,k._u),k.snapshot}(i,f,p,g);const s=await Rp(i.localStore,e,!0),a=new vM(e,s.qs),o=a.nu(s.documents),l=bo.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),h=a.applyChanges(o,i.isPrimaryClient,l);Fp(i,t,h._u);const d=new xM(e,t,a);return i.Pu.set(e,d),i.Tu.has(t)?i.Tu.get(t).push(e):i.Tu.set(t,[e]),h.snapshot}async function TM(i,e,t){const n=Je(i),r=n.Pu.get(e),s=n.Tu.get(r.targetId);if(s.length>1)return n.Tu.set(r.targetId,s.filter(a=>!hc(a,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await rh(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&nd(n.remoteStore,r.targetId),oh(n,r.targetId)}).catch(ga)):(oh(n,r.targetId),await rh(n.localStore,r.targetId,!0))}async function AM(i,e){const t=Je(i),n=t.Pu.get(e),r=t.Tu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),nd(t.remoteStore,n.targetId))}async function MM(i,e,t){const n=DM(i);try{const r=await function(a,o){const l=Je(a),h=Pt.now(),d=o.reduce((g,y)=>g.add(y.key),ft());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=Li(),T=ft();return l.Os.getEntries(g,d).next(m=>{y=m,y.forEach((v,M)=>{M.isValidDocument()||(T=T.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(m=>{f=m;const v=[];for(const M of o){const S=jT(M,f.get(M.key).overlayedDocument);S!=null&&v.push(new br(M.key,S,m_(S.value.mapValue),ii.exists(!0)))}return l.mutationQueue.addMutationBatch(g,h,v,o)}).next(m=>{p=m;const v=m.applyToLocalDocumentSet(f,T);return l.documentOverlayCache.saveOverlays(g,m.batchId,v)})}).then(()=>({batchId:p.batchId,changes:T_(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(a,o,l){let h=a.Ru[a.currentUser.toKey()];h||(h=new Dt(lt)),h=h.insert(o,l),a.Ru[a.currentUser.toKey()]=h}(n,r.batchId,t),await wo(n,r.changes),await vc(n.remoteStore)}catch(r){const s=od(r,"Failed to persist write");t.reject(s)}}async function av(i,e){const t=Je(i);try{const n=await UA(t.localStore,e);e.targetChanges.forEach((r,s)=>{const a=t.Eu.get(s);a&&(vt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.lu=!0:r.modifiedDocuments.size>0?vt(a.lu,14607):r.removedDocuments.size>0&&(vt(a.lu,42227),a.lu=!1))}),await wo(t,n,e)}catch(n){await ga(n)}}function Up(i,e,t){const n=Je(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Pu.forEach((s,a)=>{const o=a.view.va(e);o.snapshot&&r.push(o.snapshot)}),function(a,o){const l=Je(a);l.onlineState=o;let h=!1;l.queries.forEach((d,f)=>{for(const p of f.wa)p.va(o)&&(h=!0)}),h&&ld(l)}(n.eventManager,e),r.length&&n.hu.J_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function RM(i,e,t){const n=Je(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Eu.get(e),s=r&&r.key;if(s){let a=new Dt(Fe.comparator);a=a.insert(s,fn.newNoDocument(s,Ke.min()));const o=ft().add(s),l=new mc(Ke.min(),new Map,new Dt(lt),a,o);await av(n,l),n.du=n.du.remove(s),n.Eu.delete(e),ud(n)}else await rh(n.localStore,e,!1).then(()=>oh(n,e,t)).catch(ga)}async function CM(i,e){const t=Je(i),n=e.batch.batchId;try{const r=await kA(t.localStore,e);lv(t,n,null),ov(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await wo(t,r)}catch(r){await ga(r)}}async function IM(i,e,t){const n=Je(i);try{const r=await function(a,o){const l=Je(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return l.mutationQueue.lookupMutationBatch(h,o).next(f=>(vt(f!==null,37113),d=f.keys(),l.mutationQueue.removeMutationBatch(h,f))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>l.localDocuments.getDocuments(h,d))})}(n.localStore,e);lv(n,e,t),ov(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await wo(n,r)}catch(r){await ga(r)}}function ov(i,e){(i.Vu.get(e)||[]).forEach(t=>{t.resolve()}),i.Vu.delete(e)}function lv(i,e,t){const n=Je(i);let r=n.Ru[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.Ru[n.currentUser.toKey()]=r}}function oh(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Tu.get(e))i.Pu.delete(n),t&&i.hu.pu(n,t);i.Tu.delete(e),i.isPrimaryClient&&i.Au.zr(e).forEach(n=>{i.Au.containsKey(n)||cv(i,n)})}function cv(i,e){i.Iu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(nd(i.remoteStore,t),i.du=i.du.remove(e),i.Eu.delete(t),ud(i))}function Fp(i,e,t){for(const n of t)n instanceof iv?(i.Au.addReference(n.key,e),PM(i,n)):n instanceof rv?(we(cd,"Document no longer in limbo: "+n.key),i.Au.removeReference(n.key,e),i.Au.containsKey(n.key)||cv(i,n.key)):Ge(19791,{yu:n})}function PM(i,e){const t=e.key,n=t.path.canonicalString();i.du.get(t)||i.Iu.has(n)||(we(cd,"New document in limbo: "+t),i.Iu.add(n),ud(i))}function ud(i){for(;i.Iu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Iu.values().next().value;i.Iu.delete(e);const t=new Fe(Lt.fromString(e)),n=i.mu.next();i.Eu.set(n,new yM(t)),i.du=i.du.insert(t,n),J_(i.remoteStore,new Ji(ni(Xh(t.path)),n,"TargetPurposeLimboResolution",oc.ue))}}async function wo(i,e,t){const n=Je(i),r=[],s=[],a=[];n.Pu.isEmpty()||(n.Pu.forEach((o,l)=>{a.push(n.gu(l,e,t).then(h=>{var d;if((h||t)&&n.isPrimaryClient){const f=h?!h.fromCache:(d=t?.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(h){r.push(h);const f=ed.Es(l.targetId,h);s.push(f)}}))}),await Promise.all(a),n.hu.J_(r),await async function(l,h){const d=Je(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>oe.forEach(h,p=>oe.forEach(p.Is,g=>d.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>oe.forEach(p.ds,g=>d.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!_a(f))throw f;we(td,"Failed to update sequence numbers: "+f)}for(const f of h){const p=f.targetId;if(!f.fromCache){const g=d.Fs.get(p),y=g.snapshotVersion,T=g.withLastLimboFreeSnapshotVersion(y);d.Fs=d.Fs.insert(p,T)}}}(n.localStore,s))}async function NM(i,e){const t=Je(i);if(!t.currentUser.isEqual(e)){we(cd,"User change. New user:",e.toKey());const n=await X_(t.localStore,e);t.currentUser=e,function(s,a){s.Vu.forEach(o=>{o.forEach(l=>{l.reject(new Le(ce.CANCELLED,a))})}),s.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await wo(t,n.Bs)}}function LM(i,e){const t=Je(i),n=t.Eu.get(e);if(n&&n.lu)return ft().add(n.key);{let r=ft();const s=t.Tu.get(e);if(!s)return r;for(const a of s){const o=t.Pu.get(a);r=r.unionWith(o.view.tu)}return r}}function uv(i){const e=Je(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=av.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RM.bind(null,e),e.hu.J_=mM.bind(null,e.eventManager),e.hu.pu=gM.bind(null,e.eventManager),e}function DM(i){const e=Je(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IM.bind(null,e),e}class ql{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return OA(this.persistence,new NA,e.initialUser,this.serializer)}Du(e){return new q_(Zh.Vi,this.serializer)}bu(e){return new zA}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ql.provider={build:()=>new ql};class OM extends ql{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){vt(this.persistence.referenceDelegate instanceof Gl,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new _A(n,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?xn.withCacheSize(this.cacheSizeBytes):xn.DEFAULT;return new q_(n=>Gl.Vi(n,t),this.serializer)}}class lh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Up(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=NM.bind(null,this.syncEngine),await uM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dM}()}createDatastore(e){const t=gc(e.databaseInfo.databaseId),n=function(s){return new XA(s)}(e.databaseInfo);return function(s,a,o,l){return new JA(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,s,a,o){return new ZA(n,r,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>Up(this.syncEngine,t,0),function(){return Pp.C()?new Pp:new HA}())}createSyncEngine(e,t){return function(r,s,a,o,l,h,d){const f=new bM(r,s,a,o,l,h);return d&&(f.fu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const s=Je(r);we(Zr,"RemoteStore shutting down."),s.Ia.add(5),await Eo(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}lh.provider={build:()=>new lh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ni("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr="FirestoreClient";class UM{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=dn.UNAUTHENTICATED,this.clientId=jh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{we(mr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(we(mr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=od(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qc(i,e){i.asyncQueue.verifyOperationInProgress(),we(mr,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(async r=>{n.isEqual(r)||(await X_(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>{cr("Terminating Firestore due to IndexedDb database deletion"),i.terminate().then(()=>{we("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(r=>{cr("Terminating Firestore due to IndexedDb database deletion failed",r)})}),i._offlineComponents=e}async function Vp(i,e){i.asyncQueue.verifyOperationInProgress();const t=await FM(i);we(mr,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(n=>Lp(e.remoteStore,n)),i.setAppCheckTokenChangeListener((n,r)=>Lp(e.remoteStore,r)),i._onlineComponents=e}async function FM(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){we(mr,"Using user provided OfflineComponentProvider");try{await qc(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===ce.FAILED_PRECONDITION||r.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;cr("Error using user provided cache. Falling back to memory cache: "+t),await qc(i,new ql)}}else we(mr,"Using default OfflineComponentProvider"),await qc(i,new OM(void 0));return i._offlineComponents}async function hv(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(we(mr,"Using user provided OnlineComponentProvider"),await Vp(i,i._uninitializedComponentsProvider._online)):(we(mr,"Using default OnlineComponentProvider"),await Vp(i,new lh))),i._onlineComponents}function VM(i){return hv(i).then(e=>e.syncEngine)}async function jM(i){const e=await hv(i),t=e.eventManager;return t.onListen=EM.bind(null,e.syncEngine),t.onUnlisten=TM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=AM.bind(null,e.syncEngine),t}function BM(i,e,t={}){const n=new rr;return i.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,h){const d=new kM({next:p=>{d.Ou(),a.enqueueAndForget(()=>pM(s,f));const g=p.docs.has(o);!g&&p.fromCache?h.reject(new Le(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?h.reject(new Le(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(p)},error:p=>h.reject(p)}),f=new _M(Xh(o.path),d,{includeMetadataChanges:!0,ka:!0});return fM(s,f)}(await jM(i),i.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="firestore.googleapis.com",Bp=!0;class zp{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Le(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fv,this.ssl=Bp}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Bp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=W_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mA)throw new Le(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dv((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Le(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Le(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Le(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hd{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zp({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Le(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Le(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zp(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new HS;switch(n.type){case"firstParty":return new XS(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Le(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=jp.get(t);n&&(we("ComponentProvider","Removing Datastore"),jp.delete(t),n.terminate())}(this),Promise.resolve()}}function zM(i,e,t,n={}){var r;i=Qr(i,hd);const s=da(e),a=i._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:i._getEmulatorOptions()}),l=`${e}:${t}`;s&&(o0(`https://${l}`),l0("Firestore",!0)),a.host!==fv&&a.host!==l&&cr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:n});if(!Xr(h,o)&&(i._setSettings(h),n.mockUserToken)){let d,f;if(typeof n.mockUserToken=="string")d=n.mockUserToken,f=dn.MOCK_USER;else{d=Zy(n.mockUserToken,(r=i._app)===null||r===void 0?void 0:r.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Le(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new dn(p)}i._authCredentials=new GS(new i_(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new dd(this.firestore,e,this._query)}}class qt{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new co(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qt(this.firestore,e,this._key)}toJSON(){return{type:qt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(xo(t,qt._jsonSchema))return new qt(e,n||null,new Fe(Lt.fromString(t.referencePath)))}}qt._jsonSchemaVersion="firestore/documentReference/1.0",qt._jsonSchema={type:zt("string",qt._jsonSchemaVersion),referencePath:zt("string")};class co extends dd{constructor(e,t,n){super(e,t,Xh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qt(this.firestore,null,new Fe(e))}withConverter(e){return new co(this.firestore,e,this._path)}}function Br(i,e,...t){if(i=sn(i),arguments.length===1&&(e=jh.newId()),QS("doc","path",e),i instanceof hd){const n=Lt.fromString(e,...t);return np(n),new qt(i,null,new Fe(n))}{if(!(i instanceof qt||i instanceof co))throw new Le(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Lt.fromString(e,...t));return np(n),new qt(i.firestore,i instanceof co?i.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="AsyncQueue";class Gp{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Y_(this,"async_queue_retry"),this.oc=()=>{const n=Wc();n&&we(Hp,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const t=Wc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Wc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new rr;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!_a(e))throw e;we(Hp,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,Ni("INTERNAL UNHANDLED ERROR: ",Wp(n)),n}).then(n=>(this.nc=!1,n))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=ad.createAndSchedule(this,e,t,n,s=>this.lc(s));return this.ec.push(r),r}ac(){this.tc&&Ge(47125,{hc:Wp(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Wp(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class xc extends hd{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Gp,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gp(e),this._firestoreClient=void 0,await e}}}function HM(i,e){const t=typeof i=="object"?i:d0(),n=typeof i=="string"?i:Ul,r=Mh(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=Jy("firestore");s&&zM(r,...s)}return r}function pv(i){if(i._terminated)throw new Le(ce.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||GM(i),i._firestoreClient}function GM(i){var e,t,n;const r=i._freezeSettings(),s=function(o,l,h,d){return new uT(o,l,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,dv(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,r);i._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=r.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(i._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),i._firestoreClient=new UM(i._authCredentials,i._appCheckCredentials,i._queue,s,i._componentsProvider&&function(o){const l=o?._online.build();return{_offline:o?._offline.build(l),_online:l}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Un(an.fromBase64String(e))}catch(t){throw new Le(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Un(an.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Un._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xo(e,Un._jsonSchema))return Un.fromBase64String(e.bytes)}}Un._jsonSchemaVersion="firestore/bytes/1.0",Un._jsonSchema={type:zt("string",Un._jsonSchemaVersion),bytes:zt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Le(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Le(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Le(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return lt(this._lat,e._lat)||lt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:si._jsonSchemaVersion}}static fromJSON(e){if(xo(e,si._jsonSchema))return new si(e.latitude,e.longitude)}}si._jsonSchemaVersion="firestore/geoPoint/1.0",si._jsonSchema={type:zt("string",si._jsonSchemaVersion),latitude:zt("number"),longitude:zt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xo(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new ai(e.vectorValues);throw new Le(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:zt("string",ai._jsonSchemaVersion),vectorValues:zt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM=/^__.*__$/;class qM{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new br(e,this.data,this.fieldMask,t,this.fieldTransforms):new yo(e,this.data,t,this.fieldTransforms)}}class mv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new br(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function gv(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ge(40011,{Ec:i})}}class pd{constructor(e,t,n,r,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new pd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.fc(e),r}gc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Xl(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(gv(this.Ec)&&WM.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class XM{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||gc(e)}Dc(e,t,n,r=!1){return new pd({Ec:e,methodName:t,bc:n,path:nn.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _v(i){const e=i._freezeSettings(),t=gc(i._databaseId);return new XM(i._databaseId,!!e.ignoreUndefinedProperties,t)}function $M(i,e,t,n,r,s={}){const a=i.Dc(s.merge||s.mergeFields?2:0,e,t,r);md("Data must be an object, but it was:",a,n);const o=vv(n,a);let l,h;if(s.merge)l=new Pn(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const p=ch(e,f,t);if(!a.contains(p))throw new Le(ce.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);yv(d,p)||d.push(p)}l=new Pn(d),h=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,h=a.fieldTransforms;return new qM(new bn(o),l,h)}class bc extends fd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bc}}function YM(i,e,t,n){const r=i.Dc(1,e,t);md("Data must be an object, but it was:",r,n);const s=[],a=bn.empty();yr(n,(l,h)=>{const d=gd(e,l,t);h=sn(h);const f=r.gc(d);if(h instanceof bc)s.push(d);else{const p=Ec(h,f);p!=null&&(s.push(d),a.set(d,p))}});const o=new Pn(s);return new mv(a,o,r.fieldTransforms)}function KM(i,e,t,n,r,s){const a=i.Dc(1,e,t),o=[ch(e,n,t)],l=[r];if(s.length%2!=0)throw new Le(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)o.push(ch(e,s[p])),l.push(s[p+1]);const h=[],d=bn.empty();for(let p=o.length-1;p>=0;--p)if(!yv(h,o[p])){const g=o[p];let y=l[p];y=sn(y);const T=a.gc(g);if(y instanceof bc)h.push(g);else{const m=Ec(y,T);m!=null&&(h.push(g),d.set(g,m))}}const f=new Pn(h);return new mv(d,f,a.fieldTransforms)}function Ec(i,e){if(xv(i=sn(i)))return md("Unsupported field value:",e,i),vv(i,e);if(i instanceof fd)return function(n,r){if(!gv(r.Ec))throw r.wc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.wc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,r){const s=[];let a=0;for(const o of n){let l=Ec(o,r.yc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(i,e)}return function(n,r){if((n=sn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return DT(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Pt.fromDate(n);return{timestampValue:Hl(r.serializer,s)}}if(n instanceof Pt){const s=new Pt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Hl(r.serializer,s)}}if(n instanceof si)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Un)return{bytesValue:F_(r.serializer,n._byteString)};if(n instanceof qt){const s=r.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw r.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Jh(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof ai)return function(a,o){return{mapValue:{fields:{[f_]:{stringValue:p_},[Fl]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw o.wc("VectorValues must only contain numeric values.");return $h(o.serializer,h)})}}}}}}(n,r);throw r.wc(`Unsupported field value: ${Bh(n)}`)}(i,e)}function vv(i,e){const t={};return o_(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yr(i,(n,r)=>{const s=Ec(r,e.Vc(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function xv(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Pt||i instanceof si||i instanceof Un||i instanceof qt||i instanceof fd||i instanceof ai)}function md(i,e,t){if(!xv(t)||!s_(t)){const n=Bh(t);throw n==="an object"?e.wc(i+" a custom object"):e.wc(i+" "+n)}}function ch(i,e,t){if((e=sn(e))instanceof yc)return e._internalPath;if(typeof e=="string")return gd(i,e);throw Xl("Field path arguments must be of type string or ",i,!1,void 0,t)}const JM=new RegExp("[~\\*/\\[\\]]");function gd(i,e,t){if(e.search(JM)>=0)throw Xl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new yc(...e.split("."))._internalPath}catch{throw Xl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Xl(i,e,t,n,r){const s=n&&!n.isEmpty(),a=r!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${r}`),l+=")"),new Le(ce.INVALID_ARGUMENT,o+i+l)}function yv(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ev("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class QM extends bv{data(){return super.data()}}function Ev(i,e){return typeof e=="string"?gd(i,e):e instanceof yc?e._internalPath:e._delegate._internalPath}class ZM{convertValue(e,t="none"){switch(fr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(dr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ge(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return yr(e,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,r;const s=(r=(n=(t=e.fields)===null||t===void 0?void 0:t[Fl].arrayValue)===null||n===void 0?void 0:n.values)===null||r===void 0?void 0:r.map(a=>Ut(a.doubleValue));return new ai(s)}convertGeoPoint(e){return new si(Ut(e.latitude),Ut(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=cc(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ro(e));default:return null}}convertTimestamp(e){const t=hr(e);return new Pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Lt.fromString(e);vt(G_(n),9688,{name:e});const r=new so(n.get(1),n.get(3)),s=new Fe(n.popFirst(5));return r.isEqual(t)||Ni(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}class Ga{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zr extends bv{constructor(e,t,n,r,s,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ev("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Le(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=zr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}zr._jsonSchemaVersion="firestore/documentSnapshot/1.0",zr._jsonSchema={type:zt("string",zr._jsonSchemaVersion),bundleSource:zt("string","DocumentSnapshot"),bundleName:zt("string"),bundle:zt("string")};class Tl extends zr{data(e={}){return super.data(e)}}class Ja{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ga(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Tl(this._firestore,this._userDataWriter,n.key,n,new Ga(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Le(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(o=>{const l=new Tl(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Ga(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new Tl(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Ga(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return o.type!==0&&(h=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:t1(o.type),doc:l,oldIndex:h,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Le(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ja._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function t1(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ge(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(i){i=Qr(i,qt);const e=Qr(i.firestore,xc);return BM(pv(e),i._key).then(t=>r1(e,i,t))}Ja._jsonSchemaVersion="firestore/querySnapshot/1.0",Ja._jsonSchema={type:zt("string",Ja._jsonSchemaVersion),bundleSource:zt("string","QuerySnapshot"),bundleName:zt("string"),bundle:zt("string")};class n1 extends ZM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Un(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new qt(this.firestore,null,t)}}function uh(i,e,t){i=Qr(i,qt);const n=Qr(i.firestore,xc),r=e1(i.converter,e,t);return wv(n,[$M(_v(n),"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,ii.none())])}function i1(i,e,t,...n){i=Qr(i,qt);const r=Qr(i.firestore,xc),s=_v(r);let a;return a=typeof(e=sn(e))=="string"||e instanceof yc?KM(s,"updateDoc",i._key,e,t,n):YM(s,"updateDoc",i._key,e),wv(r,[a.toMutation(i._key,ii.exists(!0))])}function wv(i,e){return function(n,r){const s=new rr;return n.asyncQueue.enqueueAndForget(async()=>MM(await VM(n),r,s)),s.promise}(pv(i),e)}function r1(i,e,t){const n=t.docs.get(e._key),r=new n1(i);return new zr(i,r,e._key,n,new Ga(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){ma=r})(fa),Qs(new $r("firestore",(n,{instanceIdentifier:r,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new xc(new WS(n.getProvider("auth-internal")),new $S(a,n.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Le(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new so(h.options.projectId,d)}(a,r),a);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),nr(Jf,Qf,e),nr(Jf,Qf,"esm2017")})();const s1={apiKey:"AIzaSyBdmB-BBrwOIXXQQ87UfAHjAmoJEqJ7V4s",authDomain:"xpanix-b2f7c.firebaseapp.com",projectId:"xpanix-b2f7c",storageBucket:"xpanix-b2f7c.firebasestorage.app",messagingSenderId:"654509076160",appId:"1:654509076160:web:f4f52ee9e07c1388f8c725"};let Xc,Fn,sr;try{Xc=Af().length?Af()[0]:h0(s1),Fn=BS(Xc),sr=HM(Xc)}catch(i){throw console.error("Firebase initialization failed:",i),new Error("Firebase configuration error. Please check your environment variables.")}function Sv(){const[i,e]=G.useState(null),[t,n]=G.useState(!0);return G.useEffect(()=>{const r=Pw(Fn,s=>{e(s),n(!1)});return()=>r()},[]),{user:i,loading:t}}function a1(){const[i,e]=G.useState(!1),[t,n]=G.useState(!1),[r,s]=G.useState(!1),{user:a}=Sv(),o=fi(),l=rs(),h=d=>{if(d.preventDefault(),l.pathname==="/"){const f=document.getElementById("about");f&&f.scrollIntoView({behavior:"smooth"})}else o("/"),setTimeout(()=>{const f=document.getElementById("about");f&&f.scrollIntoView({behavior:"smooth"})},100)};return c.jsxs("header",{className:"w-full fixed top-0 left-0 z-50 bg-black/40 backdrop-blur-md border-b border-white/10 shadow-lg transition-all duration-300",children:[c.jsxs("nav",{className:"container mx-auto flex items-center justify-between py-1 px-4 sm:px-10",children:[c.jsx("div",{className:"flex items-center",children:c.jsx(rt,{to:"/",className:"flex items-center",children:c.jsx("img",{src:"/logo.png",alt:"XPANIX Logo",className:"h-20 w-20 object-contain"})})}),c.jsxs("div",{className:"hidden lg:flex items-center gap-4 md:gap-6 xl:gap-10",children:[c.jsxs("ul",{className:"flex items-center gap-2 md:gap-4 xl:gap-8 text-white font-mono text-xs md:text-sm xl:text-base tracking-widest uppercase",children:[c.jsx("li",{className:"group relative px-1",children:c.jsxs(rt,{to:"/",className:"relative z-10 px-3 py-1 transition-colors duration-300",children:[c.jsx("span",{className:"absolute inset-0 bg-white rounded-md scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left z-0"}),c.jsx("span",{className:"relative z-10 group-hover:text-black transition-colors duration-300",children:"Home"})]})}),c.jsx("li",{className:"group relative px-1",children:c.jsxs("a",{href:"#about",onClick:h,className:"relative z-10 px-3 py-1 transition-colors duration-300 cursor-pointer",children:[c.jsx("span",{className:"absolute inset-0 bg-white rounded-md scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left z-0"}),c.jsx("span",{className:"relative z-10 group-hover:text-black transition-colors duration-300",children:"About"})]})}),c.jsxs("li",{className:"group relative px-1",children:[c.jsxs("button",{onClick:()=>n(!t),onMouseEnter:()=>n(!0),className:"relative z-10 px-3 py-1 transition-colors duration-300 flex items-center gap-1",children:[c.jsx("span",{className:"absolute inset-0 bg-white rounded-md scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left z-0"}),c.jsx("span",{className:"relative z-10 group-hover:text-black transition-colors duration-300",children:"SERVICES"}),c.jsx("svg",{className:`w-4 h-4 relative z-10 group-hover:text-black transition-transform duration-300 ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&c.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-black/90 border border-white/10 rounded-lg shadow-xl z-50",onMouseLeave:()=>n(!1),children:c.jsxs("div",{className:"py-2",children:[c.jsx(rt,{to:"/services",className:"block px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>n(!1),children:"All Services"}),c.jsx(rt,{to:"/web-development",className:"block px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>n(!1),children:"Web Development"}),c.jsx(rt,{to:"/app-development",className:"block px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>n(!1),children:"App Development"}),c.jsx(rt,{to:"/digital-marketing",className:"block px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>n(!1),children:"Digital Marketing"}),c.jsx(rt,{to:"/product-listing",className:"block px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>n(!1),children:"Product Listing"})]})})]}),c.jsx("li",{className:"group relative px-1",children:c.jsxs(rt,{to:"/portfolio",className:"relative z-10 px-3 py-1 transition-colors duration-300",children:[c.jsx("span",{className:"absolute inset-0 bg-white rounded-md scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left z-0"}),c.jsx("span",{className:"relative z-10 group-hover:text-black transition-colors duration-300",children:"Portfolio"})]})}),c.jsx("li",{className:"group relative px-1",children:c.jsxs(rt,{to:"/contact",className:"relative z-10 px-3 py-1 transition-colors duration-300",children:[c.jsx("span",{className:"absolute inset-0 bg-white rounded-md scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left z-0"}),c.jsx("span",{className:"relative z-10 group-hover:text-black transition-colors duration-300",children:"Contact us"})]})})]}),c.jsx("div",{className:"ml-2 flex gap-1 md:gap-2 xl:ml-4",children:a?c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>s(!r),onMouseEnter:()=>s(!0),className:"flex items-center gap-2 px-3 py-1 md:px-4 md:py-1.5 xl:px-5 xl:py-2 bg-white text-black font-mono rounded hover:bg-gray-200 transition-all tracking-widest uppercase text-xs md:text-sm xl:text-base shadow-md backdrop-blur duration-300",children:[c.jsx(Ws,{className:"w-4 h-4"}),a.displayName||a.email?.split("@")[0]||"Profile"]}),r&&c.jsx("div",{className:"absolute top-full right-0 mt-2 w-64 bg-black/90 border border-white/10 rounded-lg shadow-xl z-50",onMouseLeave:()=>s(!1),children:c.jsxs("div",{className:"py-2",children:[c.jsxs("div",{className:"px-4 py-2 border-b border-gray-700",children:[c.jsx("p",{className:"text-white font-medium",children:a.displayName||"User"}),c.jsx("p",{className:"text-gray-400 text-sm",children:a.email})]}),c.jsxs(rt,{to:"/profile",className:"flex items-center gap-3 px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>s(!1),children:[c.jsx(Ws,{className:"w-4 h-4"}),"My Profile"]}),c.jsxs(rt,{to:"/contact",className:"flex items-center gap-3 px-4 py-2 text-white hover:bg-white hover:text-black transition-colors",onClick:()=>s(!1),children:[c.jsx(Nu,{className:"w-4 h-4"}),"Support"]}),c.jsx("div",{className:"border-t border-gray-700 mt-2 pt-2",children:c.jsxs("button",{onClick:async()=>{await jf(Fn),window.location.href="/login",s(!1)},className:"flex items-center gap-3 px-4 py-2 text-red-400 hover:bg-red-600 hover:text-white transition-colors w-full text-left",children:[c.jsx(Lu,{className:"w-4 h-4"}),"Sign Out"]})})]})})]}):c.jsxs(c.Fragment,{children:[c.jsx(rt,{to:"/login",children:c.jsx("button",{className:"px-3 py-1 md:px-4 md:py-1.5 xl:px-5 xl:py-2 bg-white text-black font-mono rounded hover:bg-gray-200 transition-all tracking-widest uppercase text-xs md:text-sm xl:text-base shadow-md backdrop-blur duration-300",children:"log in"})}),c.jsx(rt,{to:"/signup",children:c.jsx("button",{className:"px-3 py-1 md:px-4 md:py-1.5 xl:px-5 xl:py-2 bg-black text-white font-mono rounded border border-white hover:bg-white hover:text-black transition-all tracking-widest uppercase text-xs md:text-sm xl:text-base shadow-md backdrop-blur duration-300",children:"Sign up"})})]})})]}),c.jsx("div",{className:"lg:hidden flex items-center",children:c.jsx("button",{className:"text-white p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>e(!0),"aria-label":"Open menu",children:c.jsx(Nx,{size:28})})})]}),i&&c.jsx("div",{className:"fixed inset-0 z-[60] flex items-start justify-center bg-black/60",children:c.jsxs("div",{className:"relative mt-8 w-[95vw] max-w-md rounded-2xl bg-black shadow-2xl flex flex-col items-stretch p-0",children:[c.jsxs("div",{className:"flex items-center justify-between px-6 pt-6 pb-4 border-b border-white/10",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("img",{src:"/logo.png",alt:"XPANIX Logo",className:"h-12 w-12 object-contain"})}),c.jsx("button",{className:"text-white p-2 rounded hover:bg-white/10 transition",onClick:()=>e(!1),"aria-label":"Close menu",children:c.jsx(Lx,{size:24})})]}),c.jsxs("div",{className:"flex flex-col gap-2 px-6 py-6",children:[c.jsx(rt,{to:"/",className:"text-white text-lg py-1 hover:text-blue-400 transition",onClick:()=>e(!1),children:"Home"}),c.jsx("a",{href:"#about",onClick:d=>{e(!1),h(d)},className:"text-white text-lg py-1 hover:text-blue-400 transition cursor-pointer",children:"About"}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>n(!t),className:"text-white text-lg py-1 hover:text-blue-400 transition flex items-center justify-between w-full",children:["Services",c.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&c.jsxs("div",{className:"mt-2 ml-4 space-y-1",children:[c.jsx(rt,{to:"/services",className:"block text-white text-base py-1 hover:text-blue-400 transition",onClick:()=>{e(!1),n(!1)},children:"All Services"}),c.jsx(rt,{to:"/web-development",className:"block text-white text-base py-1 hover:text-blue-400 transition",onClick:()=>{e(!1),n(!1)},children:"Web Development"}),c.jsx(rt,{to:"/app-development",className:"block text-white text-base py-1 hover:text-blue-400 transition",onClick:()=>{e(!1),n(!1)},children:"App Development"}),c.jsx(rt,{to:"/digital-marketing",className:"block text-white text-base py-1 hover:text-blue-400 transition",onClick:()=>{e(!1),n(!1)},children:"Digital Marketing"}),c.jsx(rt,{to:"/product-listing",className:"block text-white text-base py-1 hover:text-blue-400 transition",onClick:()=>{e(!1),n(!1)},children:"Product Listing"})]})]}),c.jsx(rt,{to:"/portfolio",className:"text-white text-lg py-1 hover:text-blue-400 transition",onClick:()=>e(!1),children:"Portfolio"}),c.jsx(rt,{to:"/contact",className:"text-white text-lg py-1 hover:text-blue-400 transition",onClick:()=>e(!1),children:"Contact us"}),c.jsx("div",{className:"py-2"}),a?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-4",children:[c.jsx("p",{className:"text-white font-medium",children:a.displayName||"User"}),c.jsx("p",{className:"text-gray-400 text-sm",children:a.email})]}),c.jsx(rt,{to:"/profile",className:"block",onClick:()=>e(!1),children:c.jsxs("button",{className:"w-full py-3 rounded-lg bg-blue-600 text-white font-semibold text-base shadow hover:bg-blue-700 transition flex items-center justify-center gap-2",children:[c.jsx(Ws,{className:"w-4 h-4"}),"My Profile"]})}),c.jsx(rt,{to:"/contact",className:"block",onClick:()=>e(!1),children:c.jsxs("button",{className:"w-full py-3 rounded-lg bg-gray-600 text-white font-semibold text-base shadow hover:bg-gray-700 transition flex items-center justify-center gap-2",children:[c.jsx(Nu,{className:"w-4 h-4"}),"Support"]})}),c.jsxs("button",{className:"w-full py-3 rounded-lg bg-red-600 text-white font-semibold text-base shadow hover:bg-red-700 transition flex items-center justify-center gap-2",onClick:async()=>{await jf(Fn),window.location.href="/login",e(!1)},children:[c.jsx(Lu,{className:"w-4 h-4"}),"Sign Out"]})]}):c.jsxs("div",{className:"flex gap-2 mt-2",children:[c.jsx(rt,{to:"/login",className:"w-1/2",onClick:()=>e(!1),children:c.jsx("button",{className:"w-full py-3 rounded-lg bg-white text-black font-semibold text-base shadow hover:bg-gray-200 transition",children:"log in"})}),c.jsx(rt,{to:"/signup",className:"w-1/2",onClick:()=>e(!1),children:c.jsx("button",{className:"w-full py-3 rounded-lg bg-black text-white font-semibold text-base border border-white shadow hover:bg-white hover:text-black transition",children:"Sign up"})})]})]})]})})]})}function o1(){return c.jsxs("footer",{className:"w-full bg-black text-white pt-16 pb-8",children:[c.jsxs("div",{className:"max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[c.jsxs("div",{className:"lg:col-span-1",children:[c.jsx("div",{className:"mb-6",children:c.jsx("img",{src:"/logo.png",alt:"XPANIX",className:"h-8 w-auto"})}),c.jsx("p",{className:"text-gray-300 mb-6 leading-relaxed",children:"Empowering businesses through innovative digital solutions and cutting-edge technology services."}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("a",{href:"#",className:"bg-gray-800 hover:bg-gray-700 p-3 rounded-full transition duration-300","aria-label":"Facebook",children:c.jsx(Dx,{className:"w-5 h-5"})}),c.jsx("a",{href:"#",className:"bg-gray-800 hover:bg-gray-700 p-3 rounded-full transition duration-300","aria-label":"Instagram",children:c.jsx(Ox,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold mb-6 relative",children:["Quick Links",c.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-0.5 bg-blue-400"})]}),c.jsxs("ul",{className:"space-y-3",children:[c.jsx("li",{children:c.jsx(rt,{to:"/",className:"text-gray-300 hover:text-white transition duration-300",children:"Home"})}),c.jsx("li",{children:c.jsx(rt,{to:"/#about",className:"text-gray-300 hover:text-white transition duration-300",children:"About Us"})}),c.jsx("li",{children:c.jsx(rt,{to:"/services",className:"text-gray-300 hover:text-white transition duration-300",children:"Services"})}),c.jsx("li",{children:c.jsx(rt,{to:"/portfolio",className:"text-gray-300 hover:text-white transition duration-300",children:"Portfolio"})}),c.jsx("li",{children:c.jsx(rt,{to:"/contact",className:"text-gray-300 hover:text-white transition duration-300",children:"Contact"})})]})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold mb-6 relative",children:["Our Services",c.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-0.5 bg-blue-400"})]}),c.jsxs("ul",{className:"space-y-3",children:[c.jsx("li",{children:c.jsx(rt,{to:"/web-development",className:"text-gray-300 hover:text-white transition duration-300",children:"Web Development"})}),c.jsx("li",{children:c.jsx(rt,{to:"/app-development",className:"text-gray-300 hover:text-white transition duration-300",children:"App Development"})}),c.jsx("li",{children:c.jsx(rt,{to:"/digital-marketing",className:"text-gray-300 hover:text-white transition duration-300",children:"Digital Marketing"})}),c.jsx("li",{children:c.jsx(rt,{to:"/product-listing",className:"text-gray-300 hover:text-white transition duration-300",children:"Product Listing"})})]})]}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold mb-6 relative",children:["Contact Info",c.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-0.5 bg-blue-400"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(of,{className:"w-5 h-5 text-blue-400 mt-1 flex-shrink-0"}),c.jsx("a",{href:"https://maps.google.com/?q=2+Eadgah+Road+Model+Town+Panipat+Haryana",target:"_blank",rel:"noopener noreferrer",className:"text-gray-300 hover:text-white transition duration-300 leading-relaxed cursor-pointer hover:underline",children:"2, Eadgah Road Model Town Panipat Haryana"})]}),c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(of,{className:"w-5 h-5 text-blue-400 mt-1 flex-shrink-0"}),c.jsx("a",{href:"https://maps.google.com/?q=D-91+West+Patel+Nagar+Patel+Nagar+New+Delhi",target:"_blank",rel:"noopener noreferrer",className:"text-gray-300 hover:text-white transition duration-300 leading-relaxed cursor-pointer hover:underline",children:"D-91 West Patel Nagar, Patel Nagar, New Delhi"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ug,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),c.jsx("a",{href:"mailto:info.xpanix@gmail.com",className:"text-gray-300 hover:text-white transition duration-300",children:"info.xpanix@gmail.com"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Fg,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),c.jsx("a",{href:"tel:+918930005190",className:"text-gray-300 hover:text-white transition duration-300",children:"+91 8930005190"})]})]})]})]}),c.jsx("div",{className:"max-w-7xl mx-auto mt-12 pt-8 border-t border-gray-700 px-6",children:c.jsxs("div",{className:"text-center text-gray-400 text-sm",children:[""," 2025 Xpanix. All rights reserved."]})})]})}let Tv=-1;const xa=i=>{addEventListener("pageshow",e=>{e.persisted&&(Tv=e.timeStamp,i(e))},!0)},ui=(i,e,t,n)=>{let r,s;return a=>{e.value>=0&&(a||n)&&(s=e.value-(r??0),(s||r===void 0)&&(r=e.value,e.delta=s,e.rating=((o,l)=>o>l[1]?"poor":o>l[0]?"needs-improvement":"good")(e.value,t),i(e)))}},vd=i=>{requestAnimationFrame(()=>requestAnimationFrame(()=>i()))},xd=()=>{const i=performance.getEntriesByType("navigation")[0];if(i&&i.responseStart>0&&i.responseStart<performance.now())return i},So=()=>xd()?.activationStart??0,hi=(i,e=-1)=>{const t=xd();let n="navigate";return Tv>=0?n="back-forward-cache":t&&(document.prerendering||So()>0?n="prerender":document.wasDiscarded?n="restore":t.type&&(n=t.type.replace(/_/g,"-"))),{name:i,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},$c=new WeakMap;function yd(i,e){return $c.get(i)||$c.set(i,new e),$c.get(i)}class l1{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const t=this.o[0],n=this.o.at(-1);this.i&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const To=(i,e,t={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(i)){const n=new PerformanceObserver(r=>{Promise.resolve().then(()=>{e(r.getEntries())})});return n.observe({type:i,buffered:!0,...t}),n}}catch{}},bd=i=>{let e=!1;return()=>{e||(i(),e=!0)}};let zs=-1;const qp=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,$l=i=>{document.visibilityState==="hidden"&&zs>-1&&(zs=i.type==="visibilitychange"?i.timeStamp:0,c1())},Xp=()=>{addEventListener("visibilitychange",$l,!0),addEventListener("prerenderingchange",$l,!0)},c1=()=>{removeEventListener("visibilitychange",$l,!0),removeEventListener("prerenderingchange",$l,!0)},Av=()=>{if(zs<0){const i=So();zs=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>t.name==="hidden"&&t.startTime>i)[0]?.startTime)??qp(),Xp(),xa(()=>{setTimeout(()=>{zs=qp(),Xp()})})}return{get firstHiddenTime(){return zs}}},wc=i=>{document.prerendering?addEventListener("prerenderingchange",()=>i(),!0):i()},$p=[1800,3e3],Mv=(i,e={})=>{wc(()=>{const t=Av();let n,r=hi("FCP");const s=To("paint",a=>{for(const o of a)o.name==="first-contentful-paint"&&(s.disconnect(),o.startTime<t.firstHiddenTime&&(r.value=Math.max(o.startTime-So(),0),r.entries.push(o),n(!0)))});s&&(n=ui(i,r,$p,e.reportAllChanges),xa(a=>{r=hi("FCP"),n=ui(i,r,$p,e.reportAllChanges),vd(()=>{r.value=performance.now()-a.timeStamp,n(!0)})}))})},Yp=[.1,.25],u1=(i,e={})=>{Mv(bd(()=>{let t,n=hi("CLS",0);const r=yd(e,l1),s=o=>{for(const l of o)r.h(l);r.i>n.value&&(n.value=r.i,n.entries=r.o,t())},a=To("layout-shift",s);a&&(t=ui(i,n,Yp,e.reportAllChanges),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(s(a.takeRecords()),t(!0))}),xa(()=>{r.i=0,n=hi("CLS",0),t=ui(i,n,Yp,e.reportAllChanges),vd(()=>t())}),setTimeout(t))}))};let Rv=0,Yc=1/0,Wo=0;const h1=i=>{for(const e of i)e.interactionId&&(Yc=Math.min(Yc,e.interactionId),Wo=Math.max(Wo,e.interactionId),Rv=Wo?(Wo-Yc)/7+1:0)};let hh;const Kp=()=>hh?Rv:performance.interactionCount??0,d1=()=>{"interactionCount"in performance||hh||(hh=To("event",h1,{type:"event",buffered:!0,durationThreshold:0}))};let Jp=0;class f1{u=[];l=new Map;m;v;p(){Jp=Kp(),this.u.length=0,this.l.clear()}P(){const e=Math.min(this.u.length-1,Math.floor((Kp()-Jp)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;const t=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>t.T){if(n?e.duration>n.T?(n.entries=[e],n.T=e.duration):e.duration===n.T&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],T:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((r,s)=>s.T-r.T),this.u.length>10){const r=this.u.splice(10);for(const s of r)this.l.delete(s.id)}this.v?.(n)}}}const Cv=i=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?i():(i=bd(i),document.addEventListener("visibilitychange",i,{once:!0}),e(()=>{i(),document.removeEventListener("visibilitychange",i)}))},Qp=[200,500],p1=(i,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&wc(()=>{d1();let t,n=hi("INP");const r=yd(e,f1),s=o=>{Cv(()=>{for(const h of o)r.h(h);const l=r.P();l&&l.T!==n.value&&(n.value=l.T,n.entries=l.entries,t())})},a=To("event",s,{durationThreshold:e.durationThreshold??40});t=ui(i,n,Qp,e.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(s(a.takeRecords()),t(!0))}),xa(()=>{r.p(),n=hi("INP"),t=ui(i,n,Qp,e.reportAllChanges)}))})};class m1{m;h(e){this.m?.(e)}}const Zp=[2500,4e3],g1=(i,e={})=>{wc(()=>{const t=Av();let n,r=hi("LCP");const s=yd(e,m1),a=l=>{e.reportAllChanges||(l=l.slice(-1));for(const h of l)s.h(h),h.startTime<t.firstHiddenTime&&(r.value=Math.max(h.startTime-So(),0),r.entries=[h],n())},o=To("largest-contentful-paint",a);if(o){n=ui(i,r,Zp,e.reportAllChanges);const l=bd(()=>{a(o.takeRecords()),o.disconnect(),n(!0)});for(const h of["keydown","click","visibilitychange"])addEventListener(h,()=>Cv(l),{capture:!0,once:!0});xa(h=>{r=hi("LCP"),n=ui(i,r,Zp,e.reportAllChanges),vd(()=>{r.value=performance.now()-h.timeStamp,n(!0)})})}})},em=[800,1800],dh=i=>{document.prerendering?wc(()=>dh(i)):document.readyState!=="complete"?addEventListener("load",()=>dh(i),!0):setTimeout(i)},_1=(i,e={})=>{let t=hi("TTFB"),n=ui(i,t,em,e.reportAllChanges);dh(()=>{const r=xd();r&&(t.value=Math.max(r.responseStart-So(),0),t.entries=[r],n(!0),xa(()=>{t=hi("TTFB",0),n=ui(i,t,em,e.reportAllChanges),n(!0)}))})};function v1(){if(!(typeof window>"u")){if(u1(xs),Mv(xs),p1(xs),g1(xs),_1(xs),"PerformanceObserver"in window){const i=new PerformanceObserver(e=>{e.getEntries().forEach(t=>{t.duration>50&&(console.warn("Long task detected:",{duration:t.duration,startTime:t.startTime,name:t.name}),xs({name:"Long Task",value:t.duration,id:`long-task-${Date.now()}`}))})});try{i.observe({entryTypes:["longtask"]})}catch{console.warn("Long task observer not supported")}}if("PerformanceObserver"in window){const i=new PerformanceObserver(e=>{e.getEntries().forEach(t=>{!t.hadRecentInput&&t.value>.1&&console.warn("Layout shift detected:",{value:t.value,sources:t.sources})})});try{i.observe({entryTypes:["layout-shift"]})}catch{console.warn("Layout shift observer not supported")}}}}function xs({name:i,value:e,id:t}){typeof window<"u"&&typeof window.gtag<"u"&&window.gtag("event",i,{custom_parameter_1:e,custom_parameter_2:t})}function x1(){if(typeof window>"u")return;const i={"Largest Contentful Paint":2500,"First Input Delay":100,"Cumulative Layout Shift":.1,"First Contentful Paint":1800,"Time to First Byte":800};window.addEventListener("load",()=>{setTimeout(()=>{Object.entries(i).forEach(([e,t])=>{console.log(`Performance Budget Check - ${e}: ${t}ms/units`)})},3e3)})}function y1(i,e={}){if(typeof window>"u"||!("IntersectionObserver"in window))return null;const t={root:null,rootMargin:"50px",threshold:.1,...e};return new IntersectionObserver(i,t)}function b1(){if(typeof window>"u")return;document.querySelectorAll("img:not([loading])").forEach((e,t)=>{t<3?e.setAttribute("loading","eager"):e.setAttribute("loading","lazy")})}class E1{stats;frameCount=0;lastTime=performance.now();renderer=null;scene=null;onStatsUpdate=null;constructor(){this.stats={fps:60,memoryUsage:0,renderTime:0,triangleCount:0,drawCalls:0,deviceCapabilities:this.detectDeviceCapabilities()}}detectDeviceCapabilities(){const e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),n=window.innerWidth<=768,r=t||n&&window.innerHeight<600;let s=!1;"performance"in window&&"memory"in performance&&(s=performance.memory.jsHeapSizeLimit/(1024*1024)<512);let a=!1,o=2048;const l=document.createElement("canvas"),h=l.getContext("webgl")||l.getContext("experimental-webgl");h&&(o=h.getParameter(h.MAX_TEXTURE_SIZE),a=o<2048);const d=r||s||a||window.innerWidth<768;let f=Math.min(window.devicePixelRatio||1,2);return d&&(f=Math.min(f,1)),a&&(f=1),{isMobile:r,isLowEnd:d,hasLowMemory:s,hasSlowGPU:a,pixelRatio:f,maxTextureSize:o}}setRenderer(e){this.renderer=e}setScene(e){this.scene=e}onUpdate(e){this.onStatsUpdate=e}update(){this.frameCount++;const e=performance.now();if(this.frameCount%60===0&&(this.stats.fps=6e4/(e-this.lastTime),this.lastTime=e),"performance"in window&&"memory"in performance){const t=performance.memory;this.stats.memoryUsage=t.usedJSHeapSize/(1024*1024)}if(this.renderer){const t=this.renderer.info;this.stats.triangleCount=t.render.triangles,this.stats.drawCalls=t.render.calls}this.stats.renderTime=e-this.lastTime,this.onStatsUpdate&&this.onStatsUpdate(this.stats),this.checkPerformanceWarnings()}checkPerformanceWarnings(){const e=[];this.stats.fps<30&&e.push(`Low FPS: ${this.stats.fps.toFixed(1)}`),this.stats.memoryUsage>200&&e.push(`High memory usage: ${this.stats.memoryUsage.toFixed(1)}MB`),this.stats.triangleCount>1e4&&e.push(`High triangle count: ${this.stats.triangleCount}`),e.length>0&&console.warn("ThreeJS Performance Warnings:",e.join(", "))}getStats(){return{...this.stats}}getDeviceCapabilities(){return this.stats.deviceCapabilities}shouldUseLowQuality(){const{isLowEnd:e,hasLowMemory:t,hasSlowGPU:n}=this.stats.deviceCapabilities;return e||t||n||this.stats.fps<30}getOptimalPixelRatio(){const{pixelRatio:e}=this.stats.deviceCapabilities;return this.stats.fps<30?Math.max(.5,e*.5):e}}const w1=new E1;function S1(){return G.useEffect(()=>{v1(),w1.onUpdate(e=>{}),x1();const i=setTimeout(()=>{b1()},1e3);return()=>{clearTimeout(i)}},[]),null}function T1(){const{pathname:i}=rs();return G.useEffect(()=>{window.scrollTo(0,0)},[i]),null}const sa=i=>{if(!i||i.trim()==="")return{isValid:!1,error:"Email is required"};const e=i.trim();if(console.log("Validating email:",e),!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return console.log("Basic email format failed"),{isValid:!1,error:"Please enter a valid email address"};if(e.startsWith("@")||e.endsWith("@")||e.startsWith(".")||e.endsWith(".")||e.includes("..")||e.includes("@.")||e.includes(".@"))return console.log("Invalid pattern detected"),{isValid:!1,error:"Please enter a valid email address"};if(e.length>254)return console.log("Email too long"),{isValid:!1,error:"Email address is too long"};const n=e.split("@")[0];if(console.log("Local part:",n),n.length<3)return console.log("Local part too short"),{isValid:!1,error:"Email address must be at least 3 characters before @"};if(n.length>64)return console.log("Local part too long"),{isValid:!1,error:"Email address cannot exceed 64 characters before @"};if(!/^[a-zA-Z0-9._%+-]+$/.test(n))return console.log("Local part contains invalid characters:",n),{isValid:!1,error:"Email address can only contain letters, numbers, dots, underscores, hyphens, and plus signs"};const s=e.split("@")[1];return console.log("Domain part:",s),s&&s.length>253?(console.log("Domain too long"),{isValid:!1,error:"Email address is too long"}):/\.[a-zA-Z]{2,}$/.test(e)?(console.log("Email format validation passed"),{isValid:!0}):(console.log("TLD validation failed"),{isValid:!1,error:"Please enter a valid email address with proper domain"})},Iv=async i=>{try{console.log("Starting email verification for:",i);const e=i.split("@")[0].toLowerCase(),t=i.split("@")[1]?.toLowerCase(),n=[/^test/,/^fake/,/^dummy/,/^example/,/^sample/,/^admin/,/^root/,/^user/,/^demo/,/^temp/,/^temporary/,/^fakeemail/,/^testemail/,/^example/,/^sample/,/^asdf/,/^qwerty/,/^123/,/^abc/,/^xyz/,/^aaa/,/^bbb/,/^test123/,/^fake123/,/^dummy123/,/^example123/,/^admin123/,/^user123/,/^demo123/,/^temp123/];for(const o of n)if(o.test(e))return console.log("Suspicious email pattern detected:",e),{exists:!1,error:"Please use a real email address, not a test or fake email."};if(e.length<3)return console.log("Local part too short:",e),{exists:!1,error:"Email address seems too short. Please use a real email address."};if(e.length>64)return console.log("Local part too long:",e),{exists:!1,error:"Email address seems too long. Please use a real email address."};if(["10minutemail.com","guerrillamail.com","tempmail.org","mailinator.com","throwaway.email","temp-mail.org","fakeinbox.com","sharklasers.com","getairmail.com","mailnesia.com","maildrop.cc","tempmailaddress.com","yopmail.com","mailcatch.com","spam4.me","tempr.email","tmpeml.com","tmpmail.org","tmpmail.net","dispostable.com","mailmetrash.com","mailnull.com","spamspot.com","temp-mail.io","guerrillamailblock.com"].includes(t))return console.log("Disposable email domain detected:",t),{exists:!1,error:"Disposable email addresses are not allowed. Please use a real email address."};if(["test.com","example.com","fake.com","dummy.com","sample.com","test.org","example.org","fake.org","dummy.org","sample.org","test.net","example.net","fake.net","dummy.net","sample.net","test.in","example.in","fake.in","dummy.in","sample.in"].includes(t))return console.log("Fake domain detected:",t),{exists:!1,error:"Please use a real email address, not a test domain."};const a=await Promise.allSettled([A1(i),M1(i),R1(i)]);console.log("API verification results:",a);for(const o of a)if(o.status==="fulfilled"&&o.value.exists)return console.log("Email verified as existing via API"),{exists:!0};return console.log("No API could verify email, using enhanced validation"),{exists:!0,error:"Email format is valid. Please ensure you use a real email address."}}catch(e){return console.error("Email verification error:",e),{exists:!1,error:"Could not verify email. Please use a real email address."}}},A1=async i=>{try{const e=await fetch(`https://emailvalidation.abstractapi.com/v1/?api_key=demo&email=${encodeURIComponent(i)}`);if(e.ok){const t=await e.json();return console.log("API1 verification response:",t),t.is_valid_format&&t.deliverability==="DELIVERABLE"?{exists:!0}:t.is_valid_format?{exists:!1,error:"Email address does not exist"}:{exists:!1,error:"Invalid email format"}}}catch{console.log("API1 verification failed")}return{exists:!1,error:"Could not verify email"}},M1=async i=>{try{const e=await fetch(`https://api.eva.pingutil.com/email?email=${encodeURIComponent(i)}`);if(e.ok){const t=await e.json();return console.log("API2 verification response:",t),t.status==="success"&&t.data.valid?{exists:!0}:{exists:!1,error:"Email address does not exist"}}}catch{console.log("API2 verification failed")}return{exists:!1,error:"Could not verify email"}},R1=async i=>{try{const e=await fetch(`https://api.email-validator.net/api/verify?Email=${encodeURIComponent(i)}`);if(e.ok){const t=await e.json();return console.log("API3 verification response:",t),t.formatCheck&&t.smtpCheck?{exists:!0}:t.formatCheck?{exists:!1,error:"Email address does not exist"}:{exists:!1,error:"Invalid email format"}}}catch{console.log("API3 verification failed")}return{exists:!1,error:"Could not verify email"}},Ed=i=>{if(!i||i.trim()==="")return{isValid:!0};const e=i.trim();return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)?e.startsWith("@")||e.endsWith("@")||e.startsWith(".")||e.endsWith(".")||e.includes("..")||e.includes("@.")||e.includes(".@")?{isValid:!1,error:"Please enter a valid email address"}:{isValid:!0}:{isValid:!1,error:"Please enter a valid email address"}},Hr=i=>{const e=i.replace(/\D/g,"");if(!e||e.trim()==="")return{isValid:!1,error:"Phone number is required"};if(e.length!==10)return{isValid:!1,error:"Phone number must be exactly 10 digits"};const t=["6","7","8","9"],n=e.charAt(0);return t.includes(n)?e.match(/^0{10}$/)?{isValid:!1,error:"Please enter a valid phone number"}:{isValid:!0}:{isValid:!1,error:"Please enter a valid Indian mobile number"}},wd=i=>{if(!i||i.trim()==="")return{isValid:!0};const e=i.replace(/\D/g,"");if(i!==e)return{isValid:!1,error:"Phone number should contain only digits"};if(e.length>10)return{isValid:!1,error:"Phone number cannot exceed 10 digits"};if(e.length===10){const t=["6","7","8","9"],n=e.charAt(0);if(!t.includes(n))return{isValid:!1,error:"Please enter a valid Indian mobile number"}}return{isValid:!0}},aa=i=>{if(!i||i.trim()==="")return{isValid:!1,error:"Name is required"};const e=i.trim();return e.length>20?{isValid:!1,error:"Name cannot exceed 20 characters"}:e.length<2?{isValid:!1,error:"Name must be at least 2 characters"}:/^[a-zA-Z\s\-'\.]+$/.test(e)?e.includes("  ")?{isValid:!1,error:"Name cannot contain consecutive spaces"}:i!==e?{isValid:!1,error:"Name cannot start or end with spaces"}:/[a-zA-Z]/.test(e)?e.match(/^[^a-zA-Z]*$/)?{isValid:!1,error:"Name must contain at least one letter"}:{isValid:!0}:{isValid:!1,error:"Name must contain at least one letter"}:{isValid:!1,error:"Name should only contain letters, spaces, hyphens, apostrophes, and dots"}},Sd=i=>{if(!i||i.trim()==="")return{isValid:!0};const e=i.trim();return e.length>20?{isValid:!1,error:"Name cannot exceed 20 characters"}:/^[a-zA-Z\s\-'\.]*$/.test(e)?e.includes("  ")?{isValid:!1,error:"Name cannot contain consecutive spaces"}:{isValid:!0}:{isValid:!1,error:"Name should only contain letters, spaces, hyphens, apostrophes, and dots"}},Td=i=>i.replace(/[^a-zA-Z\s\-'\.]/g,""),C1=({isOpen:i,onClose:e})=>{const[t,n]=G.useState({name:"",email:"",phone:"",company:"",message:"",service:""}),[r,s]=G.useState(!1),[a,o]=G.useState(!1),[l,h]=G.useState({}),[d,f]=G.useState({name:!1,email:!1,phone:!1,company:!1,service:!1,message:!1}),p=["Web Development","Mobile App Development","UI/UX Design","Digital Marketing","SEO Optimization","E-commerce Solutions","Custom Software","Other"],g=async()=>{console.log("Validating form with data:",t);const M={},S=aa(t.name);S.isValid||(M.name=S.error||"",console.log("Name validation failed:",S.error));const L=sa(t.email);if(!L.isValid)M.email=L.error||"",console.log("Email validation failed:",L.error);else{console.log("Basic email validation passed, verifying existence...");const k=await Iv(t.email);k.exists||(M.email=k.error||"Email address does not exist",console.log("Email existence verification failed:",k.error))}if(t.phone.trim()){const k=Hr(t.phone);k.isValid||(M.phone=k.error||"",console.log("Phone validation failed:",k.error))}t.service||(M.service="Please select a service",console.log("Service validation failed: Please select a service")),t.message.trim()||(M.message="Message is required",console.log("Message validation failed: Message is required")),console.log("Validation errors:",M),h(M);const V=Object.keys(M).length===0;return console.log("Form is valid:",V),V},y=M=>{const{name:S,value:L}=M.target;if(l[S]&&h(V=>({...V,[S]:""})),S==="name"){const k=Td(L).slice(0,20);n(A=>({...A,name:k}));const w=Sd(k);w.isValid?h(A=>({...A,name:""})):h(A=>({...A,name:w.error||""}));return}if(S==="phone"){const k=L.replace(/\D/g,"").slice(0,10);n(A=>({...A,phone:k}));const w=wd(k);w.isValid?h(A=>({...A,phone:""})):h(A=>({...A,phone:w.error||""}));return}if(n(V=>({...V,[S]:L})),S==="email"){const V=Ed(L);V.isValid?h(k=>({...k,email:""})):h(k=>({...k,email:V.error||""}))}},T=M=>{const{name:S,value:L}=M.target;if(f(V=>({...V,[S]:!0})),S==="name"){const V=aa(L);V.isValid?h(k=>({...k,name:""})):h(k=>({...k,name:V.error||""}))}else if(S==="email"){const V=sa(L);V.isValid?h(k=>({...k,email:""})):h(k=>({...k,email:V.error||""}))}else if(S==="phone"){const V=Hr(L);V.isValid?h(k=>({...k,phone:""})):h(k=>({...k,phone:V.error||""}))}},m=async M=>{if(M.preventDefault(),console.log("Form submitted, validating..."),!await g()){console.log("Form validation failed");return}console.log("Form validation passed, proceeding with WhatsApp redirect"),s(!0);try{console.log("Creating WhatsApp message...");const L=`
Hello! I am reaching out through your website contact form.

*My Details:*
 Name: ${t.name}
 Email: ${t.email}
 Phone: ${t.phone||"Not provided"}
 Company: ${t.company||"Not provided"}
 Service Interested In: ${t.service}

*Message:*
${t.message}

Best regards,
${t.name}
      `.trim(),V=`https://wa.me/918930005190?text=${encodeURIComponent(L)}`;console.log("WhatsApp URL:",V),console.log("Creating temporary link for WhatsApp redirect...");const k=document.createElement("a");k.href=V,k.target="_blank",k.rel="noopener noreferrer",document.body.appendChild(k),console.log("Clicking WhatsApp link..."),k.click(),document.body.removeChild(k),console.log("WhatsApp redirect completed"),o(!0),setTimeout(()=>{n({name:"",email:"",phone:"",company:"",message:"",service:""}),h({name:"",email:"",phone:"",company:"",service:"",message:""}),f({name:!1,email:!1,phone:!1,company:!1,service:!1,message:!1}),o(!1),e()},3e3)}catch(L){console.error("Form submission error:",L)}finally{s(!1)}},v=()=>{r||e()};return G.useEffect(()=>{const M=S=>{S.key==="Escape"&&i&&v()};return i&&(document.addEventListener("keydown",M),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",M),document.body.style.overflow="unset"}},[i]),c.jsx(Og,{children:i&&c.jsxs(c.Fragment,{children:[c.jsx(ct.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-md z-50",onClick:v}),c.jsx(ct.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"relative p-6 border-b border-gray-700/50",children:[c.jsx("button",{onClick:v,disabled:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-200 transition-colors disabled:opacity-50",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-100 mb-2",children:"Get In Touch"}),c.jsx("p",{className:"text-gray-300",children:"Let's discuss your project and bring your ideas to life!"})]})]}),c.jsx("form",{onSubmit:m,className:"p-6 space-y-4",children:a?c.jsxs(ct.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-8",children:[c.jsx("div",{className:"w-16 h-16 bg-green-500/20 backdrop-blur-sm rounded-full flex items-center justify-center mx-auto mb-4 border border-green-500/30",children:c.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),c.jsx("h3",{className:"text-xl font-semibold text-gray-100 mb-2",children:"Thank You!"}),c.jsx("p",{className:"text-gray-300",children:"We've received your message and will get back to you soon."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-200 mb-1",children:"Full Name *"}),c.jsx("input",{type:"text",id:"name",name:"name",value:t.name,onChange:y,onBlur:T,className:`w-full px-3 py-2 bg-gray-800/50 backdrop-blur-sm border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-100 placeholder-gray-400 ${l.name&&d.name?"border-red-400/50":"border-gray-600/50"}`,placeholder:"Enter your full name",maxLength:20}),l.name&&d.name&&c.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.name})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-200 mb-1",children:"Email Address *"}),c.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:y,onBlur:T,className:`w-full px-3 py-2 bg-gray-800/50 backdrop-blur-sm border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-100 placeholder-gray-400 ${l.email?"border-red-400/50":"border-gray-600/50"}`,placeholder:"Enter your email"}),l.email&&d.email&&c.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.email})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-200 mb-1",children:"Phone Number"}),c.jsx("input",{type:"tel",id:"phone",name:"phone",value:t.phone,onChange:y,onBlur:T,className:`w-full px-3 py-2 bg-gray-800/50 backdrop-blur-sm border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-100 placeholder-gray-400 ${l.phone&&d.phone?"border-red-400/50":"border-gray-600/50"}`,placeholder:"Enter 10 digits only (e.g., 9876543210)",maxLength:10}),l.phone&&d.phone&&c.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.phone})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-200 mb-1",children:"Company"}),c.jsx("input",{type:"text",id:"company",name:"company",value:t.company,onChange:y,onBlur:T,className:"w-full px-3 py-2 bg-gray-800/50 backdrop-blur-sm border border-gray-600/50 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-100 placeholder-gray-400",placeholder:"Enter your company name"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"service",className:"block text-sm font-medium text-gray-200 mb-1",children:"Service Interested In *"}),c.jsxs("select",{id:"service",name:"service",value:t.service,onChange:y,onBlur:T,className:`w-full px-3 py-2 bg-gray-800/50 backdrop-blur-sm border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-100 ${l.service?"border-red-400/50":"border-gray-600/50"}`,children:[c.jsx("option",{value:"",className:"bg-gray-800 text-gray-100",children:"Select a service"}),p.map(M=>c.jsx("option",{value:M,className:"bg-gray-800 text-gray-100",children:M},M))]}),l.service&&d.service&&c.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.service})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-200 mb-1",children:"Project Details *"}),c.jsx("textarea",{id:"message",name:"message",value:t.message,onChange:y,onBlur:T,rows:4,className:`w-full px-3 py-2 bg-gray-800/50 backdrop-blur-sm border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent text-gray-100 placeholder-gray-400 ${l.message?"border-red-400/50":"border-gray-600/50"}`,placeholder:"Tell us about your project requirements..."}),l.message&&d.message&&c.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.message})]}),c.jsx("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-gray-700 to-gray-600 text-gray-100 py-3 px-6 rounded-lg font-semibold hover:from-gray-600 hover:to-gray-500 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center backdrop-blur-sm border border-gray-600/50",children:r?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-100",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"Send Message"})]})})]})})]})})},I1=(i=5)=>{const[e,t]=G.useState(!1),[n,r]=G.useState(!1);return G.useEffect(()=>{if(sessionStorage.getItem("contactPopupShown")){r(!0);return}const l=setTimeout(()=>{t(!0),r(!0),sessionStorage.setItem("contactPopupShown","true")},i*1e3);return()=>clearTimeout(l)},[i]),{isPopupOpen:e,openPopup:()=>{t(!0)},closePopup:()=>{t(!1)},hasShownPopup:n}},P1=[{value:50,suffix:"+",label:"Happy Clients"},{value:99,suffix:"%",label:"Success Rate"},{value:4,suffix:"+",label:"Years Experience"}];function N1(i,e=1200){const[t,n]=G.useState(0),r=G.useRef(null);return G.useEffect(()=>{let s=0;const a=Math.ceil(i/(e/16));function o(){if(s+=a,s>=i){n(i);return}n(s),r.current=setTimeout(o,16)}return o(),()=>{r.current&&clearTimeout(r.current)}},[i,e]),t}function L1(){const i=G.useMemo(()=>P1,[]),e=i.map((t,n)=>N1(t.value,1200+n*200));return c.jsx("div",{className:"relative w-full py-2 bg-transparent overflow-hidden",children:c.jsx("div",{className:"relative z-10 flex flex-row items-center justify-between gap-2 sm:gap-6 md:gap-10 px-1 sm:px-2 md:px-4",children:i.map((t,n)=>c.jsxs("div",{className:"flex flex-col items-center flex-1 min-w-[60px]",children:[c.jsxs("span",{className:"text-lg sm:text-2xl md:text-4xl font-bold text-gray-100 mb-1",children:[e[n],t.suffix]}),c.jsx("span",{className:"text-xs sm:text-sm md:text-base text-gray-300 font-medium text-center",children:t.label})]},t.label))})})}function D1(){return c.jsx("div",{className:"absolute left-0 right-0 bottom-0 w-full h-[220px] pointer-events-none z-10",children:c.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 1440 220",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",style:{display:"block"},children:[c.jsxs("defs",{children:[c.jsxs("linearGradient",{id:"wave-gradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"0%",stopColor:"#fff",stopOpacity:"0.7"}),c.jsx("stop",{offset:"100%",stopColor:"#fff",stopOpacity:"0"})]}),c.jsxs("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[c.jsx("feGaussianBlur",{stdDeviation:"16",result:"coloredBlur"}),c.jsxs("feMerge",{children:[c.jsx("feMergeNode",{in:"coloredBlur"}),c.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),c.jsx("g",{filter:"url(#glow)",children:c.jsx("path",{children:c.jsx("animate",{attributeName:"d",dur:"6s",repeatCount:"indefinite",values:`
                M0,160 Q360,80 720,160 T1440,160 V220 H0Z;
                M0,160 Q360,200 720,120 T1440,160 V220 H0Z;
                M0,160 Q360,80 720,160 T1440,160 V220 H0Z
              `})})}),c.jsx("g",{children:c.jsx("path",{d:"M0,160 Q360,80 720,160 T1440,160 V220 H0Z",fill:"url(#wave-gradient)",opacity:"0.5",filter:"url(#glow)",transform:"scale(1,-1) translate(0,-320)"})})]})})}const Kc=["Expand","scale","grow","stand out","succeed"];function O1(){const[i,e]=G.useState(0),[t,n]=G.useState(0),[r,s]=G.useState(!1);return G.useEffect(()=>{if(t===Kc[i].length+1&&!r){setTimeout(()=>s(!0),1e3);return}if(t===0&&r){s(!1),e(o=>(o+1)%Kc.length);return}const a=setTimeout(()=>{n(o=>o+(r?-1:1))},r?60:120);return()=>clearTimeout(a)},[t,i,r]),c.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent font-extrabold",children:Kc[i].substring(0,t)})}function k1({children:i}){const e=fi(),[t,n]=G.useState(!1);G.useEffect(()=>{n(!0)},[]),G.useEffect(()=>{const a=setInterval(()=>{const o=document.querySelector("spline-viewer");if(o&&o.shadowRoot){const l=o.shadowRoot.querySelector("#logo");l&&(l.remove(),clearInterval(a))}},500);return()=>clearInterval(a)},[]);const r=()=>{e("/contact")},s=()=>{e("/portfolio")};return c.jsxs("section",{className:"relative w-full min-h-[400px] min-h-screen h-[100dvh] flex items-center justify-center overflow-hidden bg-black",children:[c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-20 px-2 sm:px-4 pointer-events-none",children:[c.jsx("div",{className:"mb-4 sm:mb-6",children:c.jsx("span",{className:"px-3 py-1.5 sm:px-4 sm:py-2 rounded-full bg-black/60 text-white text-xs sm:text-sm font-medium border border-white/10 shadow-lg backdrop-blur-md",children:"Crafting Unique Brand Identities"})}),c.jsxs("h1",{className:"text-xl xs:text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-white text-center mb-4 sm:mb-6 drop-shadow-lg leading-tight whitespace-nowrap",children:["Empowering Brands to ",c.jsx(O1,{})]}),c.jsx("p",{className:"text-xs xs:text-sm sm:text-base md:text-lg text-gray-200 text-center max-w-xs sm:max-w-md md:max-w-xl mb-6 sm:mb-8",children:"Smart IT solutions that power your growth  from web and app development to design and digital ads."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 w-full sm:w-auto items-center justify-center mb-10 max-w-md",children:[c.jsx("button",{onClick:r,className:"glow-btn px-5 py-2 rounded-lg bg-black/80 text-white font-semibold border border-white/10 shadow pointer-events-auto text-base relative overflow-hidden",children:"Get Started Now"}),c.jsx("button",{onClick:s,className:"glow-btn px-5 py-2 rounded-lg bg-black/80 text-white font-semibold border border-white/10 shadow pointer-events-auto text-base relative overflow-hidden",children:"See Projects"})]}),c.jsx("div",{className:"w-full max-w-3xl mx-auto",children:c.jsx(L1,{})})]}),i&&c.jsx("div",{className:"absolute inset-0 w-full h-full z-10 flex items-center justify-center px-2 sm:px-4",children:c.jsxs("div",{className:"w-full h-full max-w-full max-h-full flex items-center justify-center",children:[c.jsx("div",{className:"block sm:hidden w-full h-full flex items-center justify-center",children:c.jsx("img",{src:"/threshold-dark-ambient-ui.gif",alt:"Ambient UI Animation",className:"w-full h-full object-cover rounded-lg opacity-60"})}),c.jsx("div",{className:"hidden sm:flex w-full h-full sm:w-full sm:h-full md:w-full md:h-full lg:w-full lg:h-full items-center justify-center",children:i})]})}),c.jsx(D1,{})]})}const tm=(i,e,t,n)=>{i.style.transition=`${e} ${t}ms ${n}`},Ei=(i,e,t)=>Math.min(Math.max(i,e),t);class U1{constructor(e,t){this.glareAngle=0,this.glareOpacity=0,this.calculateGlareSize=a=>{const{width:o,height:l}=a,h=Math.sqrt(o**2+l**2);return{width:h,height:h}},this.setSize=a=>{const o=this.calculateGlareSize(a);this.glareEl.style.width=`${o.width}px`,this.glareEl.style.height=`${o.height}px`},this.update=(a,o,l,h)=>{this.updateAngle(a,o.glareReverse),this.updateOpacity(a,o,l,h)},this.updateAngle=(a,o)=>{const{xPercentage:l,yPercentage:h}=a,d=180/Math.PI,f=l?Math.atan2(h,-l)*d:0;this.glareAngle=f-(o?180:0)},this.updateOpacity=(a,o,l,h)=>{const{xPercentage:d,yPercentage:f}=a,{glarePosition:p,glareReverse:g,glareMaxOpacity:y}=o,T=l?-1:1,m=h?-1:1,v=g?-1:1;let M=0;switch(p){case"top":M=-d*T*v;break;case"right":M=f*m*v;break;case"bottom":case void 0:M=d*T*v;break;case"left":M=-f*m*v;break;case"all":M=Math.hypot(d,f)}const S=Ei(M,0,100);this.glareOpacity=S*y/100},this.render=a=>{const{glareColor:o}=a;this.glareEl.style.transform=`rotate(${this.glareAngle}deg) translate(-50%, -50%)`,this.glareEl.style.opacity=this.glareOpacity.toString(),this.glareEl.style.background=`linear-gradient(0deg, rgba(255,255,255,0) 0%, ${o} 100%)`},this.glareWrapperEl=document.createElement("div"),this.glareEl=document.createElement("div"),this.glareWrapperEl.appendChild(this.glareEl),this.glareWrapperEl.className="glare-wrapper",this.glareEl.className="glare";const n={position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden",borderRadius:t,WebkitMaskImage:"-webkit-radial-gradient(white, black)",pointerEvents:"none"},r=this.calculateGlareSize(e),s={position:"absolute",top:"50%",left:"50%",transformOrigin:"0% 0%",pointerEvents:"none",width:`${r.width}px`,height:`${r.height}px`};Object.assign(this.glareWrapperEl.style,n),Object.assign(this.glareEl.style,s)}}class F1{constructor(){this.tiltAngleX=0,this.tiltAngleY=0,this.tiltAngleXPercentage=0,this.tiltAngleYPercentage=0,this.update=(e,t)=>{this.updateTilt(e,t),this.updateTiltManualInput(e,t),this.updateTiltReverse(t),this.updateTiltLimits(t)},this.updateTilt=(e,t)=>{const{xPercentage:n,yPercentage:r}=e,{tiltMaxAngleX:s,tiltMaxAngleY:a}=t;this.tiltAngleX=n*s/100,this.tiltAngleY=r*a/100*-1},this.updateTiltManualInput=(e,t)=>{const{tiltAngleXManual:n,tiltAngleYManual:r,tiltMaxAngleX:s,tiltMaxAngleY:a}=t;(n!==null||r!==null)&&(this.tiltAngleX=n!==null?n:0,this.tiltAngleY=r!==null?r:0,e.xPercentage=100*this.tiltAngleX/s,e.yPercentage=100*this.tiltAngleY/a)},this.updateTiltReverse=e=>{const t=e.tiltReverse?-1:1;this.tiltAngleX=t*this.tiltAngleX,this.tiltAngleY=t*this.tiltAngleY},this.updateTiltLimits=e=>{const{tiltAxis:t}=e;this.tiltAngleX=Ei(this.tiltAngleX,-90,90),this.tiltAngleY=Ei(this.tiltAngleY,-90,90),t&&(this.tiltAngleX=t==="x"?this.tiltAngleX:0,this.tiltAngleY=t==="y"?this.tiltAngleY:0)},this.updateTiltAnglesPercentage=e=>{const{tiltMaxAngleX:t,tiltMaxAngleY:n}=e;this.tiltAngleXPercentage=this.tiltAngleX/t*100,this.tiltAngleYPercentage=this.tiltAngleY/n*100},this.render=e=>{e.style.transform+=`rotateX(${this.tiltAngleX}deg) rotateY(${this.tiltAngleY}deg) `}}}const V1={scale:1,perspective:1e3,flipVertically:!1,flipHorizontally:!1,reset:!0,transitionEasing:"cubic-bezier(.03,.98,.52,.99)",transitionSpeed:400,trackOnWindow:!1,gyroscope:!1,tiltEnable:!0,tiltReverse:!1,tiltAngleXInitial:0,tiltAngleYInitial:0,tiltMaxAngleX:20,tiltMaxAngleY:20,tiltAxis:void 0,tiltAngleXManual:null,tiltAngleYManual:null,glareEnable:!1,glareMaxOpacity:.7,glareColor:"#ffffff",glarePosition:"bottom",glareReverse:!1,glareBorderRadius:"0"};class Yl extends G.PureComponent{constructor(){super(...arguments),this.wrapperEl={node:null,size:{width:0,height:0,left:0,top:0},clientPosition:{x:null,y:null,xPercentage:0,yPercentage:0},updateAnimationId:null,scale:1},this.tilt=null,this.glare=null,this.addDeviceOrientationEventListener=async()=>{if(!window.DeviceOrientationEvent)return;const e=DeviceOrientationEvent.requestPermission;typeof e=="function"?await e()==="granted"&&window.addEventListener("deviceorientation",this.onMove):window.addEventListener("deviceorientation",this.onMove)},this.setSize=()=>{this.setWrapperElSize(),this.glare&&this.glare.setSize(this.wrapperEl.size)},this.mainLoop=e=>{this.wrapperEl.updateAnimationId!==null&&cancelAnimationFrame(this.wrapperEl.updateAnimationId),this.processInput(e),this.update(e.type),this.wrapperEl.updateAnimationId=requestAnimationFrame(this.renderFrame)},this.onEnter=e=>{const{onEnter:t}=this.props;this.setSize(),this.wrapperEl.node.style.willChange="transform",this.setTransitions(),t&&t({event:e})},this.onMove=e=>{this.mainLoop(e),this.emitOnMove(e)},this.onLeave=e=>{const{onLeave:t}=this.props;if(this.setTransitions(),t&&t({event:e}),this.props.reset){const n=new CustomEvent("autoreset");this.onMove(n)}},this.processInput=e=>{const{scale:t}=this.props;switch(e.type){case"mousemove":this.wrapperEl.clientPosition.x=e.pageX,this.wrapperEl.clientPosition.y=e.pageY,this.wrapperEl.scale=t;break;case"touchmove":this.wrapperEl.clientPosition.x=e.touches[0].pageX,this.wrapperEl.clientPosition.y=e.touches[0].pageY,this.wrapperEl.scale=t;break;case"deviceorientation":this.processInputDeviceOrientation(e),this.wrapperEl.scale=t;break;case"autoreset":{const{tiltAngleXInitial:n,tiltAngleYInitial:r,tiltMaxAngleX:s,tiltMaxAngleY:a}=this.props,o=r/a*100;this.wrapperEl.clientPosition.xPercentage=Ei(n/s*100,-100,100),this.wrapperEl.clientPosition.yPercentage=Ei(o,-100,100),this.wrapperEl.scale=1;break}}},this.processInputDeviceOrientation=e=>{if(!e.gamma||!e.beta||!this.props.gyroscope)return;const{tiltMaxAngleX:t,tiltMaxAngleY:n}=this.props,r=e.gamma;this.wrapperEl.clientPosition.xPercentage=e.beta/t*100,this.wrapperEl.clientPosition.yPercentage=r/n*100,this.wrapperEl.clientPosition.xPercentage=Ei(this.wrapperEl.clientPosition.xPercentage,-100,100),this.wrapperEl.clientPosition.yPercentage=Ei(this.wrapperEl.clientPosition.yPercentage,-100,100)},this.update=e=>{const{tiltEnable:t,flipVertically:n,flipHorizontally:r}=this.props;e!=="autoreset"&&e!=="deviceorientation"&&e!=="propChange"&&this.updateClientInput(),t&&this.tilt.update(this.wrapperEl.clientPosition,this.props),this.updateFlip(),this.tilt.updateTiltAnglesPercentage(this.props),this.glare&&this.glare.update(this.wrapperEl.clientPosition,this.props,n,r)},this.updateClientInput=()=>{const{trackOnWindow:e}=this.props;let t,n;if(e){const{x:r,y:s}=this.wrapperEl.clientPosition;t=s/window.innerHeight*200-100,n=r/window.innerWidth*200-100}else{const{size:{width:r,height:s,left:a,top:o},clientPosition:{x:l,y:h}}=this.wrapperEl;t=(h-o)/s*200-100,n=(l-a)/r*200-100}this.wrapperEl.clientPosition.xPercentage=Ei(t,-100,100),this.wrapperEl.clientPosition.yPercentage=Ei(n,-100,100)},this.updateFlip=()=>{const{flipVertically:e,flipHorizontally:t}=this.props;e&&(this.tilt.tiltAngleX+=180,this.tilt.tiltAngleY*=-1),t&&(this.tilt.tiltAngleY+=180)},this.renderFrame=()=>{this.resetWrapperElTransform(),this.renderPerspective(),this.tilt.render(this.wrapperEl.node),this.renderScale(),this.glare&&this.glare.render(this.props)}}componentDidMount(){if(this.tilt=new F1,this.initGlare(),this.setSize(),this.addEventListeners(),typeof CustomEvent>"u")return;const e=new CustomEvent("autoreset");this.mainLoop(e);const t=new CustomEvent("initial");this.emitOnMove(t)}componentWillUnmount(){this.wrapperEl.updateAnimationId!==null&&cancelAnimationFrame(this.wrapperEl.updateAnimationId),this.removeEventListeners()}componentDidUpdate(){const e=new CustomEvent("propChange");this.mainLoop(e),this.emitOnMove(e)}addEventListeners(){const{trackOnWindow:e,gyroscope:t}=this.props;window.addEventListener("resize",this.setSize),e&&(window.addEventListener("mouseenter",this.onEnter),window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseout",this.onLeave),window.addEventListener("touchstart",this.onEnter),window.addEventListener("touchmove",this.onMove),window.addEventListener("touchend",this.onLeave)),t&&this.addDeviceOrientationEventListener()}removeEventListeners(){const{trackOnWindow:e,gyroscope:t}=this.props;window.removeEventListener("resize",this.setSize),e&&(window.removeEventListener("mouseenter",this.onEnter),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseout",this.onLeave),window.removeEventListener("touchstart",this.onEnter),window.removeEventListener("touchmove",this.onMove),window.removeEventListener("touchend",this.onLeave)),t&&window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",this.onMove)}setWrapperElSize(){const e=this.wrapperEl.node.getBoundingClientRect();this.wrapperEl.size.width=this.wrapperEl.node.offsetWidth,this.wrapperEl.size.height=this.wrapperEl.node.offsetHeight,this.wrapperEl.size.left=e.left+window.scrollX,this.wrapperEl.size.top=e.top+window.scrollY}initGlare(){const{glareEnable:e,glareBorderRadius:t}=this.props;e&&(this.glare=new U1(this.wrapperEl.size,t),this.wrapperEl.node.appendChild(this.glare.glareWrapperEl))}emitOnMove(e){const{onMove:t}=this.props;if(!t)return;let n=0,r=0;this.glare&&(n=this.glare.glareAngle,r=this.glare.glareOpacity),t({tiltAngleX:this.tilt.tiltAngleX,tiltAngleY:this.tilt.tiltAngleY,tiltAngleXPercentage:this.tilt.tiltAngleXPercentage,tiltAngleYPercentage:this.tilt.tiltAngleYPercentage,glareAngle:n,glareOpacity:r,event:e})}resetWrapperElTransform(){this.wrapperEl.node.style.transform=""}renderPerspective(){const{perspective:e}=this.props;this.wrapperEl.node.style.transform+=`perspective(${e}px) `}renderScale(){const{scale:e}=this.wrapperEl;this.wrapperEl.node.style.transform+=`scale3d(${e},${e},${e})`}setTransitions(){const{transitionSpeed:e,transitionEasing:t}=this.props;tm(this.wrapperEl.node,"all",e,t),this.glare&&tm(this.glare.glareEl,"opacity",e,t)}render(){const{children:e,className:t,style:n}=this.props;return c.jsx("div",{ref:r=>{this.wrapperEl.node=r},onMouseEnter:this.onEnter,onMouseMove:this.onMove,onMouseLeave:this.onLeave,onTouchStart:this.onEnter,onTouchMove:this.onMove,onTouchEnd:this.onLeave,className:t,style:n,children:e})}}Yl.defaultProps=V1;const nm=({background:i="transparent",minSize:e=.4,maxSize:t=1,particleDensity:n=100,className:r,particleColor:s="#FFFFFF"})=>{const[a,o]=G.useState([]),l=G.useRef(null);return G.useEffect(()=>{if(!l.current)return;const h=l.current,{width:d,height:f}=h.getBoundingClientRect(),p=Array.from({length:n},(g,y)=>({id:y,x:Math.random()*d,y:Math.random()*f,size:Math.random()*(t-e)+e,duration:Math.random()*3+2,delay:Math.random()*2}));o(p)},[n,t,e]),c.jsx("div",{ref:l,className:r,style:{background:i,position:"relative",overflow:"hidden"},children:a.map(h=>c.jsx(ct.div,{className:"absolute rounded-full",style:{left:h.x,top:h.y,width:h.size,height:h.size,backgroundColor:s},animate:{opacity:[0,1,0],scale:[0,1,0],y:[0,-20,0]},transition:{duration:h.duration,delay:h.delay,repeat:1/0,ease:"easeInOut"}},h.id))})},Ad=(...i)=>i.filter(Boolean).join(" "),j1=({children:i,className:e})=>{const[t,n]=G.useState(!1),r=G.useRef(null),[s,a]=G.useState(0),[o,l]=G.useState([]);return G.useEffect(()=>{if(r.current){a(r.current?.clientWidth??0);const h=r.current?.clientHeight??0,d=Math.floor(h/10),f=Array.from({length:d},(p,g)=>(g+1)*(h/(d+1)));l(f)}},[]),c.jsxs("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),ref:r,className:"relative hover:bg-neutral-900 group/cover inline-block dark:bg-neutral-900 bg-neutral-100 px-2 py-2 transition duration-200 rounded-sm",style:{transformOrigin:"center",willChange:"transform"},children:[c.jsx(Og,{children:t&&c.jsx(ct.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{opacity:{duration:.4,ease:"easeInOut"}},className:"h-full w-full overflow-hidden absolute inset-0",children:c.jsxs(ct.div,{animate:{translateX:["-50%","0%"]},transition:{translateX:{duration:12,ease:"linear",repeat:1/0}},className:"w-[200%] h-full flex",children:[c.jsx(nm,{background:"transparent",minSize:.4,maxSize:1,particleDensity:500,className:"w-full h-full",particleColor:"#FFFFFF"}),c.jsx(nm,{background:"transparent",minSize:.4,maxSize:1,particleDensity:500,className:"w-full h-full",particleColor:"#FFFFFF"})]})})}),o.map((h,d)=>c.jsx(B1,{hovered:t,duration:2+d%3,delay:1+d%2,width:s,style:{top:`${h}px`}},d)),c.jsx(ct.span,{initial:{scale:1,transformOrigin:"center center",display:"inline-block"},whileHover:{scale:.85,transition:{duration:1.5,ease:"easeOut"}},className:Ad("dark:text-white inline-block text-neutral-900 relative z-20 group-hover/cover:text-white transition duration-200 cursor-pointer",e),children:i}),c.jsx(qo,{className:"absolute -right-[2px] -top-[2px]"}),c.jsx(qo,{className:"absolute -bottom-[2px] -right-[2px]"}),c.jsx(qo,{className:"absolute -left-[2px] -top-[2px]"}),c.jsx(qo,{className:"absolute -bottom-[2px] -left-[2px]"})]})},B1=({className:i,delay:e,duration:t,hovered:n,width:r=600,...s})=>{const a=G.useId();return c.jsxs(ct.svg,{width:r??"600",height:"1",viewBox:`0 0 ${r??"600"} 1`,fill:"none",xmlns:"http://www.w3.org/2000/svg",className:Ad("absolute inset-x-0 w-full",i),...s,children:[c.jsx(ct.path,{d:`M0 0.5H${r??"600"}`,stroke:`url(#svgGradient-${a})`}),c.jsx("defs",{children:c.jsxs(ct.linearGradient,{id:`svgGradient-${a}`,gradientUnits:"userSpaceOnUse",initial:{x1:"0%",x2:n?"-10%":"-5%",y1:0,y2:0},animate:{x1:"110%",x2:n?"100%":"105%",y1:0,y2:0},transition:{duration:n?.8:t??2.5,ease:n?[.25,.46,.45,.94]:"linear",repeat:1/0,delay:n?.5:0,repeatDelay:n?1.5:e??1},children:[c.jsx("stop",{stopColor:"#2EB9DF",stopOpacity:"0"}),c.jsx("stop",{stopColor:"#3b82f6"}),c.jsx("stop",{offset:"1",stopColor:"#3b82f6",stopOpacity:"0"})]},String(n))})]})},qo=({className:i})=>c.jsx("div",{className:Ad("pointer-events-none animate-pulse group-hover/cover:hidden group-hover/cover:opacity-100 group h-2 w-2 rounded-full bg-neutral-600 dark:bg-white opacity-20 group-hover/cover:bg-white",i)}),Jc=[{icon:c.jsx(Vg,{className:"w-5 h-5"}),title:"100K+ Design & Dev Hours Logged",desc:"Building powerful and intuitive digital interfaces across devices."},{icon:c.jsx(jg,{className:"w-5 h-5"}),title:"1000+ Hours Invested in Dev & Design",desc:"Our growing team is actively building innovative and custom digital solutions."},{icon:c.jsx(Bg,{className:"w-5 h-5"}),title:"100% Client Satisfaction",desc:"Every client we've worked with has seen real value  and we're just getting started."}];function z1(){const e=[.13,.5,.87],t=G.useRef(null),n=G.useRef(null),[r,s]=G.useState(!1);return G.useEffect(()=>{const a=new IntersectionObserver(([o])=>{s(o.isIntersecting)},{rootMargin:"-100px",threshold:.1});return n.current&&a.observe(n.current),()=>{n.current&&a.unobserve(n.current)}},[]),c.jsxs("section",{ref:n,id:"about",className:"w-full py-16 flex flex-col items-center justify-center",children:[c.jsx("div",{className:"mb-4",children:c.jsx("span",{className:"px-4 py-1.5 rounded-full bg-black/80 text-white text-sm font-medium shadow border border-white/10",children:"About Us"})}),c.jsx("h2",{className:"text-3xl md:text-5xl font-extrabold text-white text-center mb-2 drop-shadow-lg leading-tight",children:"We don't wait. We fix."}),c.jsxs("div",{className:"text-lg md:text-2xl font-semibold text-white text-center mb-4",children:["at ",c.jsx(j1,{className:"inline-block align-middle",children:"lightning speed."})]}),c.jsxs("div",{className:"text-gray-300 text-center max-w-2xl mx-auto mb-10 text-base md:text-lg",children:["We empower businesses to thrive in the digital age through modern IT solutions ",c.jsx("br",{}),"from custom websites and mobile apps to engaging UI/UX design and optimized product listings."]}),c.jsxs("div",{className:"w-full max-w-5xl mx-auto flex flex-col items-center mt-12 mb-20",children:[c.jsxs("div",{className:"w-full flex md:hidden relative",style:{minHeight:300},children:[c.jsx(ct.div,{className:"absolute left-6 top-0 h-full w-0.5 bg-gradient-to-b from-white/60 to-white/10 z-0",initial:{height:0},animate:r?{height:"100%"}:{height:0},transition:{duration:2.5,ease:[.4,0,.2,1]}}),c.jsx("div",{className:"flex flex-col w-full pl-16",children:Jc.map((a,o)=>c.jsxs("div",{className:"relative flex items-center mb-16 min-h-[120px]",children:[c.jsx(ct.div,{className:"absolute -left-10 top-1/2 -translate-y-1/2 w-6 h-6 rounded-full bg-white border-4 border-black flex items-center justify-center shadow-lg z-10",initial:{opacity:0,scale:.5},animate:r?{opacity:1,scale:1}:{opacity:0,scale:.5},transition:{delay:2.5*e[o],duration:.4,type:"spring",stiffness:300,damping:20}}),c.jsx(ct.div,{className:"absolute left-0 top-1/2 -translate-y-1/2 h-0.5 bg-white/30 z-0",initial:{width:0},animate:r?{width:"2rem"}:{width:0},transition:{delay:2.5*e[o],duration:.4,ease:[.4,0,.2,1]},style:{marginLeft:"calc(1.5rem + 2px)"}}),c.jsx(ct.div,{className:"w-full",initial:{opacity:0,y:32},animate:r?{opacity:1,y:0}:{opacity:0,y:32},transition:{delay:2.5*e[o]+.05,duration:.6,ease:[.4,0,.2,1]},children:c.jsx(Yl,{glareEnable:!0,glareMaxOpacity:.15,scale:1.04,tiltMaxAngleX:12,tiltMaxAngleY:12,transitionSpeed:250,className:"w-full h-full",children:c.jsxs("div",{className:"bg-gradient-to-br from-black/80 to-gray-900/80 rounded-xl border border-white/10 shadow-lg p-6 w-full min-w-[220px] max-w-xs flex flex-col items-start",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2 text-white font-semibold text-base",children:[a.icon,c.jsx("span",{className:"text-xs font-medium",children:a.title})]}),c.jsx("div",{className:"text-gray-300 text-sm font-normal",children:a.desc})]})})})]},o))})]}),c.jsxs("div",{className:"hidden md:block w-full",children:[c.jsxs("div",{className:"relative w-full flex flex-row items-center justify-center",style:{minHeight:80},children:[c.jsx(ct.div,{ref:t,className:"absolute top-1/2 left-0 right-0 h-0.5 w-full bg-gradient-to-r from-white/60 to-white/10",initial:{width:0},animate:r?{width:"100%"}:{width:0},transition:{duration:2.5,ease:[.4,0,.2,1]},style:{right:0}}),c.jsx("div",{className:"flex flex-row w-full justify-between items-center relative z-10",children:Jc.map((a,o)=>c.jsxs(ct.div,{className:"flex flex-col items-center w-1/3 relative",initial:{opacity:0,scale:.5},animate:r?{opacity:1,scale:1}:{opacity:0,scale:.5},transition:{delay:2.5*e[o],duration:.4,type:"spring",stiffness:300,damping:20},style:{minHeight:60},children:[c.jsx("div",{className:"w-6 h-6 rounded-full bg-white border-4 border-black flex items-center justify-center shadow-lg z-10"}),c.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 w-0.5 h-10 bg-white/30 z-0"})]},o))})]}),c.jsx("div",{className:"flex flex-row w-full justify-between items-start gap-6 mt-0",children:Jc.map((a,o)=>c.jsx(ct.div,{className:"w-[320px] flex flex-col items-center",initial:{opacity:0,y:32},animate:r?{opacity:1,y:0}:{opacity:0,y:32},transition:{delay:2.5*e[o]+.05,duration:.6,ease:[.4,0,.2,1]},children:c.jsx(Yl,{glareEnable:!0,glareMaxOpacity:.15,scale:1.04,tiltMaxAngleX:12,tiltMaxAngleY:12,transitionSpeed:250,className:"w-full h-full",children:c.jsxs("div",{className:"bg-gradient-to-br from-black/80 to-gray-900/80 rounded-xl border border-white/10 shadow-lg p-6 w-full h-[180px] flex flex-col items-start",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2 text-white font-semibold text-base",children:[a.icon,c.jsx("span",{className:"text-xs md:text-sm font-medium",children:a.title})]}),c.jsx("div",{className:"text-gray-300 text-sm md:text-base font-normal",children:a.desc})]})})},o))})]})]}),c.jsxs("div",{className:"w-full flex flex-col items-center justify-center mt-24 px-2 sm:px-0",children:[c.jsx("div",{className:"mb-4",children:c.jsx("span",{className:"px-4 py-1.5 rounded-full bg-black/80 text-white text-sm font-medium shadow border border-white/10",children:"Our Values"})}),c.jsx("h2",{className:"text-3xl md:text-5xl font-extrabold text-white text-center mb-4 drop-shadow-lg leading-tight",children:"The Values Behind Xtract"}),c.jsxs("div",{className:"text-gray-300 text-center max-w-2xl mx-auto mb-10 text-base md:text-lg",children:["We bring passion and precision to every solution. From idea to execution,",c.jsx("br",{}),"we partner with clients to build digital products that last."]}),c.jsxs("div",{className:"w-full max-w-5xl mx-auto grid grid-cols-1 sm:grid-cols-2 gap-6 gap-y-8",children:[c.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-gray-900/80 to-gray-800/80 p-4 sm:p-6 border border-white/10 flex flex-col items-start transition-transform duration-200 hover:scale-[1.03] hover:shadow-2xl cursor-pointer",children:[c.jsxs("div",{className:"mb-3 text-white font-bold text-lg sm:text-xl flex items-center gap-2",children:[c.jsx("span",{className:"text-xl sm:text-2xl",children:""}),"Driving Digital Innovation"]}),c.jsx("div",{className:"text-gray-300 text-sm sm:text-base mb-2",children:"We use the latest tech stacks and design tools to deliver modern, scalable, and high-performing solutions."})]}),c.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-gray-900/80 to-gray-800/80 p-4 sm:p-6 border border-white/10 flex flex-col items-start transition-transform duration-200 hover:scale-[1.03] hover:shadow-2xl cursor-pointer",children:[c.jsxs("div",{className:"mb-3 text-white font-bold text-lg sm:text-xl flex items-center gap-2",children:[c.jsx("span",{className:"text-xl sm:text-2xl",children:""}),"Integrity in Everything We Build"]}),c.jsx("div",{className:"text-gray-300 text-sm sm:text-base mb-2",children:"Honesty, transparency, and quality are the foundation of our client relationships."})]}),c.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-gray-900/80 to-gray-800/80 p-4 sm:p-6 border border-white/10 flex flex-col items-start transition-transform duration-200 hover:scale-[1.03] hover:shadow-2xl cursor-pointer",children:[c.jsxs("div",{className:"mb-3 text-white font-bold text-lg sm:text-xl flex items-center gap-2",children:[c.jsx("span",{className:"text-xl sm:text-2xl",children:""}),"Empowering Brands to Grow"]}),c.jsx("div",{className:"text-gray-300 text-sm sm:text-base mb-2",children:"We don't just build  we create long-term digital ecosystems that evolve with your business."})]}),c.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-gray-900/80 to-gray-800/80 p-4 sm:p-6 border border-white/10 flex flex-col items-start transition-transform duration-200 hover:scale-[1.03] hover:shadow-2xl cursor-pointer",children:[c.jsxs("div",{className:"mb-3 text-white font-bold text-lg sm:text-xl flex items-center gap-2",children:[c.jsx("span",{className:"text-xl sm:text-2xl",children:""}),"Clients First, Always"]}),c.jsx("div",{className:"text-gray-300 text-sm sm:text-base mb-2",children:"We listen, adapt, and deliver  prioritizing your goals at every stage of the process."})]})]})]})]})}function im({children:i,className:e="",delay:t=0}){const n=G.useRef(null),r=Rx();return G.useEffect(()=>{const s=n.current;if(!s)return;let a;return typeof window<"u"&&"IntersectionObserver"in window?(a=new IntersectionObserver(([o])=>{o.isIntersecting&&(r.start({opacity:1,y:0,transition:{duration:.7,delay:t}}),a.disconnect())},{threshold:.15}),a.observe(s)):r.start({opacity:1,y:0,transition:{duration:.7,delay:t}}),()=>a&&a.disconnect()},[r,t]),c.jsx(ct.div,{ref:n,initial:{opacity:0,y:32},animate:r,className:e,children:i})}const rm=[{icon:c.jsx(Bg,{size:28,className:"text-blue-400"}),title:"Enhanced Brand Visibility",desc:"Stand out in the digital crowd with tailor-made websites, apps, and listings that reflect your brand identity and capture attention."},{icon:c.jsx(kx,{size:28,className:"text-purple-400"}),title:"Better User Experience",desc:"We design intuitive and engaging interfaces that keep users hooked and coming back  from first click to final conversion."},{icon:c.jsx(jg,{size:28,className:"text-pink-400"}),title:"Round-the-Clock Reachability",desc:"Your online presence never sleeps. Our optimized solutions ensure your brand stays active, accessible, and high-performing 24/7."},{icon:c.jsx(Ux,{size:28,className:"text-green-400"}),title:"Cost-Effective Solutions",desc:"We blend modern tools with efficient workflows to deliver high-quality digital solutions without breaking your budget."},{icon:c.jsx(Fx,{size:28,className:"text-yellow-400"}),title:"Performance-Focused Strategy",desc:"From traffic to engagement to conversion, we build with data in mind to help you grow smarter and scale faster."},{icon:c.jsx(Vg,{size:28,className:"text-indigo-400"}),title:"Scalable Digital Growth",desc:"Whether you're a startup or scaling enterprise, our solutions grow with your business  seamlessly and sustainably."}];function H1(){return c.jsxs("section",{className:"w-full py-16 px-2 sm:px-6 md:px-10 lg:px-20 flex flex-col items-center bg-transparent",children:[c.jsx("div",{className:"mb-4",children:c.jsx("span",{className:"px-4 py-1.5 rounded-full bg-black/80 text-white text-sm font-medium shadow border border-white/10",children:"Benefits"})}),c.jsxs("h2",{className:"text-3xl md:text-5xl font-extrabold text-white text-center mb-4 drop-shadow-lg leading-tight",children:["The Key Benefits of Building",c.jsx("br",{className:"hidden md:block"})," Your Digital Presence with Us"]}),c.jsx("p",{className:"text-gray-300 text-center max-w-2xl mx-auto mb-12 text-base md:text-lg",children:"Discover how our IT services empower your brand online  by boosting visibility, enhancing user engagement, and driving smart digital growth"}),c.jsxs("div",{className:"w-full max-w-6xl",children:[c.jsxs("div",{className:"flex flex-col gap-8 relative md:hidden",children:[c.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-gradient-to-b from-blue-400/30 via-white/10 to-purple-500/30 z-0"}),rm.map((i,e)=>c.jsx(im,{delay:e*.1,children:c.jsxs("div",{className:"relative pl-14",children:[c.jsx("span",{className:"absolute left-2 top-6 w-5 h-5 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 border-4 border-black z-10 shadow-lg animate-pulse"}),c.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition p-6 flex flex-col gap-3 shadow-lg backdrop-blur-md",children:[c.jsx("div",{children:i.icon}),c.jsx("div",{className:"text-lg font-semibold text-white",children:i.title}),c.jsx("div",{className:"text-gray-300 text-sm",children:i.desc})]})]})},e))]}),c.jsx("div",{className:"hidden md:grid grid-cols-2 lg:grid-cols-3 gap-6",children:rm.map((i,e)=>c.jsx(im,{delay:e*.1,children:c.jsx(Yl,{glareEnable:!0,glareMaxOpacity:.15,scale:1.04,tiltMaxAngleX:12,tiltMaxAngleY:12,transitionSpeed:250,className:"w-full h-full",children:c.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition p-6 flex flex-col gap-3 shadow-lg backdrop-blur-md",children:[c.jsx("div",{children:i.icon}),c.jsx("div",{className:"text-lg font-semibold text-white",children:i.title}),c.jsx("div",{className:"text-gray-300 text-sm",children:i.desc})]})})},e))})]})]})}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Md="162",ys={ROTATE:0,DOLLY:1,PAN:2},bs={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G1=0,sm=1,W1=2,Rd=1,q1=2,bi=3,gr=0,En=1,wi=2,ar=0,Ks=1,am=2,om=3,lm=4,X1=5,kr=100,$1=101,Y1=102,cm=103,um=104,K1=200,J1=201,Q1=202,Z1=203,fh=204,ph=205,eR=206,tR=207,nR=208,iR=209,rR=210,sR=211,aR=212,oR=213,lR=214,cR=0,uR=1,hR=2,Kl=3,dR=4,fR=5,pR=6,mR=7,Pv=0,gR=1,_R=2,or=0,vR=1,xR=2,yR=3,bR=4,ER=5,wR=6,SR=7,Nv=300,oa=301,la=302,mh=303,gh=304,Sc=306,_h=1e3,Wn=1001,vh=1002,gn=1003,hm=1004,La=1005,yn=1006,Qc=1007,jr=1008,lr=1009,TR=1010,AR=1011,Cd=1012,Lv=1013,Qi=1014,Si=1015,uo=1016,Dv=1017,Ov=1018,Gr=1020,MR=1021,qn=1023,RR=1024,CR=1025,Wr=1026,ca=1027,IR=1028,kv=1029,PR=1030,Uv=1031,Fv=1033,Zc=33776,eu=33777,tu=33778,nu=33779,dm=35840,fm=35841,pm=35842,mm=35843,Vv=36196,gm=37492,_m=37496,vm=37808,xm=37809,ym=37810,bm=37811,Em=37812,wm=37813,Sm=37814,Tm=37815,Am=37816,Mm=37817,Rm=37818,Cm=37819,Im=37820,Pm=37821,iu=36492,Nm=36494,Lm=36495,NR=36283,Dm=36284,Om=36285,km=36286,LR=3200,DR=3201,OR=0,kR=1,Yi="",Gn="srgb",Er="srgb-linear",Id="display-p3",Tc="display-p3-linear",Jl="linear",It="srgb",Ql="rec709",Zl="p3",Es=7680,Um=519,UR=512,FR=513,VR=514,jv=515,jR=516,BR=517,zR=518,HR=519,Fm=35044,Vm="300 es",xh=1035,Mi=2e3,ec=2001;class os{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const un=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Al=Math.PI/180,yh=180/Math.PI;function Ao(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(un[i&255]+un[i>>8&255]+un[i>>16&255]+un[i>>24&255]+"-"+un[e&255]+un[e>>8&255]+"-"+un[e>>16&15|64]+un[e>>24&255]+"-"+un[t&63|128]+un[t>>8&255]+"-"+un[t>>16&255]+un[t>>24&255]+un[n&255]+un[n>>8&255]+un[n>>16&255]+un[n>>24&255]).toLowerCase()}function _n(i,e,t){return Math.max(e,Math.min(t,i))}function GR(i,e){return(i%e+e)%e}function ru(i,e,t){return(1-t)*i+t*e}function jm(i){return(i&i-1)===0&&i!==0}function bh(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Da(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function vn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const WR={DEG2RAD:Al};class st{constructor(e=0,t=0){st.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(_n(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ot{constructor(e,t,n,r,s,a,o,l,h){ot.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,h)}set(e,t,n,r,s,a,o,l,h){const d=this.elements;return d[0]=e,d[1]=r,d[2]=o,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=a,d[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[3],l=n[6],h=n[1],d=n[4],f=n[7],p=n[2],g=n[5],y=n[8],T=r[0],m=r[3],v=r[6],M=r[1],S=r[4],L=r[7],V=r[2],k=r[5],w=r[8];return s[0]=a*T+o*M+l*V,s[3]=a*m+o*S+l*k,s[6]=a*v+o*L+l*w,s[1]=h*T+d*M+f*V,s[4]=h*m+d*S+f*k,s[7]=h*v+d*L+f*w,s[2]=p*T+g*M+y*V,s[5]=p*m+g*S+y*k,s[8]=p*v+g*L+y*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],d=e[8];return t*a*d-t*o*h-n*s*d+n*o*l+r*s*h-r*a*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],d=e[8],f=d*a-o*h,p=o*l-d*s,g=h*s-a*l,y=t*f+n*p+r*g;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/y;return e[0]=f*T,e[1]=(r*h-d*n)*T,e[2]=(o*n-r*a)*T,e[3]=p*T,e[4]=(d*t-r*l)*T,e[5]=(r*s-o*t)*T,e[6]=g*T,e[7]=(n*l-h*t)*T,e[8]=(a*t-n*s)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,o){const l=Math.cos(s),h=Math.sin(s);return this.set(n*l,n*h,-n*(l*a+h*o)+a+e,-r*h,r*l,-r*(-h*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(su.makeScale(e,t)),this}rotate(e){return this.premultiply(su.makeRotation(-e)),this}translate(e,t){return this.premultiply(su.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const su=new ot;function Bv(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function tc(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function qR(){const i=tc("canvas");return i.style.display="block",i}const Bm={};function XR(i){i in Bm||(Bm[i]=!0,console.warn(i))}const zm=new ot().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Hm=new ot().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Xo={[Er]:{transfer:Jl,primaries:Ql,toReference:i=>i,fromReference:i=>i},[Gn]:{transfer:It,primaries:Ql,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[Tc]:{transfer:Jl,primaries:Zl,toReference:i=>i.applyMatrix3(Hm),fromReference:i=>i.applyMatrix3(zm)},[Id]:{transfer:It,primaries:Zl,toReference:i=>i.convertSRGBToLinear().applyMatrix3(Hm),fromReference:i=>i.applyMatrix3(zm).convertLinearToSRGB()}},$R=new Set([Er,Tc]),St={enabled:!0,_workingColorSpace:Er,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!$R.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;const n=Xo[e].toReference,r=Xo[t].fromReference;return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return Xo[i].primaries},getTransfer:function(i){return i===Yi?Jl:Xo[i].transfer}};function Js(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function au(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let ws;class zv{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ws===void 0&&(ws=tc("canvas")),ws.width=e.width,ws.height=e.height;const n=ws.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ws}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=tc("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=Js(s[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Js(t[n]/255)*255):t[n]=Js(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let YR=0;class Hv{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:YR++}),this.uuid=Ao(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(ou(r[a].image)):s.push(ou(r[a]))}else s=ou(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function ou(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?zv.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let KR=0;class wn extends os{constructor(e=wn.DEFAULT_IMAGE,t=wn.DEFAULT_MAPPING,n=Wn,r=Wn,s=yn,a=jr,o=qn,l=lr,h=wn.DEFAULT_ANISOTROPY,d=Yi){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:KR++}),this.uuid=Ao(),this.name="",this.source=new Hv(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=h,this.format=o,this.internalFormat=null,this.type=l,this.offset=new st(0,0),this.repeat=new st(1,1),this.center=new st(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ot,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Nv)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case _h:e.x=e.x-Math.floor(e.x);break;case Wn:e.x=e.x<0?0:1;break;case vh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case _h:e.y=e.y-Math.floor(e.y);break;case Wn:e.y=e.y<0?0:1;break;case vh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}wn.DEFAULT_IMAGE=null;wn.DEFAULT_MAPPING=Nv;wn.DEFAULT_ANISOTROPY=1;class rn{constructor(e=0,t=0,n=0,r=1){rn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,h=l[0],d=l[4],f=l[8],p=l[1],g=l[5],y=l[9],T=l[2],m=l[6],v=l[10];if(Math.abs(d-p)<.01&&Math.abs(f-T)<.01&&Math.abs(y-m)<.01){if(Math.abs(d+p)<.1&&Math.abs(f+T)<.1&&Math.abs(y+m)<.1&&Math.abs(h+g+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(h+1)/2,L=(g+1)/2,V=(v+1)/2,k=(d+p)/4,w=(f+T)/4,A=(y+m)/4;return S>L&&S>V?S<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(S),r=k/n,s=w/n):L>V?L<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(L),n=k/r,s=A/r):V<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(V),n=w/s,r=A/s),this.set(n,r,s,t),this}let M=Math.sqrt((m-y)*(m-y)+(f-T)*(f-T)+(p-d)*(p-d));return Math.abs(M)<.001&&(M=1),this.x=(m-y)/M,this.y=(f-T)/M,this.z=(p-d)/M,this.w=Math.acos((h+g+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class JR extends os{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new rn(0,0,e,t),this.scissorTest=!1,this.viewport=new rn(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:yn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},n);const s=new wn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];const a=n.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Hv(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class es extends JR{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Gv extends wn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=Wn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class QR extends wn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=Wn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ts{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,a,o){let l=n[r+0],h=n[r+1],d=n[r+2],f=n[r+3];const p=s[a+0],g=s[a+1],y=s[a+2],T=s[a+3];if(o===0){e[t+0]=l,e[t+1]=h,e[t+2]=d,e[t+3]=f;return}if(o===1){e[t+0]=p,e[t+1]=g,e[t+2]=y,e[t+3]=T;return}if(f!==T||l!==p||h!==g||d!==y){let m=1-o;const v=l*p+h*g+d*y+f*T,M=v>=0?1:-1,S=1-v*v;if(S>Number.EPSILON){const V=Math.sqrt(S),k=Math.atan2(V,v*M);m=Math.sin(m*k)/V,o=Math.sin(o*k)/V}const L=o*M;if(l=l*m+p*L,h=h*m+g*L,d=d*m+y*L,f=f*m+T*L,m===1-o){const V=1/Math.sqrt(l*l+h*h+d*d+f*f);l*=V,h*=V,d*=V,f*=V}}e[t]=l,e[t+1]=h,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,s,a){const o=n[r],l=n[r+1],h=n[r+2],d=n[r+3],f=s[a],p=s[a+1],g=s[a+2],y=s[a+3];return e[t]=o*y+d*f+l*g-h*p,e[t+1]=l*y+d*p+h*f-o*g,e[t+2]=h*y+d*g+o*p-l*f,e[t+3]=d*y-o*f-l*p-h*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,h=o(n/2),d=o(r/2),f=o(s/2),p=l(n/2),g=l(r/2),y=l(s/2);switch(a){case"XYZ":this._x=p*d*f+h*g*y,this._y=h*g*f-p*d*y,this._z=h*d*y+p*g*f,this._w=h*d*f-p*g*y;break;case"YXZ":this._x=p*d*f+h*g*y,this._y=h*g*f-p*d*y,this._z=h*d*y-p*g*f,this._w=h*d*f+p*g*y;break;case"ZXY":this._x=p*d*f-h*g*y,this._y=h*g*f+p*d*y,this._z=h*d*y+p*g*f,this._w=h*d*f-p*g*y;break;case"ZYX":this._x=p*d*f-h*g*y,this._y=h*g*f+p*d*y,this._z=h*d*y-p*g*f,this._w=h*d*f+p*g*y;break;case"YZX":this._x=p*d*f+h*g*y,this._y=h*g*f+p*d*y,this._z=h*d*y-p*g*f,this._w=h*d*f-p*g*y;break;case"XZY":this._x=p*d*f-h*g*y,this._y=h*g*f-p*d*y,this._z=h*d*y+p*g*f,this._w=h*d*f+p*g*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],o=t[5],l=t[9],h=t[2],d=t[6],f=t[10],p=n+o+f;if(p>0){const g=.5/Math.sqrt(p+1);this._w=.25/g,this._x=(d-l)*g,this._y=(s-h)*g,this._z=(a-r)*g}else if(n>o&&n>f){const g=2*Math.sqrt(1+n-o-f);this._w=(d-l)/g,this._x=.25*g,this._y=(r+a)/g,this._z=(s+h)/g}else if(o>f){const g=2*Math.sqrt(1+o-n-f);this._w=(s-h)/g,this._x=(r+a)/g,this._y=.25*g,this._z=(l+d)/g}else{const g=2*Math.sqrt(1+f-n-o);this._w=(a-r)/g,this._x=(s+h)/g,this._y=(l+d)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(_n(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,o=t._x,l=t._y,h=t._z,d=t._w;return this._x=n*d+a*o+r*h-s*l,this._y=r*d+a*l+s*o-n*h,this._z=s*d+a*h+n*l-r*o,this._w=a*d-n*o-r*l-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+n*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const g=1-t;return this._w=g*a+t*this._w,this._x=g*n+t*this._x,this._y=g*r+t*this._y,this._z=g*s+t*this._z,this.normalize(),this}const h=Math.sqrt(l),d=Math.atan2(h,o),f=Math.sin((1-t)*d)/h,p=Math.sin(t*d)/h;return this._w=a*f+this._w*p,this._x=n*f+this._x*p,this._y=r*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class q{constructor(e=0,t=0,n=0){q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Gm.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Gm.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,o=e.z,l=e.w,h=2*(a*r-o*n),d=2*(o*t-s*r),f=2*(s*n-a*t);return this.x=t+l*h+a*f-o*d,this.y=n+l*d+o*h-s*f,this.z=r+l*f+s*d-a*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=r*l-s*o,this.y=s*a-n*l,this.z=n*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return lu.copy(this).projectOnVector(e),this.sub(lu)}reflect(e){return this.sub(lu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(_n(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const lu=new q,Gm=new ts;class ya{constructor(e=new q(1/0,1/0,1/0),t=new q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Bn.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Bn.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Bn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Bn):Bn.fromBufferAttribute(s,a),Bn.applyMatrix4(e.matrixWorld),this.expandByPoint(Bn);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),$o.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),$o.copy(n.boundingBox)),$o.applyMatrix4(e.matrixWorld),this.union($o)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Bn),Bn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Oa),Yo.subVectors(this.max,Oa),Ss.subVectors(e.a,Oa),Ts.subVectors(e.b,Oa),As.subVectors(e.c,Oa),Vi.subVectors(Ts,Ss),ji.subVectors(As,Ts),Rr.subVectors(Ss,As);let t=[0,-Vi.z,Vi.y,0,-ji.z,ji.y,0,-Rr.z,Rr.y,Vi.z,0,-Vi.x,ji.z,0,-ji.x,Rr.z,0,-Rr.x,-Vi.y,Vi.x,0,-ji.y,ji.x,0,-Rr.y,Rr.x,0];return!cu(t,Ss,Ts,As,Yo)||(t=[1,0,0,0,1,0,0,0,1],!cu(t,Ss,Ts,As,Yo))?!1:(Ko.crossVectors(Vi,ji),t=[Ko.x,Ko.y,Ko.z],cu(t,Ss,Ts,As,Yo))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Bn).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Bn).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(gi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gi=[new q,new q,new q,new q,new q,new q,new q,new q],Bn=new q,$o=new ya,Ss=new q,Ts=new q,As=new q,Vi=new q,ji=new q,Rr=new q,Oa=new q,Yo=new q,Ko=new q,Cr=new q;function cu(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){Cr.fromArray(i,s);const o=r.x*Math.abs(Cr.x)+r.y*Math.abs(Cr.y)+r.z*Math.abs(Cr.z),l=e.dot(Cr),h=t.dot(Cr),d=n.dot(Cr);if(Math.max(-Math.max(l,h,d),Math.min(l,h,d))>o)return!1}return!0}const ZR=new ya,ka=new q,uu=new q;class Pd{constructor(e=new q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):ZR.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ka.subVectors(e,this.center);const t=ka.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(ka,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(uu.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ka.copy(e.center).add(uu)),this.expandByPoint(ka.copy(e.center).sub(uu))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _i=new q,hu=new q,Jo=new q,Bi=new q,du=new q,Qo=new q,fu=new q;class Wv{constructor(e=new q,t=new q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_i)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=_i.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(_i.copy(this.origin).addScaledVector(this.direction,t),_i.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){hu.copy(e).add(t).multiplyScalar(.5),Jo.copy(t).sub(e).normalize(),Bi.copy(this.origin).sub(hu);const s=e.distanceTo(t)*.5,a=-this.direction.dot(Jo),o=Bi.dot(this.direction),l=-Bi.dot(Jo),h=Bi.lengthSq(),d=Math.abs(1-a*a);let f,p,g,y;if(d>0)if(f=a*l-o,p=a*o-l,y=s*d,f>=0)if(p>=-y)if(p<=y){const T=1/d;f*=T,p*=T,g=f*(f+a*p+2*o)+p*(a*f+p+2*l)+h}else p=s,f=Math.max(0,-(a*p+o)),g=-f*f+p*(p+2*l)+h;else p=-s,f=Math.max(0,-(a*p+o)),g=-f*f+p*(p+2*l)+h;else p<=-y?(f=Math.max(0,-(-a*s+o)),p=f>0?-s:Math.min(Math.max(-s,-l),s),g=-f*f+p*(p+2*l)+h):p<=y?(f=0,p=Math.min(Math.max(-s,-l),s),g=p*(p+2*l)+h):(f=Math.max(0,-(a*s+o)),p=f>0?s:Math.min(Math.max(-s,-l),s),g=-f*f+p*(p+2*l)+h);else p=a>0?-s:s,f=Math.max(0,-(a*p+o)),g=-f*f+p*(p+2*l)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(hu).addScaledVector(Jo,p),g}intersectSphere(e,t){_i.subVectors(e.center,this.origin);const n=_i.dot(this.direction),r=_i.dot(_i)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,o,l;const h=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return h>=0?(n=(e.min.x-p.x)*h,r=(e.max.x-p.x)*h):(n=(e.max.x-p.x)*h,r=(e.min.x-p.x)*h),d>=0?(s=(e.min.y-p.y)*d,a=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,a=(e.min.y-p.y)*d),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),f>=0?(o=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(o=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),n>l||o>r)||((o>n||n!==n)&&(n=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,_i)!==null}intersectTriangle(e,t,n,r,s){du.subVectors(t,e),Qo.subVectors(n,e),fu.crossVectors(du,Qo);let a=this.direction.dot(fu),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Bi.subVectors(this.origin,e);const l=o*this.direction.dot(Qo.crossVectors(Bi,Qo));if(l<0)return null;const h=o*this.direction.dot(du.cross(Bi));if(h<0||l+h>a)return null;const d=-o*Bi.dot(fu);return d<0?null:this.at(d/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class $t{constructor(e,t,n,r,s,a,o,l,h,d,f,p,g,y,T,m){$t.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,h,d,f,p,g,y,T,m)}set(e,t,n,r,s,a,o,l,h,d,f,p,g,y,T,m){const v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=h,v[6]=d,v[10]=f,v[14]=p,v[3]=g,v[7]=y,v[11]=T,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new $t().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Ms.setFromMatrixColumn(e,0).length(),s=1/Ms.setFromMatrixColumn(e,1).length(),a=1/Ms.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(r),h=Math.sin(r),d=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=a*d,g=a*f,y=o*d,T=o*f;t[0]=l*d,t[4]=-l*f,t[8]=h,t[1]=g+y*h,t[5]=p-T*h,t[9]=-o*l,t[2]=T-p*h,t[6]=y+g*h,t[10]=a*l}else if(e.order==="YXZ"){const p=l*d,g=l*f,y=h*d,T=h*f;t[0]=p+T*o,t[4]=y*o-g,t[8]=a*h,t[1]=a*f,t[5]=a*d,t[9]=-o,t[2]=g*o-y,t[6]=T+p*o,t[10]=a*l}else if(e.order==="ZXY"){const p=l*d,g=l*f,y=h*d,T=h*f;t[0]=p-T*o,t[4]=-a*f,t[8]=y+g*o,t[1]=g+y*o,t[5]=a*d,t[9]=T-p*o,t[2]=-a*h,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const p=a*d,g=a*f,y=o*d,T=o*f;t[0]=l*d,t[4]=y*h-g,t[8]=p*h+T,t[1]=l*f,t[5]=T*h+p,t[9]=g*h-y,t[2]=-h,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const p=a*l,g=a*h,y=o*l,T=o*h;t[0]=l*d,t[4]=T-p*f,t[8]=y*f+g,t[1]=f,t[5]=a*d,t[9]=-o*d,t[2]=-h*d,t[6]=g*f+y,t[10]=p-T*f}else if(e.order==="XZY"){const p=a*l,g=a*h,y=o*l,T=o*h;t[0]=l*d,t[4]=-f,t[8]=h*d,t[1]=p*f+T,t[5]=a*d,t[9]=g*f-y,t[2]=y*f-g,t[6]=o*d,t[10]=T*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(e2,e,t2)}lookAt(e,t,n){const r=this.elements;return Mn.subVectors(e,t),Mn.lengthSq()===0&&(Mn.z=1),Mn.normalize(),zi.crossVectors(n,Mn),zi.lengthSq()===0&&(Math.abs(n.z)===1?Mn.x+=1e-4:Mn.z+=1e-4,Mn.normalize(),zi.crossVectors(n,Mn)),zi.normalize(),Zo.crossVectors(Mn,zi),r[0]=zi.x,r[4]=Zo.x,r[8]=Mn.x,r[1]=zi.y,r[5]=Zo.y,r[9]=Mn.y,r[2]=zi.z,r[6]=Zo.z,r[10]=Mn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[4],l=n[8],h=n[12],d=n[1],f=n[5],p=n[9],g=n[13],y=n[2],T=n[6],m=n[10],v=n[14],M=n[3],S=n[7],L=n[11],V=n[15],k=r[0],w=r[4],A=r[8],C=r[12],x=r[1],E=r[5],O=r[9],I=r[13],j=r[2],te=r[6],Z=r[10],ne=r[14],ee=r[3],ie=r[7],pe=r[11],ge=r[15];return s[0]=a*k+o*x+l*j+h*ee,s[4]=a*w+o*E+l*te+h*ie,s[8]=a*A+o*O+l*Z+h*pe,s[12]=a*C+o*I+l*ne+h*ge,s[1]=d*k+f*x+p*j+g*ee,s[5]=d*w+f*E+p*te+g*ie,s[9]=d*A+f*O+p*Z+g*pe,s[13]=d*C+f*I+p*ne+g*ge,s[2]=y*k+T*x+m*j+v*ee,s[6]=y*w+T*E+m*te+v*ie,s[10]=y*A+T*O+m*Z+v*pe,s[14]=y*C+T*I+m*ne+v*ge,s[3]=M*k+S*x+L*j+V*ee,s[7]=M*w+S*E+L*te+V*ie,s[11]=M*A+S*O+L*Z+V*pe,s[15]=M*C+S*I+L*ne+V*ge,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],o=e[5],l=e[9],h=e[13],d=e[2],f=e[6],p=e[10],g=e[14],y=e[3],T=e[7],m=e[11],v=e[15];return y*(+s*l*f-r*h*f-s*o*p+n*h*p+r*o*g-n*l*g)+T*(+t*l*g-t*h*p+s*a*p-r*a*g+r*h*d-s*l*d)+m*(+t*h*f-t*o*g-s*a*f+n*a*g+s*o*d-n*h*d)+v*(-r*o*d-t*l*f+t*o*p+r*a*f-n*a*p+n*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],d=e[8],f=e[9],p=e[10],g=e[11],y=e[12],T=e[13],m=e[14],v=e[15],M=f*m*h-T*p*h+T*l*g-o*m*g-f*l*v+o*p*v,S=y*p*h-d*m*h-y*l*g+a*m*g+d*l*v-a*p*v,L=d*T*h-y*f*h+y*o*g-a*T*g-d*o*v+a*f*v,V=y*f*l-d*T*l-y*o*p+a*T*p+d*o*m-a*f*m,k=t*M+n*S+r*L+s*V;if(k===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/k;return e[0]=M*w,e[1]=(T*p*s-f*m*s-T*r*g+n*m*g+f*r*v-n*p*v)*w,e[2]=(o*m*s-T*l*s+T*r*h-n*m*h-o*r*v+n*l*v)*w,e[3]=(f*l*s-o*p*s-f*r*h+n*p*h+o*r*g-n*l*g)*w,e[4]=S*w,e[5]=(d*m*s-y*p*s+y*r*g-t*m*g-d*r*v+t*p*v)*w,e[6]=(y*l*s-a*m*s-y*r*h+t*m*h+a*r*v-t*l*v)*w,e[7]=(a*p*s-d*l*s+d*r*h-t*p*h-a*r*g+t*l*g)*w,e[8]=L*w,e[9]=(y*f*s-d*T*s-y*n*g+t*T*g+d*n*v-t*f*v)*w,e[10]=(a*T*s-y*o*s+y*n*h-t*T*h-a*n*v+t*o*v)*w,e[11]=(d*o*s-a*f*s-d*n*h+t*f*h+a*n*g-t*o*g)*w,e[12]=V*w,e[13]=(d*T*r-y*f*r+y*n*p-t*T*p-d*n*m+t*f*m)*w,e[14]=(y*o*r-a*T*r-y*n*l+t*T*l+a*n*m-t*o*m)*w,e[15]=(a*f*r-d*o*r+d*n*l-t*f*l-a*n*p+t*o*p)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,o=e.y,l=e.z,h=s*a,d=s*o;return this.set(h*a+n,h*o-r*l,h*l+r*o,0,h*o+r*l,d*o+n,d*l-r*a,0,h*l-r*o,d*l+r*a,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,h=s+s,d=a+a,f=o+o,p=s*h,g=s*d,y=s*f,T=a*d,m=a*f,v=o*f,M=l*h,S=l*d,L=l*f,V=n.x,k=n.y,w=n.z;return r[0]=(1-(T+v))*V,r[1]=(g+L)*V,r[2]=(y-S)*V,r[3]=0,r[4]=(g-L)*k,r[5]=(1-(p+v))*k,r[6]=(m+M)*k,r[7]=0,r[8]=(y+S)*w,r[9]=(m-M)*w,r[10]=(1-(p+T))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Ms.set(r[0],r[1],r[2]).length();const a=Ms.set(r[4],r[5],r[6]).length(),o=Ms.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],zn.copy(this);const h=1/s,d=1/a,f=1/o;return zn.elements[0]*=h,zn.elements[1]*=h,zn.elements[2]*=h,zn.elements[4]*=d,zn.elements[5]*=d,zn.elements[6]*=d,zn.elements[8]*=f,zn.elements[9]*=f,zn.elements[10]*=f,t.setFromRotationMatrix(zn),n.x=s,n.y=a,n.z=o,this}makePerspective(e,t,n,r,s,a,o=Mi){const l=this.elements,h=2*s/(t-e),d=2*s/(n-r),f=(t+e)/(t-e),p=(n+r)/(n-r);let g,y;if(o===Mi)g=-(a+s)/(a-s),y=-2*a*s/(a-s);else if(o===ec)g=-a/(a-s),y=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=h,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,a,o=Mi){const l=this.elements,h=1/(t-e),d=1/(n-r),f=1/(a-s),p=(t+e)*h,g=(n+r)*d;let y,T;if(o===Mi)y=(a+s)*f,T=-2*f;else if(o===ec)y=s*f,T=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-g,l[2]=0,l[6]=0,l[10]=T,l[14]=-y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Ms=new q,zn=new $t,e2=new q(0,0,0),t2=new q(1,1,1),zi=new q,Zo=new q,Mn=new q,Wm=new $t,qm=new ts;class di{constructor(e=0,t=0,n=0,r=di.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],l=r[1],h=r[5],d=r[9],f=r[2],p=r[6],g=r[10];switch(t){case"XYZ":this._y=Math.asin(_n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-d,g),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(p,h),this._z=0);break;case"YXZ":this._x=Math.asin(-_n(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(o,g),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(_n(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-_n(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,g),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(_n(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,h),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(o,g));break;case"XZY":this._z=Math.asin(-_n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,h),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-d,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Wm.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Wm,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return qm.setFromEuler(this),this.setFromQuaternion(qm,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}di.DEFAULT_ORDER="XYZ";class qv{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let n2=0;const Xm=new q,Rs=new ts,vi=new $t,el=new q,Ua=new q,i2=new q,r2=new ts,$m=new q(1,0,0),Ym=new q(0,1,0),Km=new q(0,0,1),s2={type:"added"},a2={type:"removed"},pu={type:"childadded",child:null},mu={type:"childremoved",child:null};class Nn extends os{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:n2++}),this.uuid=Ao(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Nn.DEFAULT_UP.clone();const e=new q,t=new di,n=new ts,r=new q(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new $t},normalMatrix:{value:new ot}}),this.matrix=new $t,this.matrixWorld=new $t,this.matrixAutoUpdate=Nn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Nn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new qv,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Rs.setFromAxisAngle(e,t),this.quaternion.multiply(Rs),this}rotateOnWorldAxis(e,t){return Rs.setFromAxisAngle(e,t),this.quaternion.premultiply(Rs),this}rotateX(e){return this.rotateOnAxis($m,e)}rotateY(e){return this.rotateOnAxis(Ym,e)}rotateZ(e){return this.rotateOnAxis(Km,e)}translateOnAxis(e,t){return Xm.copy(e).applyQuaternion(this.quaternion),this.position.add(Xm.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis($m,e)}translateY(e){return this.translateOnAxis(Ym,e)}translateZ(e){return this.translateOnAxis(Km,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(vi.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?el.copy(e):el.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ua.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?vi.lookAt(Ua,el,this.up):vi.lookAt(el,Ua,this.up),this.quaternion.setFromRotationMatrix(vi),r&&(vi.extractRotation(r.matrixWorld),Rs.setFromRotationMatrix(vi),this.quaternion.premultiply(Rs.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(s2),pu.child=e,this.dispatchEvent(pu),pu.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(a2),mu.child=e,this.dispatchEvent(mu),mu.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),vi.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),vi.multiply(e.parent.matrixWorld)),e.applyMatrix4(vi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ua,e,i2),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ua,r2,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const s=t[n];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++){const o=r[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(o=>({boxInitialized:o.boxInitialized,boxMin:o.box.min.toArray(),boxMax:o.box.max.toArray(),sphereInitialized:o.sphereInitialized,sphereRadius:o.sphere.radius,sphereCenter:o.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let h=0,d=l.length;h<d;h++){const f=l[h];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,h=this.material.length;l<h;l++)o.push(s(e.materials,this.material[l]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),h=a(e.textures),d=a(e.images),f=a(e.shapes),p=a(e.skeletons),g=a(e.animations),y=a(e.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),d.length>0&&(n.images=d),f.length>0&&(n.shapes=f),p.length>0&&(n.skeletons=p),g.length>0&&(n.animations=g),y.length>0&&(n.nodes=y)}return n.object=r,n;function a(o){const l=[];for(const h in o){const d=o[h];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Nn.DEFAULT_UP=new q(0,1,0);Nn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Nn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Hn=new q,xi=new q,gu=new q,yi=new q,Cs=new q,Is=new q,Jm=new q,_u=new q,vu=new q,xu=new q;class ei{constructor(e=new q,t=new q,n=new q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Hn.subVectors(e,t),r.cross(Hn);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Hn.subVectors(r,t),xi.subVectors(n,t),gu.subVectors(e,t);const a=Hn.dot(Hn),o=Hn.dot(xi),l=Hn.dot(gu),h=xi.dot(xi),d=xi.dot(gu),f=a*h-o*o;if(f===0)return s.set(0,0,0),null;const p=1/f,g=(h*l-o*d)*p,y=(a*d-o*l)*p;return s.set(1-g-y,y,g)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,yi)===null?!1:yi.x>=0&&yi.y>=0&&yi.x+yi.y<=1}static getInterpolation(e,t,n,r,s,a,o,l){return this.getBarycoord(e,t,n,r,yi)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,yi.x),l.addScaledVector(a,yi.y),l.addScaledVector(o,yi.z),l)}static isFrontFacing(e,t,n,r){return Hn.subVectors(n,t),xi.subVectors(e,t),Hn.cross(xi).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Hn.subVectors(this.c,this.b),xi.subVectors(this.a,this.b),Hn.cross(xi).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ei.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ei.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return ei.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return ei.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ei.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,o;Cs.subVectors(r,n),Is.subVectors(s,n),_u.subVectors(e,n);const l=Cs.dot(_u),h=Is.dot(_u);if(l<=0&&h<=0)return t.copy(n);vu.subVectors(e,r);const d=Cs.dot(vu),f=Is.dot(vu);if(d>=0&&f<=d)return t.copy(r);const p=l*f-d*h;if(p<=0&&l>=0&&d<=0)return a=l/(l-d),t.copy(n).addScaledVector(Cs,a);xu.subVectors(e,s);const g=Cs.dot(xu),y=Is.dot(xu);if(y>=0&&g<=y)return t.copy(s);const T=g*h-l*y;if(T<=0&&h>=0&&y<=0)return o=h/(h-y),t.copy(n).addScaledVector(Is,o);const m=d*y-g*f;if(m<=0&&f-d>=0&&g-y>=0)return Jm.subVectors(s,r),o=(f-d)/(f-d+(g-y)),t.copy(r).addScaledVector(Jm,o);const v=1/(m+T+p);return a=T*v,o=p*v,t.copy(n).addScaledVector(Cs,a).addScaledVector(Is,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Xv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Hi={h:0,s:0,l:0},tl={h:0,s:0,l:0};function yu(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class bt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Gn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,St.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=St.workingColorSpace){return this.r=e,this.g=t,this.b=n,St.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=St.workingColorSpace){if(e=GR(e,1),t=_n(t,0,1),n=_n(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=yu(a,s,e+1/3),this.g=yu(a,s,e),this.b=yu(a,s,e-1/3)}return St.toWorkingColorSpace(this,r),this}setStyle(e,t=Gn){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Gn){const n=Xv[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Js(e.r),this.g=Js(e.g),this.b=Js(e.b),this}copyLinearToSRGB(e){return this.r=au(e.r),this.g=au(e.g),this.b=au(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Gn){return St.fromWorkingColorSpace(hn.copy(this),e),Math.round(_n(hn.r*255,0,255))*65536+Math.round(_n(hn.g*255,0,255))*256+Math.round(_n(hn.b*255,0,255))}getHexString(e=Gn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=St.workingColorSpace){St.fromWorkingColorSpace(hn.copy(this),t);const n=hn.r,r=hn.g,s=hn.b,a=Math.max(n,r,s),o=Math.min(n,r,s);let l,h;const d=(o+a)/2;if(o===a)l=0,h=0;else{const f=a-o;switch(h=d<=.5?f/(a+o):f/(2-a-o),a){case n:l=(r-s)/f+(r<s?6:0);break;case r:l=(s-n)/f+2;break;case s:l=(n-r)/f+4;break}l/=6}return e.h=l,e.s=h,e.l=d,e}getRGB(e,t=St.workingColorSpace){return St.fromWorkingColorSpace(hn.copy(this),t),e.r=hn.r,e.g=hn.g,e.b=hn.b,e}getStyle(e=Gn){St.fromWorkingColorSpace(hn.copy(this),e);const t=hn.r,n=hn.g,r=hn.b;return e!==Gn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Hi),this.setHSL(Hi.h+e,Hi.s+t,Hi.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Hi),e.getHSL(tl);const n=ru(Hi.h,tl.h,t),r=ru(Hi.s,tl.s,t),s=ru(Hi.l,tl.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const hn=new bt;bt.NAMES=Xv;let o2=0;class Ac extends os{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:o2++}),this.uuid=Ao(),this.name="",this.type="Material",this.blending=Ks,this.side=gr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=fh,this.blendDst=ph,this.blendEquation=kr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new bt(0,0,0),this.blendAlpha=0,this.depthFunc=Kl,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Um,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Es,this.stencilZFail=Es,this.stencilZPass=Es,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Ks&&(n.blending=this.blending),this.side!==gr&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==fh&&(n.blendSrc=this.blendSrc),this.blendDst!==ph&&(n.blendDst=this.blendDst),this.blendEquation!==kr&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Kl&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Um&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Es&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Es&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Es&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class $v extends Ac{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new di,this.combine=Pv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const jt=new q,nl=new st;class oi{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Fm,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Si,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return XR("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)nl.fromBufferAttribute(this,t),nl.applyMatrix3(e),this.setXY(t,nl.x,nl.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)jt.fromBufferAttribute(this,t),jt.applyMatrix3(e),this.setXYZ(t,jt.x,jt.y,jt.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)jt.fromBufferAttribute(this,t),jt.applyMatrix4(e),this.setXYZ(t,jt.x,jt.y,jt.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)jt.fromBufferAttribute(this,t),jt.applyNormalMatrix(e),this.setXYZ(t,jt.x,jt.y,jt.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)jt.fromBufferAttribute(this,t),jt.transformDirection(e),this.setXYZ(t,jt.x,jt.y,jt.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Da(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Da(t,this.array)),t}setX(e,t){return this.normalized&&(t=vn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Da(t,this.array)),t}setY(e,t){return this.normalized&&(t=vn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Da(t,this.array)),t}setZ(e,t){return this.normalized&&(t=vn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Da(t,this.array)),t}setW(e,t){return this.normalized&&(t=vn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=vn(t,this.array),n=vn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=vn(t,this.array),n=vn(n,this.array),r=vn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=vn(t,this.array),n=vn(n,this.array),r=vn(r,this.array),s=vn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Fm&&(e.usage=this.usage),e}}class Yv extends oi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Kv extends oi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class qr extends oi{constructor(e,t,n){super(new Float32Array(e),t,n)}}let l2=0;const Dn=new $t,bu=new Nn,Ps=new q,Rn=new ya,Fa=new ya,Jt=new q;class ls extends os{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:l2++}),this.uuid=Ao(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Bv(e)?Kv:Yv)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new ot().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Dn.makeRotationFromQuaternion(e),this.applyMatrix4(Dn),this}rotateX(e){return Dn.makeRotationX(e),this.applyMatrix4(Dn),this}rotateY(e){return Dn.makeRotationY(e),this.applyMatrix4(Dn),this}rotateZ(e){return Dn.makeRotationZ(e),this.applyMatrix4(Dn),this}translate(e,t,n){return Dn.makeTranslation(e,t,n),this.applyMatrix4(Dn),this}scale(e,t,n){return Dn.makeScale(e,t,n),this.applyMatrix4(Dn),this}lookAt(e){return bu.lookAt(e),bu.updateMatrix(),this.applyMatrix4(bu.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ps).negate(),this.translate(Ps.x,Ps.y,Ps.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new qr(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ya);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new q(-1/0,-1/0,-1/0),new q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];Rn.setFromBufferAttribute(s),this.morphTargetsRelative?(Jt.addVectors(this.boundingBox.min,Rn.min),this.boundingBox.expandByPoint(Jt),Jt.addVectors(this.boundingBox.max,Rn.max),this.boundingBox.expandByPoint(Jt)):(this.boundingBox.expandByPoint(Rn.min),this.boundingBox.expandByPoint(Rn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Pd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new q,1/0);return}if(e){const n=this.boundingSphere.center;if(Rn.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];Fa.setFromBufferAttribute(o),this.morphTargetsRelative?(Jt.addVectors(Rn.min,Fa.min),Rn.expandByPoint(Jt),Jt.addVectors(Rn.max,Fa.max),Rn.expandByPoint(Jt)):(Rn.expandByPoint(Fa.min),Rn.expandByPoint(Fa.max))}Rn.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)Jt.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Jt));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let h=0,d=o.count;h<d;h++)Jt.fromBufferAttribute(o,h),l&&(Ps.fromBufferAttribute(e,h),Jt.add(Ps)),r=Math.max(r,n.distanceToSquared(Jt))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new oi(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let A=0;A<n.count;A++)o[A]=new q,l[A]=new q;const h=new q,d=new q,f=new q,p=new st,g=new st,y=new st,T=new q,m=new q;function v(A,C,x){h.fromBufferAttribute(n,A),d.fromBufferAttribute(n,C),f.fromBufferAttribute(n,x),p.fromBufferAttribute(s,A),g.fromBufferAttribute(s,C),y.fromBufferAttribute(s,x),d.sub(h),f.sub(h),g.sub(p),y.sub(p);const E=1/(g.x*y.y-y.x*g.y);isFinite(E)&&(T.copy(d).multiplyScalar(y.y).addScaledVector(f,-g.y).multiplyScalar(E),m.copy(f).multiplyScalar(g.x).addScaledVector(d,-y.x).multiplyScalar(E),o[A].add(T),o[C].add(T),o[x].add(T),l[A].add(m),l[C].add(m),l[x].add(m))}let M=this.groups;M.length===0&&(M=[{start:0,count:e.count}]);for(let A=0,C=M.length;A<C;++A){const x=M[A],E=x.start,O=x.count;for(let I=E,j=E+O;I<j;I+=3)v(e.getX(I+0),e.getX(I+1),e.getX(I+2))}const S=new q,L=new q,V=new q,k=new q;function w(A){V.fromBufferAttribute(r,A),k.copy(V);const C=o[A];S.copy(C),S.sub(V.multiplyScalar(V.dot(C))).normalize(),L.crossVectors(k,C);const E=L.dot(l[A])<0?-1:1;a.setXYZW(A,S.x,S.y,S.z,E)}for(let A=0,C=M.length;A<C;++A){const x=M[A],E=x.start,O=x.count;for(let I=E,j=E+O;I<j;I+=3)w(e.getX(I+0)),w(e.getX(I+1)),w(e.getX(I+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new oi(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let p=0,g=n.count;p<g;p++)n.setXYZ(p,0,0,0);const r=new q,s=new q,a=new q,o=new q,l=new q,h=new q,d=new q,f=new q;if(e)for(let p=0,g=e.count;p<g;p+=3){const y=e.getX(p+0),T=e.getX(p+1),m=e.getX(p+2);r.fromBufferAttribute(t,y),s.fromBufferAttribute(t,T),a.fromBufferAttribute(t,m),d.subVectors(a,s),f.subVectors(r,s),d.cross(f),o.fromBufferAttribute(n,y),l.fromBufferAttribute(n,T),h.fromBufferAttribute(n,m),o.add(d),l.add(d),h.add(d),n.setXYZ(y,o.x,o.y,o.z),n.setXYZ(T,l.x,l.y,l.z),n.setXYZ(m,h.x,h.y,h.z)}else for(let p=0,g=t.count;p<g;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),a.fromBufferAttribute(t,p+2),d.subVectors(a,s),f.subVectors(r,s),d.cross(f),n.setXYZ(p+0,d.x,d.y,d.z),n.setXYZ(p+1,d.x,d.y,d.z),n.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Jt.fromBufferAttribute(e,t),Jt.normalize(),e.setXYZ(t,Jt.x,Jt.y,Jt.z)}toNonIndexed(){function e(o,l){const h=o.array,d=o.itemSize,f=o.normalized,p=new h.constructor(l.length*d);let g=0,y=0;for(let T=0,m=l.length;T<m;T++){o.isInterleavedBufferAttribute?g=l[T]*o.data.stride+o.offset:g=l[T]*d;for(let v=0;v<d;v++)p[y++]=h[g++]}return new oi(p,d,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ls,n=this.index.array,r=this.attributes;for(const o in r){const l=r[o],h=e(l,n);t.setAttribute(o,h)}const s=this.morphAttributes;for(const o in s){const l=[],h=s[o];for(let d=0,f=h.length;d<f;d++){const p=h[d],g=e(p,n);l.push(g)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const h=a[o];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(e[h]=l[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const h=n[l];e.data.attributes[l]=h.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],d=[];for(let f=0,p=h.length;f<p;f++){const g=h[f];d.push(g.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const h in r){const d=r[h];this.setAttribute(h,d.clone(t))}const s=e.morphAttributes;for(const h in s){const d=[],f=s[h];for(let p=0,g=f.length;p<g;p++)d.push(f[p].clone(t));this.morphAttributes[h]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let h=0,d=a.length;h<d;h++){const f=a[h];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Qm=new $t,Ir=new Wv,il=new Pd,Zm=new q,Ns=new q,Ls=new q,Ds=new q,Eu=new q,rl=new q,sl=new st,al=new st,ol=new st,eg=new q,tg=new q,ng=new q,ll=new q,cl=new q;class Ri extends Nn{constructor(e=new ls,t=new $v){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){rl.set(0,0,0);for(let l=0,h=s.length;l<h;l++){const d=o[l],f=s[l];d!==0&&(Eu.fromBufferAttribute(f,e),a?rl.addScaledVector(Eu,d):rl.addScaledVector(Eu.sub(t),d))}t.add(rl)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),il.copy(n.boundingSphere),il.applyMatrix4(s),Ir.copy(e.ray).recast(e.near),!(il.containsPoint(Ir.origin)===!1&&(Ir.intersectSphere(il,Zm)===null||Ir.origin.distanceToSquared(Zm)>(e.far-e.near)**2))&&(Qm.copy(s).invert(),Ir.copy(e.ray).applyMatrix4(Qm),!(n.boundingBox!==null&&Ir.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Ir)))}_computeIntersections(e,t,n){let r;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,h=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,g=s.drawRange;if(o!==null)if(Array.isArray(a))for(let y=0,T=p.length;y<T;y++){const m=p[y],v=a[m.materialIndex],M=Math.max(m.start,g.start),S=Math.min(o.count,Math.min(m.start+m.count,g.start+g.count));for(let L=M,V=S;L<V;L+=3){const k=o.getX(L),w=o.getX(L+1),A=o.getX(L+2);r=ul(this,v,e,n,h,d,f,k,w,A),r&&(r.faceIndex=Math.floor(L/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const y=Math.max(0,g.start),T=Math.min(o.count,g.start+g.count);for(let m=y,v=T;m<v;m+=3){const M=o.getX(m),S=o.getX(m+1),L=o.getX(m+2);r=ul(this,a,e,n,h,d,f,M,S,L),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let y=0,T=p.length;y<T;y++){const m=p[y],v=a[m.materialIndex],M=Math.max(m.start,g.start),S=Math.min(l.count,Math.min(m.start+m.count,g.start+g.count));for(let L=M,V=S;L<V;L+=3){const k=L,w=L+1,A=L+2;r=ul(this,v,e,n,h,d,f,k,w,A),r&&(r.faceIndex=Math.floor(L/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const y=Math.max(0,g.start),T=Math.min(l.count,g.start+g.count);for(let m=y,v=T;m<v;m+=3){const M=m,S=m+1,L=m+2;r=ul(this,a,e,n,h,d,f,M,S,L),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}}}function c2(i,e,t,n,r,s,a,o){let l;if(e.side===En?l=n.intersectTriangle(a,s,r,!0,o):l=n.intersectTriangle(r,s,a,e.side===gr,o),l===null)return null;cl.copy(o),cl.applyMatrix4(i.matrixWorld);const h=t.ray.origin.distanceTo(cl);return h<t.near||h>t.far?null:{distance:h,point:cl.clone(),object:i}}function ul(i,e,t,n,r,s,a,o,l,h){i.getVertexPosition(o,Ns),i.getVertexPosition(l,Ls),i.getVertexPosition(h,Ds);const d=c2(i,e,t,n,Ns,Ls,Ds,ll);if(d){r&&(sl.fromBufferAttribute(r,o),al.fromBufferAttribute(r,l),ol.fromBufferAttribute(r,h),d.uv=ei.getInterpolation(ll,Ns,Ls,Ds,sl,al,ol,new st)),s&&(sl.fromBufferAttribute(s,o),al.fromBufferAttribute(s,l),ol.fromBufferAttribute(s,h),d.uv1=ei.getInterpolation(ll,Ns,Ls,Ds,sl,al,ol,new st)),a&&(eg.fromBufferAttribute(a,o),tg.fromBufferAttribute(a,l),ng.fromBufferAttribute(a,h),d.normal=ei.getInterpolation(ll,Ns,Ls,Ds,eg,tg,ng,new q),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));const f={a:o,b:l,c:h,normal:new q,materialIndex:0};ei.getNormal(Ns,Ls,Ds,f.normal),d.face=f}return d}class Mo extends ls{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const l=[],h=[],d=[],f=[];let p=0,g=0;y("z","y","x",-1,-1,n,t,e,a,s,0),y("z","y","x",1,-1,n,t,-e,a,s,1),y("x","z","y",1,1,e,n,t,r,a,2),y("x","z","y",1,-1,e,n,-t,r,a,3),y("x","y","z",1,-1,e,t,n,r,s,4),y("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new qr(h,3)),this.setAttribute("normal",new qr(d,3)),this.setAttribute("uv",new qr(f,2));function y(T,m,v,M,S,L,V,k,w,A,C){const x=L/w,E=V/A,O=L/2,I=V/2,j=k/2,te=w+1,Z=A+1;let ne=0,ee=0;const ie=new q;for(let pe=0;pe<Z;pe++){const ge=pe*E-I;for(let be=0;be<te;be++){const Re=be*x-O;ie[T]=Re*M,ie[m]=ge*S,ie[v]=j,h.push(ie.x,ie.y,ie.z),ie[T]=0,ie[m]=0,ie[v]=k>0?1:-1,d.push(ie.x,ie.y,ie.z),f.push(be/w),f.push(1-pe/A),ne+=1}}for(let pe=0;pe<A;pe++)for(let ge=0;ge<w;ge++){const be=p+ge+te*pe,Re=p+ge+te*(pe+1),J=p+(ge+1)+te*(pe+1),ue=p+(ge+1)+te*pe;l.push(be,Re,ue),l.push(Re,J,ue),ee+=6}o.addGroup(g,ee,C),g+=ee,p+=ne}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ua(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function mn(i){const e={};for(let t=0;t<i.length;t++){const n=ua(i[t]);for(const r in n)e[r]=n[r]}return e}function u2(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function Jv(i){return i.getRenderTarget()===null?i.outputColorSpace:St.workingColorSpace}const h2={clone:ua,merge:mn};var d2=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,f2=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class _r extends Ac{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=d2,this.fragmentShader=f2,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ua(e.uniforms),this.uniformsGroups=u2(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Qv extends Nn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new $t,this.projectionMatrix=new $t,this.projectionMatrixInverse=new $t,this.coordinateSystem=Mi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Gi=new q,ig=new st,rg=new st;class kn extends Qv{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=yh*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Al*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return yh*2*Math.atan(Math.tan(Al*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Gi.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Gi.x,Gi.y).multiplyScalar(-e/Gi.z),Gi.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Gi.x,Gi.y).multiplyScalar(-e/Gi.z)}getViewSize(e,t){return this.getViewBounds(e,ig,rg),t.subVectors(rg,ig)}setViewOffset(e,t,n,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Al*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,h=a.fullHeight;s+=a.offsetX*r/l,t-=a.offsetY*n/h,r*=a.width/l,n*=a.height/h}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Os=-90,ks=1;class p2 extends Nn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new kn(Os,ks,e,t);r.layers=this.layers,this.add(r);const s=new kn(Os,ks,e,t);s.layers=this.layers,this.add(s);const a=new kn(Os,ks,e,t);a.layers=this.layers,this.add(a);const o=new kn(Os,ks,e,t);o.layers=this.layers,this.add(o);const l=new kn(Os,ks,e,t);l.layers=this.layers,this.add(l);const h=new kn(Os,ks,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,a,o,l]=t;for(const h of t)this.remove(h);if(e===Mi)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===ec)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,h,d]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const T=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,o),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,h),n.texture.generateMipmaps=T,e.setRenderTarget(n,5,r),e.render(t,d),e.setRenderTarget(f,p,g),e.xr.enabled=y,n.texture.needsPMREMUpdate=!0}}class Zv extends wn{constructor(e,t,n,r,s,a,o,l,h,d){e=e!==void 0?e:[],t=t!==void 0?t:oa,super(e,t,n,r,s,a,o,l,h,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class m2 extends es{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Zv(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:yn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Mo(5,5,5),s=new _r({name:"CubemapFromEquirect",uniforms:ua(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:En,blending:ar});s.uniforms.tEquirect.value=t;const a=new Ri(r,s),o=t.minFilter;return t.minFilter===jr&&(t.minFilter=yn),new p2(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}const wu=new q,g2=new q,_2=new ot;class Wi{constructor(e=new q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=wu.subVectors(n,t).cross(g2.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(wu),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||_2.getNormalMatrix(e),r=this.coplanarPoint(wu).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Pr=new Pd,hl=new q;class ex{constructor(e=new Wi,t=new Wi,n=new Wi,r=new Wi,s=new Wi,a=new Wi){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Mi){const n=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],l=r[3],h=r[4],d=r[5],f=r[6],p=r[7],g=r[8],y=r[9],T=r[10],m=r[11],v=r[12],M=r[13],S=r[14],L=r[15];if(n[0].setComponents(l-s,p-h,m-g,L-v).normalize(),n[1].setComponents(l+s,p+h,m+g,L+v).normalize(),n[2].setComponents(l+a,p+d,m+y,L+M).normalize(),n[3].setComponents(l-a,p-d,m-y,L-M).normalize(),n[4].setComponents(l-o,p-f,m-T,L-S).normalize(),t===Mi)n[5].setComponents(l+o,p+f,m+T,L+S).normalize();else if(t===ec)n[5].setComponents(o,f,T,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Pr.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Pr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Pr)}intersectsSprite(e){return Pr.center.set(0,0,0),Pr.radius=.7071067811865476,Pr.applyMatrix4(e.matrixWorld),this.intersectsSphere(Pr)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(hl.x=r.normal.x>0?e.max.x:e.min.x,hl.y=r.normal.y>0?e.max.y:e.min.y,hl.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(hl)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function tx(){let i=null,e=!1,t=null,n=null;function r(s,a){t(s,a),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function v2(i,e){const t=e.isWebGL2,n=new WeakMap;function r(h,d){const f=h.array,p=h.usage,g=f.byteLength,y=i.createBuffer();i.bindBuffer(d,y),i.bufferData(d,f,p),h.onUploadCallback();let T;if(f instanceof Float32Array)T=i.FLOAT;else if(f instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)T=i.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else T=i.UNSIGNED_SHORT;else if(f instanceof Int16Array)T=i.SHORT;else if(f instanceof Uint32Array)T=i.UNSIGNED_INT;else if(f instanceof Int32Array)T=i.INT;else if(f instanceof Int8Array)T=i.BYTE;else if(f instanceof Uint8Array)T=i.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)T=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:y,type:T,bytesPerElement:f.BYTES_PER_ELEMENT,version:h.version,size:g}}function s(h,d,f){const p=d.array,g=d._updateRange,y=d.updateRanges;if(i.bindBuffer(f,h),g.count===-1&&y.length===0&&i.bufferSubData(f,0,p),y.length!==0){for(let T=0,m=y.length;T<m;T++){const v=y[T];t?i.bufferSubData(f,v.start*p.BYTES_PER_ELEMENT,p,v.start,v.count):i.bufferSubData(f,v.start*p.BYTES_PER_ELEMENT,p.subarray(v.start,v.start+v.count))}d.clearUpdateRanges()}g.count!==-1&&(t?i.bufferSubData(f,g.offset*p.BYTES_PER_ELEMENT,p,g.offset,g.count):i.bufferSubData(f,g.offset*p.BYTES_PER_ELEMENT,p.subarray(g.offset,g.offset+g.count)),g.count=-1),d.onUploadCallback()}function a(h){return h.isInterleavedBufferAttribute&&(h=h.data),n.get(h)}function o(h){h.isInterleavedBufferAttribute&&(h=h.data);const d=n.get(h);d&&(i.deleteBuffer(d.buffer),n.delete(h))}function l(h,d){if(h.isGLBufferAttribute){const p=n.get(h);(!p||p.version<h.version)&&n.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const f=n.get(h);if(f===void 0)n.set(h,r(h,d));else if(f.version<h.version){if(f.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,h,d),f.version=h.version}}return{get:a,remove:o,update:l}}class Mc extends ls{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,a=t/2,o=Math.floor(n),l=Math.floor(r),h=o+1,d=l+1,f=e/o,p=t/l,g=[],y=[],T=[],m=[];for(let v=0;v<d;v++){const M=v*p-a;for(let S=0;S<h;S++){const L=S*f-s;y.push(L,-M,0),T.push(0,0,1),m.push(S/o),m.push(1-v/l)}}for(let v=0;v<l;v++)for(let M=0;M<o;M++){const S=M+h*v,L=M+h*(v+1),V=M+1+h*(v+1),k=M+1+h*v;g.push(S,L,k),g.push(L,V,k)}this.setIndex(g),this.setAttribute("position",new qr(y,3)),this.setAttribute("normal",new qr(T,3)),this.setAttribute("uv",new qr(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mc(e.width,e.height,e.widthSegments,e.heightSegments)}}var x2=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,y2=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,b2=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,E2=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,w2=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,S2=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,T2=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,A2=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,M2=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,R2=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,C2=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,I2=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,P2=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,N2=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,L2=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,D2=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,O2=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,k2=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,U2=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,F2=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,V2=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,j2=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,B2=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,z2=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,H2=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,G2=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,W2=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,q2=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,X2=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,$2=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Y2="gl_FragColor = linearToOutputTexel( gl_FragColor );",K2=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,J2=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Q2=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Z2=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,eC=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,tC=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,nC=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,iC=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,rC=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,sC=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,aC=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,oC=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lC=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,cC=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,uC=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,hC=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,dC=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,fC=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,pC=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,mC=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,gC=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,_C=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,vC=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,xC=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,yC=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,bC=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,EC=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,wC=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,SC=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,TC=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,AC=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,MC=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,RC=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,CC=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,IC=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,PC=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,NC=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,LC=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,DC=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,OC=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,kC=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,UC=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,FC=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,VC=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,jC=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,BC=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,zC=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,HC=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,GC=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,WC=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,qC=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,XC=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,$C=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,YC=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,KC=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,JC=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,QC=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,ZC=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,eI=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,tI=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,nI=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,iI=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,rI=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,sI=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,aI=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,oI=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,lI=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,cI=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,uI=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,hI=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,dI=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	float startCompression = 0.8 - 0.04;
	float desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min(color.r, min(color.g, color.b));
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max(color.r, max(color.g, color.b));
	if (peak < startCompression) return color;
	float d = 1. - startCompression;
	float newPeak = 1. - d * d / (peak + d - startCompression);
	color *= newPeak / peak;
	float g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);
	return mix(color, vec3(1, 1, 1), g);
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,fI=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,pI=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,mI=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,gI=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,_I=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,vI=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const xI=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,yI=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,EI=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,SI=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TI=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,AI=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,MI=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,RI=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,CI=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,II=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,PI=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NI=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,LI=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,DI=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OI=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kI=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UI=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,FI=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VI=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,jI=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,BI=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zI=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HI=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,GI=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WI=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qI=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XI=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,$I=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,YI=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KI=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,JI=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,QI=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,at={alphahash_fragment:x2,alphahash_pars_fragment:y2,alphamap_fragment:b2,alphamap_pars_fragment:E2,alphatest_fragment:w2,alphatest_pars_fragment:S2,aomap_fragment:T2,aomap_pars_fragment:A2,batching_pars_vertex:M2,batching_vertex:R2,begin_vertex:C2,beginnormal_vertex:I2,bsdfs:P2,iridescence_fragment:N2,bumpmap_pars_fragment:L2,clipping_planes_fragment:D2,clipping_planes_pars_fragment:O2,clipping_planes_pars_vertex:k2,clipping_planes_vertex:U2,color_fragment:F2,color_pars_fragment:V2,color_pars_vertex:j2,color_vertex:B2,common:z2,cube_uv_reflection_fragment:H2,defaultnormal_vertex:G2,displacementmap_pars_vertex:W2,displacementmap_vertex:q2,emissivemap_fragment:X2,emissivemap_pars_fragment:$2,colorspace_fragment:Y2,colorspace_pars_fragment:K2,envmap_fragment:J2,envmap_common_pars_fragment:Q2,envmap_pars_fragment:Z2,envmap_pars_vertex:eC,envmap_physical_pars_fragment:dC,envmap_vertex:tC,fog_vertex:nC,fog_pars_vertex:iC,fog_fragment:rC,fog_pars_fragment:sC,gradientmap_pars_fragment:aC,lightmap_fragment:oC,lightmap_pars_fragment:lC,lights_lambert_fragment:cC,lights_lambert_pars_fragment:uC,lights_pars_begin:hC,lights_toon_fragment:fC,lights_toon_pars_fragment:pC,lights_phong_fragment:mC,lights_phong_pars_fragment:gC,lights_physical_fragment:_C,lights_physical_pars_fragment:vC,lights_fragment_begin:xC,lights_fragment_maps:yC,lights_fragment_end:bC,logdepthbuf_fragment:EC,logdepthbuf_pars_fragment:wC,logdepthbuf_pars_vertex:SC,logdepthbuf_vertex:TC,map_fragment:AC,map_pars_fragment:MC,map_particle_fragment:RC,map_particle_pars_fragment:CC,metalnessmap_fragment:IC,metalnessmap_pars_fragment:PC,morphinstance_vertex:NC,morphcolor_vertex:LC,morphnormal_vertex:DC,morphtarget_pars_vertex:OC,morphtarget_vertex:kC,normal_fragment_begin:UC,normal_fragment_maps:FC,normal_pars_fragment:VC,normal_pars_vertex:jC,normal_vertex:BC,normalmap_pars_fragment:zC,clearcoat_normal_fragment_begin:HC,clearcoat_normal_fragment_maps:GC,clearcoat_pars_fragment:WC,iridescence_pars_fragment:qC,opaque_fragment:XC,packing:$C,premultiplied_alpha_fragment:YC,project_vertex:KC,dithering_fragment:JC,dithering_pars_fragment:QC,roughnessmap_fragment:ZC,roughnessmap_pars_fragment:eI,shadowmap_pars_fragment:tI,shadowmap_pars_vertex:nI,shadowmap_vertex:iI,shadowmask_pars_fragment:rI,skinbase_vertex:sI,skinning_pars_vertex:aI,skinning_vertex:oI,skinnormal_vertex:lI,specularmap_fragment:cI,specularmap_pars_fragment:uI,tonemapping_fragment:hI,tonemapping_pars_fragment:dI,transmission_fragment:fI,transmission_pars_fragment:pI,uv_pars_fragment:mI,uv_pars_vertex:gI,uv_vertex:_I,worldpos_vertex:vI,background_vert:xI,background_frag:yI,backgroundCube_vert:bI,backgroundCube_frag:EI,cube_vert:wI,cube_frag:SI,depth_vert:TI,depth_frag:AI,distanceRGBA_vert:MI,distanceRGBA_frag:RI,equirect_vert:CI,equirect_frag:II,linedashed_vert:PI,linedashed_frag:NI,meshbasic_vert:LI,meshbasic_frag:DI,meshlambert_vert:OI,meshlambert_frag:kI,meshmatcap_vert:UI,meshmatcap_frag:FI,meshnormal_vert:VI,meshnormal_frag:jI,meshphong_vert:BI,meshphong_frag:zI,meshphysical_vert:HI,meshphysical_frag:GI,meshtoon_vert:WI,meshtoon_frag:qI,points_vert:XI,points_frag:$I,shadow_vert:YI,shadow_frag:KI,sprite_vert:JI,sprite_frag:QI},ve={common:{diffuse:{value:new bt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ot},alphaMap:{value:null},alphaMapTransform:{value:new ot},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ot}},envmap:{envMap:{value:null},envMapRotation:{value:new ot},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ot}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ot}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ot},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ot},normalScale:{value:new st(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ot},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ot}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ot}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ot}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new bt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new bt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ot},alphaTest:{value:0},uvTransform:{value:new ot}},sprite:{diffuse:{value:new bt(16777215)},opacity:{value:1},center:{value:new st(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ot},alphaMap:{value:null},alphaMapTransform:{value:new ot},alphaTest:{value:0}}},Qn={basic:{uniforms:mn([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.fog]),vertexShader:at.meshbasic_vert,fragmentShader:at.meshbasic_frag},lambert:{uniforms:mn([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,ve.lights,{emissive:{value:new bt(0)}}]),vertexShader:at.meshlambert_vert,fragmentShader:at.meshlambert_frag},phong:{uniforms:mn([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,ve.lights,{emissive:{value:new bt(0)},specular:{value:new bt(1118481)},shininess:{value:30}}]),vertexShader:at.meshphong_vert,fragmentShader:at.meshphong_frag},standard:{uniforms:mn([ve.common,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.roughnessmap,ve.metalnessmap,ve.fog,ve.lights,{emissive:{value:new bt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:at.meshphysical_vert,fragmentShader:at.meshphysical_frag},toon:{uniforms:mn([ve.common,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.gradientmap,ve.fog,ve.lights,{emissive:{value:new bt(0)}}]),vertexShader:at.meshtoon_vert,fragmentShader:at.meshtoon_frag},matcap:{uniforms:mn([ve.common,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,{matcap:{value:null}}]),vertexShader:at.meshmatcap_vert,fragmentShader:at.meshmatcap_frag},points:{uniforms:mn([ve.points,ve.fog]),vertexShader:at.points_vert,fragmentShader:at.points_frag},dashed:{uniforms:mn([ve.common,ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:at.linedashed_vert,fragmentShader:at.linedashed_frag},depth:{uniforms:mn([ve.common,ve.displacementmap]),vertexShader:at.depth_vert,fragmentShader:at.depth_frag},normal:{uniforms:mn([ve.common,ve.bumpmap,ve.normalmap,ve.displacementmap,{opacity:{value:1}}]),vertexShader:at.meshnormal_vert,fragmentShader:at.meshnormal_frag},sprite:{uniforms:mn([ve.sprite,ve.fog]),vertexShader:at.sprite_vert,fragmentShader:at.sprite_frag},background:{uniforms:{uvTransform:{value:new ot},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:at.background_vert,fragmentShader:at.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ot}},vertexShader:at.backgroundCube_vert,fragmentShader:at.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:at.cube_vert,fragmentShader:at.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:at.equirect_vert,fragmentShader:at.equirect_frag},distanceRGBA:{uniforms:mn([ve.common,ve.displacementmap,{referencePosition:{value:new q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:at.distanceRGBA_vert,fragmentShader:at.distanceRGBA_frag},shadow:{uniforms:mn([ve.lights,ve.fog,{color:{value:new bt(0)},opacity:{value:1}}]),vertexShader:at.shadow_vert,fragmentShader:at.shadow_frag}};Qn.physical={uniforms:mn([Qn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ot},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ot},clearcoatNormalScale:{value:new st(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ot},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ot},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ot},sheen:{value:0},sheenColor:{value:new bt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ot},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ot},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ot},transmissionSamplerSize:{value:new st},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ot},attenuationDistance:{value:0},attenuationColor:{value:new bt(0)},specularColor:{value:new bt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ot},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ot},anisotropyVector:{value:new st},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ot}}]),vertexShader:at.meshphysical_vert,fragmentShader:at.meshphysical_frag};const dl={r:0,b:0,g:0},Nr=new di,ZI=new $t;function eP(i,e,t,n,r,s,a){const o=new bt(0);let l=s===!0?0:1,h,d,f=null,p=0,g=null;function y(m,v){let M=!1,S=v.isScene===!0?v.background:null;S&&S.isTexture&&(S=(v.backgroundBlurriness>0?t:e).get(S)),S===null?T(o,l):S&&S.isColor&&(T(S,1),M=!0);const L=i.xr.getEnvironmentBlendMode();L==="additive"?n.buffers.color.setClear(0,0,0,1,a):L==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(i.autoClear||M)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),S&&(S.isCubeTexture||S.mapping===Sc)?(d===void 0&&(d=new Ri(new Mo(1,1,1),new _r({name:"BackgroundCubeMaterial",uniforms:ua(Qn.backgroundCube.uniforms),vertexShader:Qn.backgroundCube.vertexShader,fragmentShader:Qn.backgroundCube.fragmentShader,side:En,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(V,k,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),Nr.copy(v.backgroundRotation),Nr.x*=-1,Nr.y*=-1,Nr.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(Nr.y*=-1,Nr.z*=-1),d.material.uniforms.envMap.value=S,d.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(ZI.makeRotationFromEuler(Nr)),d.material.toneMapped=St.getTransfer(S.colorSpace)!==It,(f!==S||p!==S.version||g!==i.toneMapping)&&(d.material.needsUpdate=!0,f=S,p=S.version,g=i.toneMapping),d.layers.enableAll(),m.unshift(d,d.geometry,d.material,0,0,null)):S&&S.isTexture&&(h===void 0&&(h=new Ri(new Mc(2,2),new _r({name:"BackgroundMaterial",uniforms:ua(Qn.background.uniforms),vertexShader:Qn.background.vertexShader,fragmentShader:Qn.background.fragmentShader,side:gr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(h)),h.material.uniforms.t2D.value=S,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=St.getTransfer(S.colorSpace)!==It,S.matrixAutoUpdate===!0&&S.updateMatrix(),h.material.uniforms.uvTransform.value.copy(S.matrix),(f!==S||p!==S.version||g!==i.toneMapping)&&(h.material.needsUpdate=!0,f=S,p=S.version,g=i.toneMapping),h.layers.enableAll(),m.unshift(h,h.geometry,h.material,0,0,null))}function T(m,v){m.getRGB(dl,Jv(i)),n.buffers.color.setClear(dl.r,dl.g,dl.b,v,a)}return{getClearColor:function(){return o},setClearColor:function(m,v=1){o.set(m),l=v,T(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,T(o,l)},render:y}}function tP(i,e,t,n){const r=i.getParameter(i.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||s!==null,o={},l=m(null);let h=l,d=!1;function f(j,te,Z,ne,ee){let ie=!1;if(a){const pe=T(ne,Z,te);h!==pe&&(h=pe,g(h.object)),ie=v(j,ne,Z,ee),ie&&M(j,ne,Z,ee)}else{const pe=te.wireframe===!0;(h.geometry!==ne.id||h.program!==Z.id||h.wireframe!==pe)&&(h.geometry=ne.id,h.program=Z.id,h.wireframe=pe,ie=!0)}ee!==null&&t.update(ee,i.ELEMENT_ARRAY_BUFFER),(ie||d)&&(d=!1,A(j,te,Z,ne),ee!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.get(ee).buffer))}function p(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}function g(j){return n.isWebGL2?i.bindVertexArray(j):s.bindVertexArrayOES(j)}function y(j){return n.isWebGL2?i.deleteVertexArray(j):s.deleteVertexArrayOES(j)}function T(j,te,Z){const ne=Z.wireframe===!0;let ee=o[j.id];ee===void 0&&(ee={},o[j.id]=ee);let ie=ee[te.id];ie===void 0&&(ie={},ee[te.id]=ie);let pe=ie[ne];return pe===void 0&&(pe=m(p()),ie[ne]=pe),pe}function m(j){const te=[],Z=[],ne=[];for(let ee=0;ee<r;ee++)te[ee]=0,Z[ee]=0,ne[ee]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:te,enabledAttributes:Z,attributeDivisors:ne,object:j,attributes:{},index:null}}function v(j,te,Z,ne){const ee=h.attributes,ie=te.attributes;let pe=0;const ge=Z.getAttributes();for(const be in ge)if(ge[be].location>=0){const J=ee[be];let ue=ie[be];if(ue===void 0&&(be==="instanceMatrix"&&j.instanceMatrix&&(ue=j.instanceMatrix),be==="instanceColor"&&j.instanceColor&&(ue=j.instanceColor)),J===void 0||J.attribute!==ue||ue&&J.data!==ue.data)return!0;pe++}return h.attributesNum!==pe||h.index!==ne}function M(j,te,Z,ne){const ee={},ie=te.attributes;let pe=0;const ge=Z.getAttributes();for(const be in ge)if(ge[be].location>=0){let J=ie[be];J===void 0&&(be==="instanceMatrix"&&j.instanceMatrix&&(J=j.instanceMatrix),be==="instanceColor"&&j.instanceColor&&(J=j.instanceColor));const ue={};ue.attribute=J,J&&J.data&&(ue.data=J.data),ee[be]=ue,pe++}h.attributes=ee,h.attributesNum=pe,h.index=ne}function S(){const j=h.newAttributes;for(let te=0,Z=j.length;te<Z;te++)j[te]=0}function L(j){V(j,0)}function V(j,te){const Z=h.newAttributes,ne=h.enabledAttributes,ee=h.attributeDivisors;Z[j]=1,ne[j]===0&&(i.enableVertexAttribArray(j),ne[j]=1),ee[j]!==te&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](j,te),ee[j]=te)}function k(){const j=h.newAttributes,te=h.enabledAttributes;for(let Z=0,ne=te.length;Z<ne;Z++)te[Z]!==j[Z]&&(i.disableVertexAttribArray(Z),te[Z]=0)}function w(j,te,Z,ne,ee,ie,pe){pe===!0?i.vertexAttribIPointer(j,te,Z,ee,ie):i.vertexAttribPointer(j,te,Z,ne,ee,ie)}function A(j,te,Z,ne){if(n.isWebGL2===!1&&(j.isInstancedMesh||ne.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const ee=ne.attributes,ie=Z.getAttributes(),pe=te.defaultAttributeValues;for(const ge in ie){const be=ie[ge];if(be.location>=0){let Re=ee[ge];if(Re===void 0&&(ge==="instanceMatrix"&&j.instanceMatrix&&(Re=j.instanceMatrix),ge==="instanceColor"&&j.instanceColor&&(Re=j.instanceColor)),Re!==void 0){const J=Re.normalized,ue=Re.itemSize,Se=t.get(Re);if(Se===void 0)continue;const je=Se.buffer,Oe=Se.type,Te=Se.bytesPerElement,ht=n.isWebGL2===!0&&(Oe===i.INT||Oe===i.UNSIGNED_INT||Re.gpuType===Lv);if(Re.isInterleavedBufferAttribute){const Ve=Re.data,H=Ve.stride,Nt=Re.offset;if(Ve.isInstancedInterleavedBuffer){for(let De=0;De<be.locationSize;De++)V(be.location+De,Ve.meshPerAttribute);j.isInstancedMesh!==!0&&ne._maxInstanceCount===void 0&&(ne._maxInstanceCount=Ve.meshPerAttribute*Ve.count)}else for(let De=0;De<be.locationSize;De++)L(be.location+De);i.bindBuffer(i.ARRAY_BUFFER,je);for(let De=0;De<be.locationSize;De++)w(be.location+De,ue/be.locationSize,Oe,J,H*Te,(Nt+ue/be.locationSize*De)*Te,ht)}else{if(Re.isInstancedBufferAttribute){for(let Ve=0;Ve<be.locationSize;Ve++)V(be.location+Ve,Re.meshPerAttribute);j.isInstancedMesh!==!0&&ne._maxInstanceCount===void 0&&(ne._maxInstanceCount=Re.meshPerAttribute*Re.count)}else for(let Ve=0;Ve<be.locationSize;Ve++)L(be.location+Ve);i.bindBuffer(i.ARRAY_BUFFER,je);for(let Ve=0;Ve<be.locationSize;Ve++)w(be.location+Ve,ue/be.locationSize,Oe,J,ue*Te,ue/be.locationSize*Ve*Te,ht)}}else if(pe!==void 0){const J=pe[ge];if(J!==void 0)switch(J.length){case 2:i.vertexAttrib2fv(be.location,J);break;case 3:i.vertexAttrib3fv(be.location,J);break;case 4:i.vertexAttrib4fv(be.location,J);break;default:i.vertexAttrib1fv(be.location,J)}}}}k()}function C(){O();for(const j in o){const te=o[j];for(const Z in te){const ne=te[Z];for(const ee in ne)y(ne[ee].object),delete ne[ee];delete te[Z]}delete o[j]}}function x(j){if(o[j.id]===void 0)return;const te=o[j.id];for(const Z in te){const ne=te[Z];for(const ee in ne)y(ne[ee].object),delete ne[ee];delete te[Z]}delete o[j.id]}function E(j){for(const te in o){const Z=o[te];if(Z[j.id]===void 0)continue;const ne=Z[j.id];for(const ee in ne)y(ne[ee].object),delete ne[ee];delete Z[j.id]}}function O(){I(),d=!0,h!==l&&(h=l,g(h.object))}function I(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:O,resetDefaultState:I,dispose:C,releaseStatesOfGeometry:x,releaseStatesOfProgram:E,initAttributes:S,enableAttribute:L,disableUnusedAttributes:k}}function nP(i,e,t,n){const r=n.isWebGL2;let s;function a(d){s=d}function o(d,f){i.drawArrays(s,d,f),t.update(f,s,1)}function l(d,f,p){if(p===0)return;let g,y;if(r)g=i,y="drawArraysInstanced";else if(g=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[y](s,d,f,p),t.update(f,s,p)}function h(d,f,p){if(p===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<p;y++)this.render(d[y],f[y]);else{g.multiDrawArraysWEBGL(s,d,0,f,0,p);let y=0;for(let T=0;T<p;T++)y+=f[T];t.update(y,s,1)}}this.setMode=a,this.render=o,this.renderInstances=l,this.renderMultiDraw=h}function iP(i,e,t){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const w=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(w.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(w){if(w==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";w="mediump"}return w==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&i.constructor.name==="WebGL2RenderingContext";let o=t.precision!==void 0?t.precision:"highp";const l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const h=a||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,f=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),p=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=i.getParameter(i.MAX_TEXTURE_SIZE),y=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),T=i.getParameter(i.MAX_VERTEX_ATTRIBS),m=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),v=i.getParameter(i.MAX_VARYING_VECTORS),M=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),S=p>0,L=a||e.has("OES_texture_float"),V=S&&L,k=a?i.getParameter(i.MAX_SAMPLES):0;return{isWebGL2:a,drawBuffers:h,getMaxAnisotropy:r,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:y,maxAttributes:T,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:M,vertexTextures:S,floatFragmentTextures:L,floatVertexTextures:V,maxSamples:k}}function rP(i){const e=this;let t=null,n=0,r=!1,s=!1;const a=new Wi,o=new ot,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const g=f.length!==0||p||n!==0||r;return r=p,n=f.length,g},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=d(f,p,0)},this.setState=function(f,p,g){const y=f.clippingPlanes,T=f.clipIntersection,m=f.clipShadows,v=i.get(f);if(!r||y===null||y.length===0||s&&!m)s?d(null):h();else{const M=s?0:n,S=M*4;let L=v.clippingState||null;l.value=L,L=d(y,p,S,g);for(let V=0;V!==S;++V)L[V]=t[V];v.clippingState=L,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=M}};function h(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function d(f,p,g,y){const T=f!==null?f.length:0;let m=null;if(T!==0){if(m=l.value,y!==!0||m===null){const v=g+T*4,M=p.matrixWorldInverse;o.getNormalMatrix(M),(m===null||m.length<v)&&(m=new Float32Array(v));for(let S=0,L=g;S!==T;++S,L+=4)a.copy(f[S]).applyMatrix4(M,o),a.normal.toArray(m,L),m[L+3]=a.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,m}}function sP(i){let e=new WeakMap;function t(a,o){return o===mh?a.mapping=oa:o===gh&&(a.mapping=la),a}function n(a){if(a&&a.isTexture){const o=a.mapping;if(o===mh||o===gh)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const h=new m2(l.height);return h.fromEquirectangularTexture(i,a),e.set(a,h),a.addEventListener("dispose",r),t(h.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class nx extends Qv{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,a=n+e,o=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,a=s+h*this.view.width,o-=d*this.view.offsetY,l=o-d*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Hs=4,sg=[.125,.215,.35,.446,.526,.582],Ur=20,Su=new nx,ag=new bt;let Tu=null,Au=0,Mu=0;const Or=(1+Math.sqrt(5))/2,Us=1/Or,og=[new q(1,1,1),new q(-1,1,1),new q(1,1,-1),new q(-1,1,-1),new q(0,Or,Us),new q(0,Or,-Us),new q(Us,0,Or),new q(-Us,0,Or),new q(Or,Us,0),new q(-Or,Us,0)];class lg{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Tu=this._renderer.getRenderTarget(),Au=this._renderer.getActiveCubeFace(),Mu=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=hg(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ug(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Tu,Au,Mu),e.scissorTest=!1,fl(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===oa||e.mapping===la?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Tu=this._renderer.getRenderTarget(),Au=this._renderer.getActiveCubeFace(),Mu=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:yn,minFilter:yn,generateMipmaps:!1,type:uo,format:qn,colorSpace:Er,depthBuffer:!1},r=cg(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=cg(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=aP(s)),this._blurMaterial=oP(s,e,t)}return r}_compileMaterial(e){const t=new Ri(this._lodPlanes[0],e);this._renderer.compile(t,Su)}_sceneToCubeUV(e,t,n,r){const o=new kn(90,1,t,n),l=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,p=d.toneMapping;d.getClearColor(ag),d.toneMapping=or,d.autoClear=!1;const g=new $v({name:"PMREM.Background",side:En,depthWrite:!1,depthTest:!1}),y=new Ri(new Mo,g);let T=!1;const m=e.background;m?m.isColor&&(g.color.copy(m),e.background=null,T=!0):(g.color.copy(ag),T=!0);for(let v=0;v<6;v++){const M=v%3;M===0?(o.up.set(0,l[v],0),o.lookAt(h[v],0,0)):M===1?(o.up.set(0,0,l[v]),o.lookAt(0,h[v],0)):(o.up.set(0,l[v],0),o.lookAt(0,0,h[v]));const S=this._cubeSize;fl(r,M*S,v>2?S:0,S,S),d.setRenderTarget(r),T&&d.render(y,o),d.render(e,o)}y.geometry.dispose(),y.material.dispose(),d.toneMapping=p,d.autoClear=f,e.background=m}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===oa||e.mapping===la;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=hg()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ug());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new Ri(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;fl(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(a,Su)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=og[(r-1)%og.length];this._blur(e,r-1,r,s,a)}t.autoClear=n}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,o){const l=this._renderer,h=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,f=new Ri(this._lodPlanes[r],h),p=h.uniforms,g=this._sizeLods[n]-1,y=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*Ur-1),T=s/y,m=isFinite(s)?1+Math.floor(d*T):Ur;m>Ur&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Ur}`);const v=[];let M=0;for(let w=0;w<Ur;++w){const A=w/T,C=Math.exp(-A*A/2);v.push(C),w===0?M+=C:w<m&&(M+=2*C)}for(let w=0;w<v.length;w++)v[w]=v[w]/M;p.envMap.value=e.texture,p.samples.value=m,p.weights.value=v,p.latitudinal.value=a==="latitudinal",o&&(p.poleAxis.value=o);const{_lodMax:S}=this;p.dTheta.value=y,p.mipInt.value=S-n;const L=this._sizeLods[r],V=3*L*(r>S-Hs?r-S+Hs:0),k=4*(this._cubeSize-L);fl(t,V,k,3*L,2*L),l.setRenderTarget(t),l.render(f,Su)}}function aP(i){const e=[],t=[],n=[];let r=i;const s=i-Hs+1+sg.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);t.push(o);let l=1/o;a>i-Hs?l=sg[a-i+Hs-1]:a===0&&(l=0),n.push(l);const h=1/(o-2),d=-h,f=1+h,p=[d,d,f,d,f,f,d,d,f,f,d,f],g=6,y=6,T=3,m=2,v=1,M=new Float32Array(T*y*g),S=new Float32Array(m*y*g),L=new Float32Array(v*y*g);for(let k=0;k<g;k++){const w=k%3*2/3-1,A=k>2?0:-1,C=[w,A,0,w+2/3,A,0,w+2/3,A+1,0,w,A,0,w+2/3,A+1,0,w,A+1,0];M.set(C,T*y*k),S.set(p,m*y*k);const x=[k,k,k,k,k,k];L.set(x,v*y*k)}const V=new ls;V.setAttribute("position",new oi(M,T)),V.setAttribute("uv",new oi(S,m)),V.setAttribute("faceIndex",new oi(L,v)),e.push(V),r>Hs&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function cg(i,e,t){const n=new es(i,e,t);return n.texture.mapping=Sc,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function fl(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function oP(i,e,t){const n=new Float32Array(Ur),r=new q(0,1,0);return new _r({name:"SphericalGaussianBlur",defines:{n:Ur,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Nd(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ar,depthTest:!1,depthWrite:!1})}function ug(){return new _r({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Nd(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ar,depthTest:!1,depthWrite:!1})}function hg(){return new _r({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Nd(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ar,depthTest:!1,depthWrite:!1})}function Nd(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function lP(i){let e=new WeakMap,t=null;function n(o){if(o&&o.isTexture){const l=o.mapping,h=l===mh||l===gh,d=l===oa||l===la;if(h||d)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let f=e.get(o);return t===null&&(t=new lg(i)),f=h?t.fromEquirectangular(o,f):t.fromCubemap(o,f),e.set(o,f),f.texture}else{if(e.has(o))return e.get(o).texture;{const f=o.image;if(h&&f&&f.height>0||d&&f&&r(f)){t===null&&(t=new lg(i));const p=h?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,p),o.addEventListener("dispose",s),p.texture}else return null}}}return o}function r(o){let l=0;const h=6;for(let d=0;d<h;d++)o[d]!==void 0&&l++;return l===h}function s(o){const l=o.target;l.removeEventListener("dispose",s);const h=e.get(l);h!==void 0&&(e.delete(l),h.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function cP(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function uP(i,e,t,n){const r={},s=new WeakMap;function a(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const y in p.attributes)e.remove(p.attributes[y]);for(const y in p.morphAttributes){const T=p.morphAttributes[y];for(let m=0,v=T.length;m<v;m++)e.remove(T[m])}p.removeEventListener("dispose",a),delete r[p.id];const g=s.get(p);g&&(e.remove(g),s.delete(p)),n.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function o(f,p){return r[p.id]===!0||(p.addEventListener("dispose",a),r[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const y in p)e.update(p[y],i.ARRAY_BUFFER);const g=f.morphAttributes;for(const y in g){const T=g[y];for(let m=0,v=T.length;m<v;m++)e.update(T[m],i.ARRAY_BUFFER)}}function h(f){const p=[],g=f.index,y=f.attributes.position;let T=0;if(g!==null){const M=g.array;T=g.version;for(let S=0,L=M.length;S<L;S+=3){const V=M[S+0],k=M[S+1],w=M[S+2];p.push(V,k,k,w,w,V)}}else if(y!==void 0){const M=y.array;T=y.version;for(let S=0,L=M.length/3-1;S<L;S+=3){const V=S+0,k=S+1,w=S+2;p.push(V,k,k,w,w,V)}}else return;const m=new(Bv(p)?Kv:Yv)(p,1);m.version=T;const v=s.get(f);v&&e.remove(v),s.set(f,m)}function d(f){const p=s.get(f);if(p){const g=f.index;g!==null&&p.version<g.version&&h(f)}else h(f);return s.get(f)}return{get:o,update:l,getWireframeAttribute:d}}function hP(i,e,t,n){const r=n.isWebGL2;let s;function a(g){s=g}let o,l;function h(g){o=g.type,l=g.bytesPerElement}function d(g,y){i.drawElements(s,y,o,g*l),t.update(y,s,1)}function f(g,y,T){if(T===0)return;let m,v;if(r)m=i,v="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](s,y,o,g*l,T),t.update(y,s,T)}function p(g,y,T){if(T===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let v=0;v<T;v++)this.render(g[v]/l,y[v]);else{m.multiDrawElementsWEBGL(s,y,0,o,g,0,T);let v=0;for(let M=0;M<T;M++)v+=y[M];t.update(v,s,1)}}this.setMode=a,this.setIndex=h,this.render=d,this.renderInstances=f,this.renderMultiDraw=p}function dP(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(t.calls++,a){case i.TRIANGLES:t.triangles+=o*(s/3);break;case i.LINES:t.lines+=o*(s/2);break;case i.LINE_STRIP:t.lines+=o*(s-1);break;case i.LINE_LOOP:t.lines+=o*s;break;case i.POINTS:t.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function fP(i,e){return i[0]-e[0]}function pP(i,e){return Math.abs(e[1])-Math.abs(i[1])}function mP(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,a=new rn,o=[];for(let h=0;h<8;h++)o[h]=[h,0];function l(h,d,f){const p=h.morphTargetInfluences;if(e.isWebGL2===!0){const g=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,y=g!==void 0?g.length:0;let T=s.get(d);if(T===void 0||T.count!==y){let O=function(){x.dispose(),s.delete(d),d.removeEventListener("dispose",O)};T!==void 0&&T.texture.dispose();const m=d.morphAttributes.position!==void 0,v=d.morphAttributes.normal!==void 0,M=d.morphAttributes.color!==void 0,S=d.morphAttributes.position||[],L=d.morphAttributes.normal||[],V=d.morphAttributes.color||[];let k=0;m===!0&&(k=1),v===!0&&(k=2),M===!0&&(k=3);let w=d.attributes.position.count*k,A=1;w>e.maxTextureSize&&(A=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const C=new Float32Array(w*A*4*y),x=new Gv(C,w,A,y);x.type=Si,x.needsUpdate=!0;const E=k*4;for(let I=0;I<y;I++){const j=S[I],te=L[I],Z=V[I],ne=w*A*4*I;for(let ee=0;ee<j.count;ee++){const ie=ee*E;m===!0&&(a.fromBufferAttribute(j,ee),C[ne+ie+0]=a.x,C[ne+ie+1]=a.y,C[ne+ie+2]=a.z,C[ne+ie+3]=0),v===!0&&(a.fromBufferAttribute(te,ee),C[ne+ie+4]=a.x,C[ne+ie+5]=a.y,C[ne+ie+6]=a.z,C[ne+ie+7]=0),M===!0&&(a.fromBufferAttribute(Z,ee),C[ne+ie+8]=a.x,C[ne+ie+9]=a.y,C[ne+ie+10]=a.z,C[ne+ie+11]=Z.itemSize===4?a.w:1)}}T={count:y,texture:x,size:new st(w,A)},s.set(d,T),d.addEventListener("dispose",O)}if(h.isInstancedMesh===!0&&h.morphTexture!==null)f.getUniforms().setValue(i,"morphTexture",h.morphTexture,t);else{let m=0;for(let M=0;M<p.length;M++)m+=p[M];const v=d.morphTargetsRelative?1:1-m;f.getUniforms().setValue(i,"morphTargetBaseInfluence",v),f.getUniforms().setValue(i,"morphTargetInfluences",p)}f.getUniforms().setValue(i,"morphTargetsTexture",T.texture,t),f.getUniforms().setValue(i,"morphTargetsTextureSize",T.size)}else{const g=p===void 0?0:p.length;let y=n[d.id];if(y===void 0||y.length!==g){y=[];for(let S=0;S<g;S++)y[S]=[S,0];n[d.id]=y}for(let S=0;S<g;S++){const L=y[S];L[0]=S,L[1]=p[S]}y.sort(pP);for(let S=0;S<8;S++)S<g&&y[S][1]?(o[S][0]=y[S][0],o[S][1]=y[S][1]):(o[S][0]=Number.MAX_SAFE_INTEGER,o[S][1]=0);o.sort(fP);const T=d.morphAttributes.position,m=d.morphAttributes.normal;let v=0;for(let S=0;S<8;S++){const L=o[S],V=L[0],k=L[1];V!==Number.MAX_SAFE_INTEGER&&k?(T&&d.getAttribute("morphTarget"+S)!==T[V]&&d.setAttribute("morphTarget"+S,T[V]),m&&d.getAttribute("morphNormal"+S)!==m[V]&&d.setAttribute("morphNormal"+S,m[V]),r[S]=k,v+=k):(T&&d.hasAttribute("morphTarget"+S)===!0&&d.deleteAttribute("morphTarget"+S),m&&d.hasAttribute("morphNormal"+S)===!0&&d.deleteAttribute("morphNormal"+S),r[S]=0)}const M=d.morphTargetsRelative?1:1-v;f.getUniforms().setValue(i,"morphTargetBaseInfluence",M),f.getUniforms().setValue(i,"morphTargetInfluences",r)}}return{update:l}}function gP(i,e,t,n){let r=new WeakMap;function s(l){const h=n.render.frame,d=l.geometry,f=e.get(l,d);if(r.get(f)!==h&&(e.update(f),r.set(f,h)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.get(l)!==h&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,h))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==h&&(p.update(),r.set(p,h))}return f}function a(){r=new WeakMap}function o(l){const h=l.target;h.removeEventListener("dispose",o),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:a}}class ix extends wn{constructor(e,t,n,r,s,a,o,l,h,d){if(d=d!==void 0?d:Wr,d!==Wr&&d!==ca)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&d===Wr&&(n=Qi),n===void 0&&d===ca&&(n=Gr),super(null,r,s,a,o,l,d,n,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:gn,this.minFilter=l!==void 0?l:gn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const rx=new wn,sx=new ix(1,1);sx.compareFunction=jv;const ax=new Gv,ox=new QR,lx=new Zv,dg=[],fg=[],pg=new Float32Array(16),mg=new Float32Array(9),gg=new Float32Array(4);function ba(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=dg[r];if(s===void 0&&(s=new Float32Array(r),dg[r]=s),e!==0){n.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,i[a].toArray(s,o)}return s}function Yt(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Kt(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Rc(i,e){let t=fg[e];t===void 0&&(t=new Int32Array(e),fg[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function _P(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function vP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yt(t,e))return;i.uniform2fv(this.addr,e),Kt(t,e)}}function xP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Yt(t,e))return;i.uniform3fv(this.addr,e),Kt(t,e)}}function yP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yt(t,e))return;i.uniform4fv(this.addr,e),Kt(t,e)}}function bP(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Yt(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Kt(t,e)}else{if(Yt(t,n))return;gg.set(n),i.uniformMatrix2fv(this.addr,!1,gg),Kt(t,n)}}function EP(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Yt(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Kt(t,e)}else{if(Yt(t,n))return;mg.set(n),i.uniformMatrix3fv(this.addr,!1,mg),Kt(t,n)}}function wP(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Yt(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Kt(t,e)}else{if(Yt(t,n))return;pg.set(n),i.uniformMatrix4fv(this.addr,!1,pg),Kt(t,n)}}function SP(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function TP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yt(t,e))return;i.uniform2iv(this.addr,e),Kt(t,e)}}function AP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Yt(t,e))return;i.uniform3iv(this.addr,e),Kt(t,e)}}function MP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yt(t,e))return;i.uniform4iv(this.addr,e),Kt(t,e)}}function RP(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function CP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yt(t,e))return;i.uniform2uiv(this.addr,e),Kt(t,e)}}function IP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Yt(t,e))return;i.uniform3uiv(this.addr,e),Kt(t,e)}}function PP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yt(t,e))return;i.uniform4uiv(this.addr,e),Kt(t,e)}}function NP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);const s=this.type===i.SAMPLER_2D_SHADOW?sx:rx;t.setTexture2D(e||s,r)}function LP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||ox,r)}function DP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||lx,r)}function OP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||ax,r)}function kP(i){switch(i){case 5126:return _P;case 35664:return vP;case 35665:return xP;case 35666:return yP;case 35674:return bP;case 35675:return EP;case 35676:return wP;case 5124:case 35670:return SP;case 35667:case 35671:return TP;case 35668:case 35672:return AP;case 35669:case 35673:return MP;case 5125:return RP;case 36294:return CP;case 36295:return IP;case 36296:return PP;case 35678:case 36198:case 36298:case 36306:case 35682:return NP;case 35679:case 36299:case 36307:return LP;case 35680:case 36300:case 36308:case 36293:return DP;case 36289:case 36303:case 36311:case 36292:return OP}}function UP(i,e){i.uniform1fv(this.addr,e)}function FP(i,e){const t=ba(e,this.size,2);i.uniform2fv(this.addr,t)}function VP(i,e){const t=ba(e,this.size,3);i.uniform3fv(this.addr,t)}function jP(i,e){const t=ba(e,this.size,4);i.uniform4fv(this.addr,t)}function BP(i,e){const t=ba(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function zP(i,e){const t=ba(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function HP(i,e){const t=ba(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function GP(i,e){i.uniform1iv(this.addr,e)}function WP(i,e){i.uniform2iv(this.addr,e)}function qP(i,e){i.uniform3iv(this.addr,e)}function XP(i,e){i.uniform4iv(this.addr,e)}function $P(i,e){i.uniform1uiv(this.addr,e)}function YP(i,e){i.uniform2uiv(this.addr,e)}function KP(i,e){i.uniform3uiv(this.addr,e)}function JP(i,e){i.uniform4uiv(this.addr,e)}function QP(i,e,t){const n=this.cache,r=e.length,s=Rc(t,r);Yt(n,s)||(i.uniform1iv(this.addr,s),Kt(n,s));for(let a=0;a!==r;++a)t.setTexture2D(e[a]||rx,s[a])}function ZP(i,e,t){const n=this.cache,r=e.length,s=Rc(t,r);Yt(n,s)||(i.uniform1iv(this.addr,s),Kt(n,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||ox,s[a])}function eN(i,e,t){const n=this.cache,r=e.length,s=Rc(t,r);Yt(n,s)||(i.uniform1iv(this.addr,s),Kt(n,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||lx,s[a])}function tN(i,e,t){const n=this.cache,r=e.length,s=Rc(t,r);Yt(n,s)||(i.uniform1iv(this.addr,s),Kt(n,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||ax,s[a])}function nN(i){switch(i){case 5126:return UP;case 35664:return FP;case 35665:return VP;case 35666:return jP;case 35674:return BP;case 35675:return zP;case 35676:return HP;case 5124:case 35670:return GP;case 35667:case 35671:return WP;case 35668:case 35672:return qP;case 35669:case 35673:return XP;case 5125:return $P;case 36294:return YP;case 36295:return KP;case 36296:return JP;case 35678:case 36198:case 36298:case 36306:case 35682:return QP;case 35679:case 36299:case 36307:return ZP;case 35680:case 36300:case 36308:case 36293:return eN;case 36289:case 36303:case 36311:case 36292:return tN}}class iN{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=kP(t.type)}}class rN{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=nN(t.type)}}class sN{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,t[o.id],n)}}}const Ru=/(\w+)(\])?(\[|\.)?/g;function _g(i,e){i.seq.push(e),i.map[e.id]=e}function aN(i,e,t){const n=i.name,r=n.length;for(Ru.lastIndex=0;;){const s=Ru.exec(n),a=Ru.lastIndex;let o=s[1];const l=s[2]==="]",h=s[3];if(l&&(o=o|0),h===void 0||h==="["&&a+2===r){_g(t,h===void 0?new iN(o,i,e):new rN(o,i,e));break}else{let f=t.map[o];f===void 0&&(f=new sN(o),_g(t,f)),t=f}}}class Ml{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r),a=e.getUniformLocation(t,s.name);aN(s,a,this)}}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=n[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function vg(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const oN=37297;let lN=0;function cN(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const o=a+1;n.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return n.join(`
`)}function uN(i){const e=St.getPrimaries(St.workingColorSpace),t=St.getPrimaries(i);let n;switch(e===t?n="":e===Zl&&t===Ql?n="LinearDisplayP3ToLinearSRGB":e===Ql&&t===Zl&&(n="LinearSRGBToLinearDisplayP3"),i){case Er:case Tc:return[n,"LinearTransferOETF"];case Gn:case Id:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),[n,"LinearTransferOETF"]}}function xg(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+cN(i.getShaderSource(e),a)}else return r}function hN(i,e){const t=uN(e);return`vec4 ${i}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function dN(i,e){let t;switch(e){case vR:t="Linear";break;case xR:t="Reinhard";break;case yR:t="OptimizedCineon";break;case bR:t="ACESFilmic";break;case wR:t="AgX";break;case SR:t="Neutral";break;case ER:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function fN(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||i.alphaToCoverage||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Gs).join(`
`)}function pN(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Gs).join(`
`)}function mN(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function gN(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),a=s.name;let o=1;s.type===i.FLOAT_MAT2&&(o=2),s.type===i.FLOAT_MAT3&&(o=3),s.type===i.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:i.getAttribLocation(e,a),locationSize:o}}return t}function Gs(i){return i!==""}function yg(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function bg(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const _N=/^[ \t]*#include +<([\w\d./]+)>/gm;function Eh(i){return i.replace(_N,xN)}const vN=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function xN(i,e){let t=at[e];if(t===void 0){const n=vN.get(e);if(n!==void 0)t=at[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Eh(t)}const yN=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Eg(i){return i.replace(yN,bN)}function bN(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function wg(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	`;return i.isWebGL2&&(e+=`precision ${i.precision} sampler3D;
		precision ${i.precision} sampler2DArray;
		precision ${i.precision} sampler2DShadow;
		precision ${i.precision} samplerCubeShadow;
		precision ${i.precision} sampler2DArrayShadow;
		precision ${i.precision} isampler2D;
		precision ${i.precision} isampler3D;
		precision ${i.precision} isamplerCube;
		precision ${i.precision} isampler2DArray;
		precision ${i.precision} usampler2D;
		precision ${i.precision} usampler3D;
		precision ${i.precision} usamplerCube;
		precision ${i.precision} usampler2DArray;
		`),i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function EN(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===Rd?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===q1?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===bi&&(e="SHADOWMAP_TYPE_VSM"),e}function wN(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case oa:case la:e="ENVMAP_TYPE_CUBE";break;case Sc:e="ENVMAP_TYPE_CUBE_UV";break}return e}function SN(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case la:e="ENVMAP_MODE_REFRACTION";break}return e}function TN(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Pv:e="ENVMAP_BLENDING_MULTIPLY";break;case gR:e="ENVMAP_BLENDING_MIX";break;case _R:e="ENVMAP_BLENDING_ADD";break}return e}function AN(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function MN(i,e,t,n){const r=i.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=EN(t),h=wN(t),d=SN(t),f=TN(t),p=AN(t),g=t.isWebGL2?"":fN(t),y=pN(t),T=mN(s),m=r.createProgram();let v,M,S=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(Gs).join(`
`),v.length>0&&(v+=`
`),M=[g,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(Gs).join(`
`),M.length>0&&(M+=`
`)):(v=[wg(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Gs).join(`
`),M=[g,wg(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==or?"#define TONE_MAPPING":"",t.toneMapping!==or?at.tonemapping_pars_fragment:"",t.toneMapping!==or?dN("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",at.colorspace_pars_fragment,hN("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Gs).join(`
`)),a=Eh(a),a=yg(a,t),a=bg(a,t),o=Eh(o),o=yg(o,t),o=bg(o,t),a=Eg(a),o=Eg(o),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,v=[y,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,M=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===Vm?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Vm?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+M);const L=S+v+a,V=S+M+o,k=vg(r,r.VERTEX_SHADER,L),w=vg(r,r.FRAGMENT_SHADER,V);r.attachShader(m,k),r.attachShader(m,w),t.index0AttributeName!==void 0?r.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m);function A(O){if(i.debug.checkShaderErrors){const I=r.getProgramInfoLog(m).trim(),j=r.getShaderInfoLog(k).trim(),te=r.getShaderInfoLog(w).trim();let Z=!0,ne=!0;if(r.getProgramParameter(m,r.LINK_STATUS)===!1)if(Z=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,m,k,w);else{const ee=xg(r,k,"vertex"),ie=xg(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+`

Material Name: `+O.name+`
Material Type: `+O.type+`

Program Info Log: `+I+`
`+ee+`
`+ie)}else I!==""?console.warn("THREE.WebGLProgram: Program Info Log:",I):(j===""||te==="")&&(ne=!1);ne&&(O.diagnostics={runnable:Z,programLog:I,vertexShader:{log:j,prefix:v},fragmentShader:{log:te,prefix:M}})}r.deleteShader(k),r.deleteShader(w),C=new Ml(r,m),x=gN(r,m)}let C;this.getUniforms=function(){return C===void 0&&A(this),C};let x;this.getAttributes=function(){return x===void 0&&A(this),x};let E=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return E===!1&&(E=r.getProgramParameter(m,oN)),E},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=lN++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=k,this.fragmentShader=w,this}let RN=0;class CN{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new IN(e),t.set(e,n)),n}}class IN{constructor(e){this.id=RN++,this.code=e,this.usedTimes=0}}function PN(i,e,t,n,r,s,a){const o=new qv,l=new CN,h=new Set,d=[],f=r.isWebGL2,p=r.logarithmicDepthBuffer,g=r.vertexTextures;let y=r.precision;const T={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(x){return h.add(x),x===0?"uv":`uv${x}`}function v(x,E,O,I,j){const te=I.fog,Z=j.geometry,ne=x.isMeshStandardMaterial?I.environment:null,ee=(x.isMeshStandardMaterial?t:e).get(x.envMap||ne),ie=ee&&ee.mapping===Sc?ee.image.height:null,pe=T[x.type];x.precision!==null&&(y=r.getMaxPrecision(x.precision),y!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",y,"instead."));const ge=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,be=ge!==void 0?ge.length:0;let Re=0;Z.morphAttributes.position!==void 0&&(Re=1),Z.morphAttributes.normal!==void 0&&(Re=2),Z.morphAttributes.color!==void 0&&(Re=3);let J,ue,Se,je;if(pe){const gt=Qn[pe];J=gt.vertexShader,ue=gt.fragmentShader}else J=x.vertexShader,ue=x.fragmentShader,l.update(x),Se=l.getVertexShaderID(x),je=l.getFragmentShaderID(x);const Oe=i.getRenderTarget(),Te=j.isInstancedMesh===!0,ht=j.isBatchedMesh===!0,Ve=!!x.map,H=!!x.matcap,Nt=!!ee,De=!!x.aoMap,$e=!!x.lightMap,Ue=!!x.bumpMap,ut=!!x.normalMap,Qe=!!x.displacementMap,Ze=!!x.emissiveMap,xt=!!x.metalnessMap,D=!!x.roughnessMap,R=x.anisotropy>0,Q=x.clearcoat>0,re=x.iridescence>0,he=x.sheen>0,se=x.transmission>0,Ce=R&&!!x.anisotropyMap,ke=Q&&!!x.clearcoatMap,me=Q&&!!x.clearcoatNormalMap,xe=Q&&!!x.clearcoatRoughnessMap,Ye=re&&!!x.iridescenceMap,fe=re&&!!x.iridescenceThicknessMap,Mt=he&&!!x.sheenColorMap,nt=he&&!!x.sheenRoughnessMap,Ie=!!x.specularMap,Ae=!!x.specularColorMap,Pe=!!x.specularIntensityMap,U=se&&!!x.transmissionMap,ae=se&&!!x.thicknessMap,Me=!!x.gradientMap,F=!!x.alphaMap,de=x.alphaTest>0,W=!!x.alphaHash,le=!!x.extensions;let ye=or;x.toneMapped&&(Oe===null||Oe.isXRRenderTarget===!0)&&(ye=i.toneMapping);const et={isWebGL2:f,shaderID:pe,shaderType:x.type,shaderName:x.name,vertexShader:J,fragmentShader:ue,defines:x.defines,customVertexShaderID:Se,customFragmentShaderID:je,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:y,batching:ht,instancing:Te,instancingColor:Te&&j.instanceColor!==null,instancingMorph:Te&&j.morphTexture!==null,supportsVertexTextures:g,outputColorSpace:Oe===null?i.outputColorSpace:Oe.isXRRenderTarget===!0?Oe.texture.colorSpace:Er,alphaToCoverage:!!x.alphaToCoverage,map:Ve,matcap:H,envMap:Nt,envMapMode:Nt&&ee.mapping,envMapCubeUVHeight:ie,aoMap:De,lightMap:$e,bumpMap:Ue,normalMap:ut,displacementMap:g&&Qe,emissiveMap:Ze,normalMapObjectSpace:ut&&x.normalMapType===kR,normalMapTangentSpace:ut&&x.normalMapType===OR,metalnessMap:xt,roughnessMap:D,anisotropy:R,anisotropyMap:Ce,clearcoat:Q,clearcoatMap:ke,clearcoatNormalMap:me,clearcoatRoughnessMap:xe,iridescence:re,iridescenceMap:Ye,iridescenceThicknessMap:fe,sheen:he,sheenColorMap:Mt,sheenRoughnessMap:nt,specularMap:Ie,specularColorMap:Ae,specularIntensityMap:Pe,transmission:se,transmissionMap:U,thicknessMap:ae,gradientMap:Me,opaque:x.transparent===!1&&x.blending===Ks&&x.alphaToCoverage===!1,alphaMap:F,alphaTest:de,alphaHash:W,combine:x.combine,mapUv:Ve&&m(x.map.channel),aoMapUv:De&&m(x.aoMap.channel),lightMapUv:$e&&m(x.lightMap.channel),bumpMapUv:Ue&&m(x.bumpMap.channel),normalMapUv:ut&&m(x.normalMap.channel),displacementMapUv:Qe&&m(x.displacementMap.channel),emissiveMapUv:Ze&&m(x.emissiveMap.channel),metalnessMapUv:xt&&m(x.metalnessMap.channel),roughnessMapUv:D&&m(x.roughnessMap.channel),anisotropyMapUv:Ce&&m(x.anisotropyMap.channel),clearcoatMapUv:ke&&m(x.clearcoatMap.channel),clearcoatNormalMapUv:me&&m(x.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:xe&&m(x.clearcoatRoughnessMap.channel),iridescenceMapUv:Ye&&m(x.iridescenceMap.channel),iridescenceThicknessMapUv:fe&&m(x.iridescenceThicknessMap.channel),sheenColorMapUv:Mt&&m(x.sheenColorMap.channel),sheenRoughnessMapUv:nt&&m(x.sheenRoughnessMap.channel),specularMapUv:Ie&&m(x.specularMap.channel),specularColorMapUv:Ae&&m(x.specularColorMap.channel),specularIntensityMapUv:Pe&&m(x.specularIntensityMap.channel),transmissionMapUv:U&&m(x.transmissionMap.channel),thicknessMapUv:ae&&m(x.thicknessMap.channel),alphaMapUv:F&&m(x.alphaMap.channel),vertexTangents:!!Z.attributes.tangent&&(ut||R),vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!Z.attributes.color&&Z.attributes.color.itemSize===4,pointsUvs:j.isPoints===!0&&!!Z.attributes.uv&&(Ve||F),fog:!!te,useFog:x.fog===!0,fogExp2:!!te&&te.isFogExp2,flatShading:x.flatShading===!0,sizeAttenuation:x.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:j.isSkinnedMesh===!0,morphTargets:Z.morphAttributes.position!==void 0,morphNormals:Z.morphAttributes.normal!==void 0,morphColors:Z.morphAttributes.color!==void 0,morphTargetsCount:be,morphTextureStride:Re,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:x.dithering,shadowMapEnabled:i.shadowMap.enabled&&O.length>0,shadowMapType:i.shadowMap.type,toneMapping:ye,useLegacyLights:i._useLegacyLights,decodeVideoTexture:Ve&&x.map.isVideoTexture===!0&&St.getTransfer(x.map.colorSpace)===It,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===wi,flipSided:x.side===En,useDepthPacking:x.depthPacking>=0,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:le&&x.extensions.derivatives===!0,extensionFragDepth:le&&x.extensions.fragDepth===!0,extensionDrawBuffers:le&&x.extensions.drawBuffers===!0,extensionShaderTextureLOD:le&&x.extensions.shaderTextureLOD===!0,extensionClipCullDistance:le&&x.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:le&&x.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionFragDepth:f||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:f||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:f||n.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:x.customProgramCacheKey()};return et.vertexUv1s=h.has(1),et.vertexUv2s=h.has(2),et.vertexUv3s=h.has(3),h.clear(),et}function M(x){const E=[];if(x.shaderID?E.push(x.shaderID):(E.push(x.customVertexShaderID),E.push(x.customFragmentShaderID)),x.defines!==void 0)for(const O in x.defines)E.push(O),E.push(x.defines[O]);return x.isRawShaderMaterial===!1&&(S(E,x),L(E,x),E.push(i.outputColorSpace)),E.push(x.customProgramCacheKey),E.join()}function S(x,E){x.push(E.precision),x.push(E.outputColorSpace),x.push(E.envMapMode),x.push(E.envMapCubeUVHeight),x.push(E.mapUv),x.push(E.alphaMapUv),x.push(E.lightMapUv),x.push(E.aoMapUv),x.push(E.bumpMapUv),x.push(E.normalMapUv),x.push(E.displacementMapUv),x.push(E.emissiveMapUv),x.push(E.metalnessMapUv),x.push(E.roughnessMapUv),x.push(E.anisotropyMapUv),x.push(E.clearcoatMapUv),x.push(E.clearcoatNormalMapUv),x.push(E.clearcoatRoughnessMapUv),x.push(E.iridescenceMapUv),x.push(E.iridescenceThicknessMapUv),x.push(E.sheenColorMapUv),x.push(E.sheenRoughnessMapUv),x.push(E.specularMapUv),x.push(E.specularColorMapUv),x.push(E.specularIntensityMapUv),x.push(E.transmissionMapUv),x.push(E.thicknessMapUv),x.push(E.combine),x.push(E.fogExp2),x.push(E.sizeAttenuation),x.push(E.morphTargetsCount),x.push(E.morphAttributeCount),x.push(E.numDirLights),x.push(E.numPointLights),x.push(E.numSpotLights),x.push(E.numSpotLightMaps),x.push(E.numHemiLights),x.push(E.numRectAreaLights),x.push(E.numDirLightShadows),x.push(E.numPointLightShadows),x.push(E.numSpotLightShadows),x.push(E.numSpotLightShadowsWithMaps),x.push(E.numLightProbes),x.push(E.shadowMapType),x.push(E.toneMapping),x.push(E.numClippingPlanes),x.push(E.numClipIntersection),x.push(E.depthPacking)}function L(x,E){o.disableAll(),E.isWebGL2&&o.enable(0),E.supportsVertexTextures&&o.enable(1),E.instancing&&o.enable(2),E.instancingColor&&o.enable(3),E.instancingMorph&&o.enable(4),E.matcap&&o.enable(5),E.envMap&&o.enable(6),E.normalMapObjectSpace&&o.enable(7),E.normalMapTangentSpace&&o.enable(8),E.clearcoat&&o.enable(9),E.iridescence&&o.enable(10),E.alphaTest&&o.enable(11),E.vertexColors&&o.enable(12),E.vertexAlphas&&o.enable(13),E.vertexUv1s&&o.enable(14),E.vertexUv2s&&o.enable(15),E.vertexUv3s&&o.enable(16),E.vertexTangents&&o.enable(17),E.anisotropy&&o.enable(18),E.alphaHash&&o.enable(19),E.batching&&o.enable(20),x.push(o.mask),o.disableAll(),E.fog&&o.enable(0),E.useFog&&o.enable(1),E.flatShading&&o.enable(2),E.logarithmicDepthBuffer&&o.enable(3),E.skinning&&o.enable(4),E.morphTargets&&o.enable(5),E.morphNormals&&o.enable(6),E.morphColors&&o.enable(7),E.premultipliedAlpha&&o.enable(8),E.shadowMapEnabled&&o.enable(9),E.useLegacyLights&&o.enable(10),E.doubleSided&&o.enable(11),E.flipSided&&o.enable(12),E.useDepthPacking&&o.enable(13),E.dithering&&o.enable(14),E.transmission&&o.enable(15),E.sheen&&o.enable(16),E.opaque&&o.enable(17),E.pointsUvs&&o.enable(18),E.decodeVideoTexture&&o.enable(19),E.alphaToCoverage&&o.enable(20),x.push(o.mask)}function V(x){const E=T[x.type];let O;if(E){const I=Qn[E];O=h2.clone(I.uniforms)}else O=x.uniforms;return O}function k(x,E){let O;for(let I=0,j=d.length;I<j;I++){const te=d[I];if(te.cacheKey===E){O=te,++O.usedTimes;break}}return O===void 0&&(O=new MN(i,E,x,s),d.push(O)),O}function w(x){if(--x.usedTimes===0){const E=d.indexOf(x);d[E]=d[d.length-1],d.pop(),x.destroy()}}function A(x){l.remove(x)}function C(){l.dispose()}return{getParameters:v,getProgramCacheKey:M,getUniforms:V,acquireProgram:k,releaseProgram:w,releaseShaderCache:A,programs:d,dispose:C}}function NN(){let i=new WeakMap;function e(s){let a=i.get(s);return a===void 0&&(a={},i.set(s,a)),a}function t(s){i.delete(s)}function n(s,a,o){i.get(s)[a]=o}function r(){i=new WeakMap}return{get:e,remove:t,update:n,dispose:r}}function LN(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function Sg(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function Tg(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function a(f,p,g,y,T,m){let v=i[e];return v===void 0?(v={id:f.id,object:f,geometry:p,material:g,groupOrder:y,renderOrder:f.renderOrder,z:T,group:m},i[e]=v):(v.id=f.id,v.object=f,v.geometry=p,v.material=g,v.groupOrder=y,v.renderOrder=f.renderOrder,v.z=T,v.group=m),e++,v}function o(f,p,g,y,T,m){const v=a(f,p,g,y,T,m);g.transmission>0?n.push(v):g.transparent===!0?r.push(v):t.push(v)}function l(f,p,g,y,T,m){const v=a(f,p,g,y,T,m);g.transmission>0?n.unshift(v):g.transparent===!0?r.unshift(v):t.unshift(v)}function h(f,p){t.length>1&&t.sort(f||LN),n.length>1&&n.sort(p||Sg),r.length>1&&r.sort(p||Sg)}function d(){for(let f=e,p=i.length;f<p;f++){const g=i[f];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:o,unshift:l,finish:d,sort:h}}function DN(){let i=new WeakMap;function e(n,r){const s=i.get(n);let a;return s===void 0?(a=new Tg,i.set(n,[a])):r>=s.length?(a=new Tg,s.push(a)):a=s[r],a}function t(){i=new WeakMap}return{get:e,dispose:t}}function ON(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new q,color:new bt};break;case"SpotLight":t={position:new q,direction:new q,color:new bt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new q,color:new bt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new q,skyColor:new bt,groundColor:new bt};break;case"RectAreaLight":t={color:new bt,position:new q,halfWidth:new q,halfHeight:new q};break}return i[e.id]=t,t}}}function kN(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new st};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new st};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new st,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let UN=0;function FN(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function VN(i,e){const t=new ON,n=kN(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new q);const s=new q,a=new $t,o=new $t;function l(d,f){let p=0,g=0,y=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let T=0,m=0,v=0,M=0,S=0,L=0,V=0,k=0,w=0,A=0,C=0;d.sort(FN);const x=f===!0?Math.PI:1;for(let O=0,I=d.length;O<I;O++){const j=d[O],te=j.color,Z=j.intensity,ne=j.distance,ee=j.shadow&&j.shadow.map?j.shadow.map.texture:null;if(j.isAmbientLight)p+=te.r*Z*x,g+=te.g*Z*x,y+=te.b*Z*x;else if(j.isLightProbe){for(let ie=0;ie<9;ie++)r.probe[ie].addScaledVector(j.sh.coefficients[ie],Z);C++}else if(j.isDirectionalLight){const ie=t.get(j);if(ie.color.copy(j.color).multiplyScalar(j.intensity*x),j.castShadow){const pe=j.shadow,ge=n.get(j);ge.shadowBias=pe.bias,ge.shadowNormalBias=pe.normalBias,ge.shadowRadius=pe.radius,ge.shadowMapSize=pe.mapSize,r.directionalShadow[T]=ge,r.directionalShadowMap[T]=ee,r.directionalShadowMatrix[T]=j.shadow.matrix,L++}r.directional[T]=ie,T++}else if(j.isSpotLight){const ie=t.get(j);ie.position.setFromMatrixPosition(j.matrixWorld),ie.color.copy(te).multiplyScalar(Z*x),ie.distance=ne,ie.coneCos=Math.cos(j.angle),ie.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),ie.decay=j.decay,r.spot[v]=ie;const pe=j.shadow;if(j.map&&(r.spotLightMap[w]=j.map,w++,pe.updateMatrices(j),j.castShadow&&A++),r.spotLightMatrix[v]=pe.matrix,j.castShadow){const ge=n.get(j);ge.shadowBias=pe.bias,ge.shadowNormalBias=pe.normalBias,ge.shadowRadius=pe.radius,ge.shadowMapSize=pe.mapSize,r.spotShadow[v]=ge,r.spotShadowMap[v]=ee,k++}v++}else if(j.isRectAreaLight){const ie=t.get(j);ie.color.copy(te).multiplyScalar(Z),ie.halfWidth.set(j.width*.5,0,0),ie.halfHeight.set(0,j.height*.5,0),r.rectArea[M]=ie,M++}else if(j.isPointLight){const ie=t.get(j);if(ie.color.copy(j.color).multiplyScalar(j.intensity*x),ie.distance=j.distance,ie.decay=j.decay,j.castShadow){const pe=j.shadow,ge=n.get(j);ge.shadowBias=pe.bias,ge.shadowNormalBias=pe.normalBias,ge.shadowRadius=pe.radius,ge.shadowMapSize=pe.mapSize,ge.shadowCameraNear=pe.camera.near,ge.shadowCameraFar=pe.camera.far,r.pointShadow[m]=ge,r.pointShadowMap[m]=ee,r.pointShadowMatrix[m]=j.shadow.matrix,V++}r.point[m]=ie,m++}else if(j.isHemisphereLight){const ie=t.get(j);ie.skyColor.copy(j.color).multiplyScalar(Z*x),ie.groundColor.copy(j.groundColor).multiplyScalar(Z*x),r.hemi[S]=ie,S++}}M>0&&(e.isWebGL2?i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ve.LTC_FLOAT_1,r.rectAreaLTC2=ve.LTC_FLOAT_2):(r.rectAreaLTC1=ve.LTC_HALF_1,r.rectAreaLTC2=ve.LTC_HALF_2):i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ve.LTC_FLOAT_1,r.rectAreaLTC2=ve.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=ve.LTC_HALF_1,r.rectAreaLTC2=ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=g,r.ambient[2]=y;const E=r.hash;(E.directionalLength!==T||E.pointLength!==m||E.spotLength!==v||E.rectAreaLength!==M||E.hemiLength!==S||E.numDirectionalShadows!==L||E.numPointShadows!==V||E.numSpotShadows!==k||E.numSpotMaps!==w||E.numLightProbes!==C)&&(r.directional.length=T,r.spot.length=v,r.rectArea.length=M,r.point.length=m,r.hemi.length=S,r.directionalShadow.length=L,r.directionalShadowMap.length=L,r.pointShadow.length=V,r.pointShadowMap.length=V,r.spotShadow.length=k,r.spotShadowMap.length=k,r.directionalShadowMatrix.length=L,r.pointShadowMatrix.length=V,r.spotLightMatrix.length=k+w-A,r.spotLightMap.length=w,r.numSpotLightShadowsWithMaps=A,r.numLightProbes=C,E.directionalLength=T,E.pointLength=m,E.spotLength=v,E.rectAreaLength=M,E.hemiLength=S,E.numDirectionalShadows=L,E.numPointShadows=V,E.numSpotShadows=k,E.numSpotMaps=w,E.numLightProbes=C,r.version=UN++)}function h(d,f){let p=0,g=0,y=0,T=0,m=0;const v=f.matrixWorldInverse;for(let M=0,S=d.length;M<S;M++){const L=d[M];if(L.isDirectionalLight){const V=r.directional[p];V.direction.setFromMatrixPosition(L.matrixWorld),s.setFromMatrixPosition(L.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(v),p++}else if(L.isSpotLight){const V=r.spot[y];V.position.setFromMatrixPosition(L.matrixWorld),V.position.applyMatrix4(v),V.direction.setFromMatrixPosition(L.matrixWorld),s.setFromMatrixPosition(L.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(v),y++}else if(L.isRectAreaLight){const V=r.rectArea[T];V.position.setFromMatrixPosition(L.matrixWorld),V.position.applyMatrix4(v),o.identity(),a.copy(L.matrixWorld),a.premultiply(v),o.extractRotation(a),V.halfWidth.set(L.width*.5,0,0),V.halfHeight.set(0,L.height*.5,0),V.halfWidth.applyMatrix4(o),V.halfHeight.applyMatrix4(o),T++}else if(L.isPointLight){const V=r.point[g];V.position.setFromMatrixPosition(L.matrixWorld),V.position.applyMatrix4(v),g++}else if(L.isHemisphereLight){const V=r.hemi[m];V.direction.setFromMatrixPosition(L.matrixWorld),V.direction.transformDirection(v),m++}}}return{setup:l,setupView:h,state:r}}function Ag(i,e){const t=new VN(i,e),n=[],r=[];function s(){n.length=0,r.length=0}function a(f){n.push(f)}function o(f){r.push(f)}function l(f){t.setup(n,f)}function h(f){t.setupView(n,f)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:l,setupLightsView:h,pushLight:a,pushShadow:o}}function jN(i,e){let t=new WeakMap;function n(s,a=0){const o=t.get(s);let l;return o===void 0?(l=new Ag(i,e),t.set(s,[l])):a>=o.length?(l=new Ag(i,e),o.push(l)):l=o[a],l}function r(){t=new WeakMap}return{get:n,dispose:r}}class BN extends Ac{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=LR,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class zN extends Ac{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const HN=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,GN=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WN(i,e,t){let n=new ex;const r=new st,s=new st,a=new rn,o=new BN({depthPacking:DR}),l=new zN,h={},d=t.maxTextureSize,f={[gr]:En,[En]:gr,[wi]:wi},p=new _r({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new st},radius:{value:4}},vertexShader:HN,fragmentShader:GN}),g=p.clone();g.defines.HORIZONTAL_PASS=1;const y=new ls;y.setAttribute("position",new oi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new Ri(y,p),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Rd;let v=this.type;this.render=function(k,w,A){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||k.length===0)return;const C=i.getRenderTarget(),x=i.getActiveCubeFace(),E=i.getActiveMipmapLevel(),O=i.state;O.setBlending(ar),O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);const I=v!==bi&&this.type===bi,j=v===bi&&this.type!==bi;for(let te=0,Z=k.length;te<Z;te++){const ne=k[te],ee=ne.shadow;if(ee===void 0){console.warn("THREE.WebGLShadowMap:",ne,"has no shadow.");continue}if(ee.autoUpdate===!1&&ee.needsUpdate===!1)continue;r.copy(ee.mapSize);const ie=ee.getFrameExtents();if(r.multiply(ie),s.copy(ee.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/ie.x),r.x=s.x*ie.x,ee.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/ie.y),r.y=s.y*ie.y,ee.mapSize.y=s.y)),ee.map===null||I===!0||j===!0){const ge=this.type!==bi?{minFilter:gn,magFilter:gn}:{};ee.map!==null&&ee.map.dispose(),ee.map=new es(r.x,r.y,ge),ee.map.texture.name=ne.name+".shadowMap",ee.camera.updateProjectionMatrix()}i.setRenderTarget(ee.map),i.clear();const pe=ee.getViewportCount();for(let ge=0;ge<pe;ge++){const be=ee.getViewport(ge);a.set(s.x*be.x,s.y*be.y,s.x*be.z,s.y*be.w),O.viewport(a),ee.updateMatrices(ne,ge),n=ee.getFrustum(),L(w,A,ee.camera,ne,this.type)}ee.isPointLightShadow!==!0&&this.type===bi&&M(ee,A),ee.needsUpdate=!1}v=this.type,m.needsUpdate=!1,i.setRenderTarget(C,x,E)};function M(k,w){const A=e.update(T);p.defines.VSM_SAMPLES!==k.blurSamples&&(p.defines.VSM_SAMPLES=k.blurSamples,g.defines.VSM_SAMPLES=k.blurSamples,p.needsUpdate=!0,g.needsUpdate=!0),k.mapPass===null&&(k.mapPass=new es(r.x,r.y)),p.uniforms.shadow_pass.value=k.map.texture,p.uniforms.resolution.value=k.mapSize,p.uniforms.radius.value=k.radius,i.setRenderTarget(k.mapPass),i.clear(),i.renderBufferDirect(w,null,A,p,T,null),g.uniforms.shadow_pass.value=k.mapPass.texture,g.uniforms.resolution.value=k.mapSize,g.uniforms.radius.value=k.radius,i.setRenderTarget(k.map),i.clear(),i.renderBufferDirect(w,null,A,g,T,null)}function S(k,w,A,C){let x=null;const E=A.isPointLight===!0?k.customDistanceMaterial:k.customDepthMaterial;if(E!==void 0)x=E;else if(x=A.isPointLight===!0?l:o,i.localClippingEnabled&&w.clipShadows===!0&&Array.isArray(w.clippingPlanes)&&w.clippingPlanes.length!==0||w.displacementMap&&w.displacementScale!==0||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){const O=x.uuid,I=w.uuid;let j=h[O];j===void 0&&(j={},h[O]=j);let te=j[I];te===void 0&&(te=x.clone(),j[I]=te,w.addEventListener("dispose",V)),x=te}if(x.visible=w.visible,x.wireframe=w.wireframe,C===bi?x.side=w.shadowSide!==null?w.shadowSide:w.side:x.side=w.shadowSide!==null?w.shadowSide:f[w.side],x.alphaMap=w.alphaMap,x.alphaTest=w.alphaTest,x.map=w.map,x.clipShadows=w.clipShadows,x.clippingPlanes=w.clippingPlanes,x.clipIntersection=w.clipIntersection,x.displacementMap=w.displacementMap,x.displacementScale=w.displacementScale,x.displacementBias=w.displacementBias,x.wireframeLinewidth=w.wireframeLinewidth,x.linewidth=w.linewidth,A.isPointLight===!0&&x.isMeshDistanceMaterial===!0){const O=i.properties.get(x);O.light=A}return x}function L(k,w,A,C,x){if(k.visible===!1)return;if(k.layers.test(w.layers)&&(k.isMesh||k.isLine||k.isPoints)&&(k.castShadow||k.receiveShadow&&x===bi)&&(!k.frustumCulled||n.intersectsObject(k))){k.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,k.matrixWorld);const I=e.update(k),j=k.material;if(Array.isArray(j)){const te=I.groups;for(let Z=0,ne=te.length;Z<ne;Z++){const ee=te[Z],ie=j[ee.materialIndex];if(ie&&ie.visible){const pe=S(k,ie,C,x);k.onBeforeShadow(i,k,w,A,I,pe,ee),i.renderBufferDirect(A,null,I,pe,k,ee),k.onAfterShadow(i,k,w,A,I,pe,ee)}}}else if(j.visible){const te=S(k,j,C,x);k.onBeforeShadow(i,k,w,A,I,te,null),i.renderBufferDirect(A,null,I,te,k,null),k.onAfterShadow(i,k,w,A,I,te,null)}}const O=k.children;for(let I=0,j=O.length;I<j;I++)L(O[I],w,A,C,x)}function V(k){k.target.removeEventListener("dispose",V);for(const A in h){const C=h[A],x=k.target.uuid;x in C&&(C[x].dispose(),delete C[x])}}}function qN(i,e,t){const n=t.isWebGL2;function r(){let F=!1;const de=new rn;let W=null;const le=new rn(0,0,0,0);return{setMask:function(ye){W!==ye&&!F&&(i.colorMask(ye,ye,ye,ye),W=ye)},setLocked:function(ye){F=ye},setClear:function(ye,et,gt,mt,Rt){Rt===!0&&(ye*=mt,et*=mt,gt*=mt),de.set(ye,et,gt,mt),le.equals(de)===!1&&(i.clearColor(ye,et,gt,mt),le.copy(de))},reset:function(){F=!1,W=null,le.set(-1,0,0,0)}}}function s(){let F=!1,de=null,W=null,le=null;return{setTest:function(ye){ye?Te(i.DEPTH_TEST):ht(i.DEPTH_TEST)},setMask:function(ye){de!==ye&&!F&&(i.depthMask(ye),de=ye)},setFunc:function(ye){if(W!==ye){switch(ye){case cR:i.depthFunc(i.NEVER);break;case uR:i.depthFunc(i.ALWAYS);break;case hR:i.depthFunc(i.LESS);break;case Kl:i.depthFunc(i.LEQUAL);break;case dR:i.depthFunc(i.EQUAL);break;case fR:i.depthFunc(i.GEQUAL);break;case pR:i.depthFunc(i.GREATER);break;case mR:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}W=ye}},setLocked:function(ye){F=ye},setClear:function(ye){le!==ye&&(i.clearDepth(ye),le=ye)},reset:function(){F=!1,de=null,W=null,le=null}}}function a(){let F=!1,de=null,W=null,le=null,ye=null,et=null,gt=null,mt=null,Rt=null;return{setTest:function(We){F||(We?Te(i.STENCIL_TEST):ht(i.STENCIL_TEST))},setMask:function(We){de!==We&&!F&&(i.stencilMask(We),de=We)},setFunc:function(We,Et,Ot){(W!==We||le!==Et||ye!==Ot)&&(i.stencilFunc(We,Et,Ot),W=We,le=Et,ye=Ot)},setOp:function(We,Et,Ot){(et!==We||gt!==Et||mt!==Ot)&&(i.stencilOp(We,Et,Ot),et=We,gt=Et,mt=Ot)},setLocked:function(We){F=We},setClear:function(We){Rt!==We&&(i.clearStencil(We),Rt=We)},reset:function(){F=!1,de=null,W=null,le=null,ye=null,et=null,gt=null,mt=null,Rt=null}}}const o=new r,l=new s,h=new a,d=new WeakMap,f=new WeakMap;let p={},g={},y=new WeakMap,T=[],m=null,v=!1,M=null,S=null,L=null,V=null,k=null,w=null,A=null,C=new bt(0,0,0),x=0,E=!1,O=null,I=null,j=null,te=null,Z=null;const ne=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ee=!1,ie=0;const pe=i.getParameter(i.VERSION);pe.indexOf("WebGL")!==-1?(ie=parseFloat(/^WebGL (\d)/.exec(pe)[1]),ee=ie>=1):pe.indexOf("OpenGL ES")!==-1&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(pe)[1]),ee=ie>=2);let ge=null,be={};const Re=i.getParameter(i.SCISSOR_BOX),J=i.getParameter(i.VIEWPORT),ue=new rn().fromArray(Re),Se=new rn().fromArray(J);function je(F,de,W,le){const ye=new Uint8Array(4),et=i.createTexture();i.bindTexture(F,et),i.texParameteri(F,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(F,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let gt=0;gt<W;gt++)n&&(F===i.TEXTURE_3D||F===i.TEXTURE_2D_ARRAY)?i.texImage3D(de,0,i.RGBA,1,1,le,0,i.RGBA,i.UNSIGNED_BYTE,ye):i.texImage2D(de+gt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,ye);return et}const Oe={};Oe[i.TEXTURE_2D]=je(i.TEXTURE_2D,i.TEXTURE_2D,1),Oe[i.TEXTURE_CUBE_MAP]=je(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(Oe[i.TEXTURE_2D_ARRAY]=je(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Oe[i.TEXTURE_3D]=je(i.TEXTURE_3D,i.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),l.setClear(1),h.setClear(0),Te(i.DEPTH_TEST),l.setFunc(Kl),Qe(!1),Ze(sm),Te(i.CULL_FACE),Ue(ar);function Te(F){p[F]!==!0&&(i.enable(F),p[F]=!0)}function ht(F){p[F]!==!1&&(i.disable(F),p[F]=!1)}function Ve(F,de){return g[F]!==de?(i.bindFramebuffer(F,de),g[F]=de,n&&(F===i.DRAW_FRAMEBUFFER&&(g[i.FRAMEBUFFER]=de),F===i.FRAMEBUFFER&&(g[i.DRAW_FRAMEBUFFER]=de)),!0):!1}function H(F,de){let W=T,le=!1;if(F){W=y.get(de),W===void 0&&(W=[],y.set(de,W));const ye=F.textures;if(W.length!==ye.length||W[0]!==i.COLOR_ATTACHMENT0){for(let et=0,gt=ye.length;et<gt;et++)W[et]=i.COLOR_ATTACHMENT0+et;W.length=ye.length,le=!0}}else W[0]!==i.BACK&&(W[0]=i.BACK,le=!0);if(le)if(t.isWebGL2)i.drawBuffers(W);else if(e.has("WEBGL_draw_buffers")===!0)e.get("WEBGL_draw_buffers").drawBuffersWEBGL(W);else throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension")}function Nt(F){return m!==F?(i.useProgram(F),m=F,!0):!1}const De={[kr]:i.FUNC_ADD,[$1]:i.FUNC_SUBTRACT,[Y1]:i.FUNC_REVERSE_SUBTRACT};if(n)De[cm]=i.MIN,De[um]=i.MAX;else{const F=e.get("EXT_blend_minmax");F!==null&&(De[cm]=F.MIN_EXT,De[um]=F.MAX_EXT)}const $e={[K1]:i.ZERO,[J1]:i.ONE,[Q1]:i.SRC_COLOR,[fh]:i.SRC_ALPHA,[rR]:i.SRC_ALPHA_SATURATE,[nR]:i.DST_COLOR,[eR]:i.DST_ALPHA,[Z1]:i.ONE_MINUS_SRC_COLOR,[ph]:i.ONE_MINUS_SRC_ALPHA,[iR]:i.ONE_MINUS_DST_COLOR,[tR]:i.ONE_MINUS_DST_ALPHA,[sR]:i.CONSTANT_COLOR,[aR]:i.ONE_MINUS_CONSTANT_COLOR,[oR]:i.CONSTANT_ALPHA,[lR]:i.ONE_MINUS_CONSTANT_ALPHA};function Ue(F,de,W,le,ye,et,gt,mt,Rt,We){if(F===ar){v===!0&&(ht(i.BLEND),v=!1);return}if(v===!1&&(Te(i.BLEND),v=!0),F!==X1){if(F!==M||We!==E){if((S!==kr||k!==kr)&&(i.blendEquation(i.FUNC_ADD),S=kr,k=kr),We)switch(F){case Ks:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case am:i.blendFunc(i.ONE,i.ONE);break;case om:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case lm:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",F);break}else switch(F){case Ks:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case am:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case om:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case lm:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",F);break}L=null,V=null,w=null,A=null,C.set(0,0,0),x=0,M=F,E=We}return}ye=ye||de,et=et||W,gt=gt||le,(de!==S||ye!==k)&&(i.blendEquationSeparate(De[de],De[ye]),S=de,k=ye),(W!==L||le!==V||et!==w||gt!==A)&&(i.blendFuncSeparate($e[W],$e[le],$e[et],$e[gt]),L=W,V=le,w=et,A=gt),(mt.equals(C)===!1||Rt!==x)&&(i.blendColor(mt.r,mt.g,mt.b,Rt),C.copy(mt),x=Rt),M=F,E=!1}function ut(F,de){F.side===wi?ht(i.CULL_FACE):Te(i.CULL_FACE);let W=F.side===En;de&&(W=!W),Qe(W),F.blending===Ks&&F.transparent===!1?Ue(ar):Ue(F.blending,F.blendEquation,F.blendSrc,F.blendDst,F.blendEquationAlpha,F.blendSrcAlpha,F.blendDstAlpha,F.blendColor,F.blendAlpha,F.premultipliedAlpha),l.setFunc(F.depthFunc),l.setTest(F.depthTest),l.setMask(F.depthWrite),o.setMask(F.colorWrite);const le=F.stencilWrite;h.setTest(le),le&&(h.setMask(F.stencilWriteMask),h.setFunc(F.stencilFunc,F.stencilRef,F.stencilFuncMask),h.setOp(F.stencilFail,F.stencilZFail,F.stencilZPass)),D(F.polygonOffset,F.polygonOffsetFactor,F.polygonOffsetUnits),F.alphaToCoverage===!0?Te(i.SAMPLE_ALPHA_TO_COVERAGE):ht(i.SAMPLE_ALPHA_TO_COVERAGE)}function Qe(F){O!==F&&(F?i.frontFace(i.CW):i.frontFace(i.CCW),O=F)}function Ze(F){F!==G1?(Te(i.CULL_FACE),F!==I&&(F===sm?i.cullFace(i.BACK):F===W1?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):ht(i.CULL_FACE),I=F}function xt(F){F!==j&&(ee&&i.lineWidth(F),j=F)}function D(F,de,W){F?(Te(i.POLYGON_OFFSET_FILL),(te!==de||Z!==W)&&(i.polygonOffset(de,W),te=de,Z=W)):ht(i.POLYGON_OFFSET_FILL)}function R(F){F?Te(i.SCISSOR_TEST):ht(i.SCISSOR_TEST)}function Q(F){F===void 0&&(F=i.TEXTURE0+ne-1),ge!==F&&(i.activeTexture(F),ge=F)}function re(F,de,W){W===void 0&&(ge===null?W=i.TEXTURE0+ne-1:W=ge);let le=be[W];le===void 0&&(le={type:void 0,texture:void 0},be[W]=le),(le.type!==F||le.texture!==de)&&(ge!==W&&(i.activeTexture(W),ge=W),i.bindTexture(F,de||Oe[F]),le.type=F,le.texture=de)}function he(){const F=be[ge];F!==void 0&&F.type!==void 0&&(i.bindTexture(F.type,null),F.type=void 0,F.texture=void 0)}function se(){try{i.compressedTexImage2D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function Ce(){try{i.compressedTexImage3D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function ke(){try{i.texSubImage2D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function me(){try{i.texSubImage3D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function xe(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function Ye(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function fe(){try{i.texStorage2D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function Mt(){try{i.texStorage3D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function nt(){try{i.texImage2D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function Ie(){try{i.texImage3D.apply(i,arguments)}catch(F){console.error("THREE.WebGLState:",F)}}function Ae(F){ue.equals(F)===!1&&(i.scissor(F.x,F.y,F.z,F.w),ue.copy(F))}function Pe(F){Se.equals(F)===!1&&(i.viewport(F.x,F.y,F.z,F.w),Se.copy(F))}function U(F,de){let W=f.get(de);W===void 0&&(W=new WeakMap,f.set(de,W));let le=W.get(F);le===void 0&&(le=i.getUniformBlockIndex(de,F.name),W.set(F,le))}function ae(F,de){const le=f.get(de).get(F);d.get(de)!==le&&(i.uniformBlockBinding(de,le,F.__bindingPointIndex),d.set(de,le))}function Me(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),n===!0&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),p={},ge=null,be={},g={},y=new WeakMap,T=[],m=null,v=!1,M=null,S=null,L=null,V=null,k=null,w=null,A=null,C=new bt(0,0,0),x=0,E=!1,O=null,I=null,j=null,te=null,Z=null,ue.set(0,0,i.canvas.width,i.canvas.height),Se.set(0,0,i.canvas.width,i.canvas.height),o.reset(),l.reset(),h.reset()}return{buffers:{color:o,depth:l,stencil:h},enable:Te,disable:ht,bindFramebuffer:Ve,drawBuffers:H,useProgram:Nt,setBlending:Ue,setMaterial:ut,setFlipSided:Qe,setCullFace:Ze,setLineWidth:xt,setPolygonOffset:D,setScissorTest:R,activeTexture:Q,bindTexture:re,unbindTexture:he,compressedTexImage2D:se,compressedTexImage3D:Ce,texImage2D:nt,texImage3D:Ie,updateUBOMapping:U,uniformBlockBinding:ae,texStorage2D:fe,texStorage3D:Mt,texSubImage2D:ke,texSubImage3D:me,compressedTexSubImage2D:xe,compressedTexSubImage3D:Ye,scissor:Ae,viewport:Pe,reset:Me}}function XN(i,e,t,n,r,s,a){const o=r.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new st,f=new WeakMap;let p;const g=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(D,R){return y?new OffscreenCanvas(D,R):tc("canvas")}function m(D,R,Q,re){let he=1;const se=xt(D);if((se.width>re||se.height>re)&&(he=re/Math.max(se.width,se.height)),he<1||R===!0)if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap||typeof VideoFrame<"u"&&D instanceof VideoFrame){const Ce=R?bh:Math.floor,ke=Ce(he*se.width),me=Ce(he*se.height);p===void 0&&(p=T(ke,me));const xe=Q?T(ke,me):p;return xe.width=ke,xe.height=me,xe.getContext("2d").drawImage(D,0,0,ke,me),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+se.width+"x"+se.height+") to ("+ke+"x"+me+")."),xe}else return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+se.width+"x"+se.height+")."),D;return D}function v(D){const R=xt(D);return jm(R.width)&&jm(R.height)}function M(D){return o?!1:D.wrapS!==Wn||D.wrapT!==Wn||D.minFilter!==gn&&D.minFilter!==yn}function S(D,R){return D.generateMipmaps&&R&&D.minFilter!==gn&&D.minFilter!==yn}function L(D){i.generateMipmap(D)}function V(D,R,Q,re,he=!1){if(o===!1)return R;if(D!==null){if(i[D]!==void 0)return i[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let se=R;if(R===i.RED&&(Q===i.FLOAT&&(se=i.R32F),Q===i.HALF_FLOAT&&(se=i.R16F),Q===i.UNSIGNED_BYTE&&(se=i.R8)),R===i.RED_INTEGER&&(Q===i.UNSIGNED_BYTE&&(se=i.R8UI),Q===i.UNSIGNED_SHORT&&(se=i.R16UI),Q===i.UNSIGNED_INT&&(se=i.R32UI),Q===i.BYTE&&(se=i.R8I),Q===i.SHORT&&(se=i.R16I),Q===i.INT&&(se=i.R32I)),R===i.RG&&(Q===i.FLOAT&&(se=i.RG32F),Q===i.HALF_FLOAT&&(se=i.RG16F),Q===i.UNSIGNED_BYTE&&(se=i.RG8)),R===i.RG_INTEGER&&(Q===i.UNSIGNED_BYTE&&(se=i.RG8UI),Q===i.UNSIGNED_SHORT&&(se=i.RG16UI),Q===i.UNSIGNED_INT&&(se=i.RG32UI),Q===i.BYTE&&(se=i.RG8I),Q===i.SHORT&&(se=i.RG16I),Q===i.INT&&(se=i.RG32I)),R===i.RGBA){const Ce=he?Jl:St.getTransfer(re);Q===i.FLOAT&&(se=i.RGBA32F),Q===i.HALF_FLOAT&&(se=i.RGBA16F),Q===i.UNSIGNED_BYTE&&(se=Ce===It?i.SRGB8_ALPHA8:i.RGBA8),Q===i.UNSIGNED_SHORT_4_4_4_4&&(se=i.RGBA4),Q===i.UNSIGNED_SHORT_5_5_5_1&&(se=i.RGB5_A1)}return(se===i.R16F||se===i.R32F||se===i.RG16F||se===i.RG32F||se===i.RGBA16F||se===i.RGBA32F)&&e.get("EXT_color_buffer_float"),se}function k(D,R,Q){return S(D,Q)===!0||D.isFramebufferTexture&&D.minFilter!==gn&&D.minFilter!==yn?Math.log2(Math.max(R.width,R.height))+1:D.mipmaps!==void 0&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?R.mipmaps.length:1}function w(D){return D===gn||D===hm||D===La?i.NEAREST:i.LINEAR}function A(D){const R=D.target;R.removeEventListener("dispose",A),x(R),R.isVideoTexture&&f.delete(R)}function C(D){const R=D.target;R.removeEventListener("dispose",C),O(R)}function x(D){const R=n.get(D);if(R.__webglInit===void 0)return;const Q=D.source,re=g.get(Q);if(re){const he=re[R.__cacheKey];he.usedTimes--,he.usedTimes===0&&E(D),Object.keys(re).length===0&&g.delete(Q)}n.remove(D)}function E(D){const R=n.get(D);i.deleteTexture(R.__webglTexture);const Q=D.source,re=g.get(Q);delete re[R.__cacheKey],a.memory.textures--}function O(D){const R=n.get(D);if(D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let re=0;re<6;re++){if(Array.isArray(R.__webglFramebuffer[re]))for(let he=0;he<R.__webglFramebuffer[re].length;he++)i.deleteFramebuffer(R.__webglFramebuffer[re][he]);else i.deleteFramebuffer(R.__webglFramebuffer[re]);R.__webglDepthbuffer&&i.deleteRenderbuffer(R.__webglDepthbuffer[re])}else{if(Array.isArray(R.__webglFramebuffer))for(let re=0;re<R.__webglFramebuffer.length;re++)i.deleteFramebuffer(R.__webglFramebuffer[re]);else i.deleteFramebuffer(R.__webglFramebuffer);if(R.__webglDepthbuffer&&i.deleteRenderbuffer(R.__webglDepthbuffer),R.__webglMultisampledFramebuffer&&i.deleteFramebuffer(R.__webglMultisampledFramebuffer),R.__webglColorRenderbuffer)for(let re=0;re<R.__webglColorRenderbuffer.length;re++)R.__webglColorRenderbuffer[re]&&i.deleteRenderbuffer(R.__webglColorRenderbuffer[re]);R.__webglDepthRenderbuffer&&i.deleteRenderbuffer(R.__webglDepthRenderbuffer)}const Q=D.textures;for(let re=0,he=Q.length;re<he;re++){const se=n.get(Q[re]);se.__webglTexture&&(i.deleteTexture(se.__webglTexture),a.memory.textures--),n.remove(Q[re])}n.remove(D)}let I=0;function j(){I=0}function te(){const D=I;return D>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+r.maxTextures),I+=1,D}function Z(D){const R=[];return R.push(D.wrapS),R.push(D.wrapT),R.push(D.wrapR||0),R.push(D.magFilter),R.push(D.minFilter),R.push(D.anisotropy),R.push(D.internalFormat),R.push(D.format),R.push(D.type),R.push(D.generateMipmaps),R.push(D.premultiplyAlpha),R.push(D.flipY),R.push(D.unpackAlignment),R.push(D.colorSpace),R.join()}function ne(D,R){const Q=n.get(D);if(D.isVideoTexture&&Qe(D),D.isRenderTargetTexture===!1&&D.version>0&&Q.__version!==D.version){const re=D.image;if(re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Se(Q,D,R);return}}t.bindTexture(i.TEXTURE_2D,Q.__webglTexture,i.TEXTURE0+R)}function ee(D,R){const Q=n.get(D);if(D.version>0&&Q.__version!==D.version){Se(Q,D,R);return}t.bindTexture(i.TEXTURE_2D_ARRAY,Q.__webglTexture,i.TEXTURE0+R)}function ie(D,R){const Q=n.get(D);if(D.version>0&&Q.__version!==D.version){Se(Q,D,R);return}t.bindTexture(i.TEXTURE_3D,Q.__webglTexture,i.TEXTURE0+R)}function pe(D,R){const Q=n.get(D);if(D.version>0&&Q.__version!==D.version){je(Q,D,R);return}t.bindTexture(i.TEXTURE_CUBE_MAP,Q.__webglTexture,i.TEXTURE0+R)}const ge={[_h]:i.REPEAT,[Wn]:i.CLAMP_TO_EDGE,[vh]:i.MIRRORED_REPEAT},be={[gn]:i.NEAREST,[hm]:i.NEAREST_MIPMAP_NEAREST,[La]:i.NEAREST_MIPMAP_LINEAR,[yn]:i.LINEAR,[Qc]:i.LINEAR_MIPMAP_NEAREST,[jr]:i.LINEAR_MIPMAP_LINEAR},Re={[UR]:i.NEVER,[HR]:i.ALWAYS,[FR]:i.LESS,[jv]:i.LEQUAL,[VR]:i.EQUAL,[zR]:i.GEQUAL,[jR]:i.GREATER,[BR]:i.NOTEQUAL};function J(D,R,Q){if(R.type===Si&&e.has("OES_texture_float_linear")===!1&&(R.magFilter===yn||R.magFilter===Qc||R.magFilter===La||R.magFilter===jr||R.minFilter===yn||R.minFilter===Qc||R.minFilter===La||R.minFilter===jr)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),Q?(i.texParameteri(D,i.TEXTURE_WRAP_S,ge[R.wrapS]),i.texParameteri(D,i.TEXTURE_WRAP_T,ge[R.wrapT]),(D===i.TEXTURE_3D||D===i.TEXTURE_2D_ARRAY)&&i.texParameteri(D,i.TEXTURE_WRAP_R,ge[R.wrapR]),i.texParameteri(D,i.TEXTURE_MAG_FILTER,be[R.magFilter]),i.texParameteri(D,i.TEXTURE_MIN_FILTER,be[R.minFilter])):(i.texParameteri(D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(D===i.TEXTURE_3D||D===i.TEXTURE_2D_ARRAY)&&i.texParameteri(D,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(R.wrapS!==Wn||R.wrapT!==Wn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(D,i.TEXTURE_MAG_FILTER,w(R.magFilter)),i.texParameteri(D,i.TEXTURE_MIN_FILTER,w(R.minFilter)),R.minFilter!==gn&&R.minFilter!==yn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),R.compareFunction&&(i.texParameteri(D,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(D,i.TEXTURE_COMPARE_FUNC,Re[R.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(R.magFilter===gn||R.minFilter!==La&&R.minFilter!==jr||R.type===Si&&e.has("OES_texture_float_linear")===!1||o===!1&&R.type===uo&&e.has("OES_texture_half_float_linear")===!1)return;if(R.anisotropy>1||n.get(R).__currentAnisotropy){const re=e.get("EXT_texture_filter_anisotropic");i.texParameterf(D,re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),n.get(R).__currentAnisotropy=R.anisotropy}}}function ue(D,R){let Q=!1;D.__webglInit===void 0&&(D.__webglInit=!0,R.addEventListener("dispose",A));const re=R.source;let he=g.get(re);he===void 0&&(he={},g.set(re,he));const se=Z(R);if(se!==D.__cacheKey){he[se]===void 0&&(he[se]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,Q=!0),he[se].usedTimes++;const Ce=he[D.__cacheKey];Ce!==void 0&&(he[D.__cacheKey].usedTimes--,Ce.usedTimes===0&&E(R)),D.__cacheKey=se,D.__webglTexture=he[se].texture}return Q}function Se(D,R,Q){let re=i.TEXTURE_2D;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(re=i.TEXTURE_2D_ARRAY),R.isData3DTexture&&(re=i.TEXTURE_3D);const he=ue(D,R),se=R.source;t.bindTexture(re,D.__webglTexture,i.TEXTURE0+Q);const Ce=n.get(se);if(se.version!==Ce.__version||he===!0){t.activeTexture(i.TEXTURE0+Q);const ke=St.getPrimaries(St.workingColorSpace),me=R.colorSpace===Yi?null:St.getPrimaries(R.colorSpace),xe=R.colorSpace===Yi||ke===me?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,R.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,R.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,xe);const Ye=M(R)&&v(R.image)===!1;let fe=m(R.image,Ye,!1,r.maxTextureSize);fe=Ze(R,fe);const Mt=v(fe)||o,nt=s.convert(R.format,R.colorSpace);let Ie=s.convert(R.type),Ae=V(R.internalFormat,nt,Ie,R.colorSpace,R.isVideoTexture);J(re,R,Mt);let Pe;const U=R.mipmaps,ae=o&&R.isVideoTexture!==!0&&Ae!==Vv,Me=Ce.__version===void 0||he===!0,F=se.dataReady,de=k(R,fe,Mt);if(R.isDepthTexture)Ae=i.DEPTH_COMPONENT,o?R.type===Si?Ae=i.DEPTH_COMPONENT32F:R.type===Qi?Ae=i.DEPTH_COMPONENT24:R.type===Gr?Ae=i.DEPTH24_STENCIL8:Ae=i.DEPTH_COMPONENT16:R.type===Si&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===Wr&&Ae===i.DEPTH_COMPONENT&&R.type!==Cd&&R.type!==Qi&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=Qi,Ie=s.convert(R.type)),R.format===ca&&Ae===i.DEPTH_COMPONENT&&(Ae=i.DEPTH_STENCIL,R.type!==Gr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=Gr,Ie=s.convert(R.type))),Me&&(ae?t.texStorage2D(i.TEXTURE_2D,1,Ae,fe.width,fe.height):t.texImage2D(i.TEXTURE_2D,0,Ae,fe.width,fe.height,0,nt,Ie,null));else if(R.isDataTexture)if(U.length>0&&Mt){ae&&Me&&t.texStorage2D(i.TEXTURE_2D,de,Ae,U[0].width,U[0].height);for(let W=0,le=U.length;W<le;W++)Pe=U[W],ae?F&&t.texSubImage2D(i.TEXTURE_2D,W,0,0,Pe.width,Pe.height,nt,Ie,Pe.data):t.texImage2D(i.TEXTURE_2D,W,Ae,Pe.width,Pe.height,0,nt,Ie,Pe.data);R.generateMipmaps=!1}else ae?(Me&&t.texStorage2D(i.TEXTURE_2D,de,Ae,fe.width,fe.height),F&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,fe.width,fe.height,nt,Ie,fe.data)):t.texImage2D(i.TEXTURE_2D,0,Ae,fe.width,fe.height,0,nt,Ie,fe.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){ae&&Me&&t.texStorage3D(i.TEXTURE_2D_ARRAY,de,Ae,U[0].width,U[0].height,fe.depth);for(let W=0,le=U.length;W<le;W++)Pe=U[W],R.format!==qn?nt!==null?ae?F&&t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,W,0,0,0,Pe.width,Pe.height,fe.depth,nt,Pe.data,0,0):t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,W,Ae,Pe.width,Pe.height,fe.depth,0,Pe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ae?F&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,W,0,0,0,Pe.width,Pe.height,fe.depth,nt,Ie,Pe.data):t.texImage3D(i.TEXTURE_2D_ARRAY,W,Ae,Pe.width,Pe.height,fe.depth,0,nt,Ie,Pe.data)}else{ae&&Me&&t.texStorage2D(i.TEXTURE_2D,de,Ae,U[0].width,U[0].height);for(let W=0,le=U.length;W<le;W++)Pe=U[W],R.format!==qn?nt!==null?ae?F&&t.compressedTexSubImage2D(i.TEXTURE_2D,W,0,0,Pe.width,Pe.height,nt,Pe.data):t.compressedTexImage2D(i.TEXTURE_2D,W,Ae,Pe.width,Pe.height,0,Pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ae?F&&t.texSubImage2D(i.TEXTURE_2D,W,0,0,Pe.width,Pe.height,nt,Ie,Pe.data):t.texImage2D(i.TEXTURE_2D,W,Ae,Pe.width,Pe.height,0,nt,Ie,Pe.data)}else if(R.isDataArrayTexture)ae?(Me&&t.texStorage3D(i.TEXTURE_2D_ARRAY,de,Ae,fe.width,fe.height,fe.depth),F&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,fe.width,fe.height,fe.depth,nt,Ie,fe.data)):t.texImage3D(i.TEXTURE_2D_ARRAY,0,Ae,fe.width,fe.height,fe.depth,0,nt,Ie,fe.data);else if(R.isData3DTexture)ae?(Me&&t.texStorage3D(i.TEXTURE_3D,de,Ae,fe.width,fe.height,fe.depth),F&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,fe.width,fe.height,fe.depth,nt,Ie,fe.data)):t.texImage3D(i.TEXTURE_3D,0,Ae,fe.width,fe.height,fe.depth,0,nt,Ie,fe.data);else if(R.isFramebufferTexture){if(Me)if(ae)t.texStorage2D(i.TEXTURE_2D,de,Ae,fe.width,fe.height);else{let W=fe.width,le=fe.height;for(let ye=0;ye<de;ye++)t.texImage2D(i.TEXTURE_2D,ye,Ae,W,le,0,nt,Ie,null),W>>=1,le>>=1}}else if(U.length>0&&Mt){if(ae&&Me){const W=xt(U[0]);t.texStorage2D(i.TEXTURE_2D,de,Ae,W.width,W.height)}for(let W=0,le=U.length;W<le;W++)Pe=U[W],ae?F&&t.texSubImage2D(i.TEXTURE_2D,W,0,0,nt,Ie,Pe):t.texImage2D(i.TEXTURE_2D,W,Ae,nt,Ie,Pe);R.generateMipmaps=!1}else if(ae){if(Me){const W=xt(fe);t.texStorage2D(i.TEXTURE_2D,de,Ae,W.width,W.height)}F&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,nt,Ie,fe)}else t.texImage2D(i.TEXTURE_2D,0,Ae,nt,Ie,fe);S(R,Mt)&&L(re),Ce.__version=se.version,R.onUpdate&&R.onUpdate(R)}D.__version=R.version}function je(D,R,Q){if(R.image.length!==6)return;const re=ue(D,R),he=R.source;t.bindTexture(i.TEXTURE_CUBE_MAP,D.__webglTexture,i.TEXTURE0+Q);const se=n.get(he);if(he.version!==se.__version||re===!0){t.activeTexture(i.TEXTURE0+Q);const Ce=St.getPrimaries(St.workingColorSpace),ke=R.colorSpace===Yi?null:St.getPrimaries(R.colorSpace),me=R.colorSpace===Yi||Ce===ke?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,R.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,R.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,me);const xe=R.isCompressedTexture||R.image[0].isCompressedTexture,Ye=R.image[0]&&R.image[0].isDataTexture,fe=[];for(let W=0;W<6;W++)!xe&&!Ye?fe[W]=m(R.image[W],!1,!0,r.maxCubemapSize):fe[W]=Ye?R.image[W].image:R.image[W],fe[W]=Ze(R,fe[W]);const Mt=fe[0],nt=v(Mt)||o,Ie=s.convert(R.format,R.colorSpace),Ae=s.convert(R.type),Pe=V(R.internalFormat,Ie,Ae,R.colorSpace),U=o&&R.isVideoTexture!==!0,ae=se.__version===void 0||re===!0,Me=he.dataReady;let F=k(R,Mt,nt);J(i.TEXTURE_CUBE_MAP,R,nt);let de;if(xe){U&&ae&&t.texStorage2D(i.TEXTURE_CUBE_MAP,F,Pe,Mt.width,Mt.height);for(let W=0;W<6;W++){de=fe[W].mipmaps;for(let le=0;le<de.length;le++){const ye=de[le];R.format!==qn?Ie!==null?U?Me&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le,0,0,ye.width,ye.height,Ie,ye.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le,Pe,ye.width,ye.height,0,ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):U?Me&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le,0,0,ye.width,ye.height,Ie,Ae,ye.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le,Pe,ye.width,ye.height,0,Ie,Ae,ye.data)}}}else{if(de=R.mipmaps,U&&ae){de.length>0&&F++;const W=xt(fe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,F,Pe,W.width,W.height)}for(let W=0;W<6;W++)if(Ye){U?Me&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,0,0,fe[W].width,fe[W].height,Ie,Ae,fe[W].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,Pe,fe[W].width,fe[W].height,0,Ie,Ae,fe[W].data);for(let le=0;le<de.length;le++){const et=de[le].image[W].image;U?Me&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le+1,0,0,et.width,et.height,Ie,Ae,et.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le+1,Pe,et.width,et.height,0,Ie,Ae,et.data)}}else{U?Me&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,0,0,Ie,Ae,fe[W]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,Pe,Ie,Ae,fe[W]);for(let le=0;le<de.length;le++){const ye=de[le];U?Me&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le+1,0,0,Ie,Ae,ye.image[W]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+W,le+1,Pe,Ie,Ae,ye.image[W])}}}S(R,nt)&&L(i.TEXTURE_CUBE_MAP),se.__version=he.version,R.onUpdate&&R.onUpdate(R)}D.__version=R.version}function Oe(D,R,Q,re,he,se){const Ce=s.convert(Q.format,Q.colorSpace),ke=s.convert(Q.type),me=V(Q.internalFormat,Ce,ke,Q.colorSpace);if(!n.get(R).__hasExternalTextures){const Ye=Math.max(1,R.width>>se),fe=Math.max(1,R.height>>se);he===i.TEXTURE_3D||he===i.TEXTURE_2D_ARRAY?t.texImage3D(he,se,me,Ye,fe,R.depth,0,Ce,ke,null):t.texImage2D(he,se,me,Ye,fe,0,Ce,ke,null)}t.bindFramebuffer(i.FRAMEBUFFER,D),ut(R)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,re,he,n.get(Q).__webglTexture,0,Ue(R)):(he===i.TEXTURE_2D||he>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&he<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,re,he,n.get(Q).__webglTexture,se),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Te(D,R,Q){if(i.bindRenderbuffer(i.RENDERBUFFER,D),R.depthBuffer&&!R.stencilBuffer){let re=o===!0?i.DEPTH_COMPONENT24:i.DEPTH_COMPONENT16;if(Q||ut(R)){const he=R.depthTexture;he&&he.isDepthTexture&&(he.type===Si?re=i.DEPTH_COMPONENT32F:he.type===Qi&&(re=i.DEPTH_COMPONENT24));const se=Ue(R);ut(R)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,se,re,R.width,R.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,se,re,R.width,R.height)}else i.renderbufferStorage(i.RENDERBUFFER,re,R.width,R.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,D)}else if(R.depthBuffer&&R.stencilBuffer){const re=Ue(R);Q&&ut(R)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,re,i.DEPTH24_STENCIL8,R.width,R.height):ut(R)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,re,i.DEPTH24_STENCIL8,R.width,R.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,R.width,R.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,D)}else{const re=R.textures;for(let he=0;he<re.length;he++){const se=re[he],Ce=s.convert(se.format,se.colorSpace),ke=s.convert(se.type),me=V(se.internalFormat,Ce,ke,se.colorSpace),xe=Ue(R);Q&&ut(R)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,xe,me,R.width,R.height):ut(R)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,xe,me,R.width,R.height):i.renderbufferStorage(i.RENDERBUFFER,me,R.width,R.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function ht(D,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,D),!(R.depthTexture&&R.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),ne(R.depthTexture,0);const re=n.get(R.depthTexture).__webglTexture,he=Ue(R);if(R.depthTexture.format===Wr)ut(R)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,re,0,he):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,re,0);else if(R.depthTexture.format===ca)ut(R)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,re,0,he):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,re,0);else throw new Error("Unknown depthTexture format")}function Ve(D){const R=n.get(D),Q=D.isWebGLCubeRenderTarget===!0;if(D.depthTexture&&!R.__autoAllocateDepthBuffer){if(Q)throw new Error("target.depthTexture not supported in Cube render targets");ht(R.__webglFramebuffer,D)}else if(Q){R.__webglDepthbuffer=[];for(let re=0;re<6;re++)t.bindFramebuffer(i.FRAMEBUFFER,R.__webglFramebuffer[re]),R.__webglDepthbuffer[re]=i.createRenderbuffer(),Te(R.__webglDepthbuffer[re],D,!1)}else t.bindFramebuffer(i.FRAMEBUFFER,R.__webglFramebuffer),R.__webglDepthbuffer=i.createRenderbuffer(),Te(R.__webglDepthbuffer,D,!1);t.bindFramebuffer(i.FRAMEBUFFER,null)}function H(D,R,Q){const re=n.get(D);R!==void 0&&Oe(re.__webglFramebuffer,D,D.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),Q!==void 0&&Ve(D)}function Nt(D){const R=D.texture,Q=n.get(D),re=n.get(R);D.addEventListener("dispose",C);const he=D.textures,se=D.isWebGLCubeRenderTarget===!0,Ce=he.length>1,ke=v(D)||o;if(Ce||(re.__webglTexture===void 0&&(re.__webglTexture=i.createTexture()),re.__version=R.version,a.memory.textures++),se){Q.__webglFramebuffer=[];for(let me=0;me<6;me++)if(o&&R.mipmaps&&R.mipmaps.length>0){Q.__webglFramebuffer[me]=[];for(let xe=0;xe<R.mipmaps.length;xe++)Q.__webglFramebuffer[me][xe]=i.createFramebuffer()}else Q.__webglFramebuffer[me]=i.createFramebuffer()}else{if(o&&R.mipmaps&&R.mipmaps.length>0){Q.__webglFramebuffer=[];for(let me=0;me<R.mipmaps.length;me++)Q.__webglFramebuffer[me]=i.createFramebuffer()}else Q.__webglFramebuffer=i.createFramebuffer();if(Ce)if(r.drawBuffers)for(let me=0,xe=he.length;me<xe;me++){const Ye=n.get(he[me]);Ye.__webglTexture===void 0&&(Ye.__webglTexture=i.createTexture(),a.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&D.samples>0&&ut(D)===!1){Q.__webglMultisampledFramebuffer=i.createFramebuffer(),Q.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,Q.__webglMultisampledFramebuffer);for(let me=0;me<he.length;me++){const xe=he[me];Q.__webglColorRenderbuffer[me]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Q.__webglColorRenderbuffer[me]);const Ye=s.convert(xe.format,xe.colorSpace),fe=s.convert(xe.type),Mt=V(xe.internalFormat,Ye,fe,xe.colorSpace,D.isXRRenderTarget===!0),nt=Ue(D);i.renderbufferStorageMultisample(i.RENDERBUFFER,nt,Mt,D.width,D.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+me,i.RENDERBUFFER,Q.__webglColorRenderbuffer[me])}i.bindRenderbuffer(i.RENDERBUFFER,null),D.depthBuffer&&(Q.__webglDepthRenderbuffer=i.createRenderbuffer(),Te(Q.__webglDepthRenderbuffer,D,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(se){t.bindTexture(i.TEXTURE_CUBE_MAP,re.__webglTexture),J(i.TEXTURE_CUBE_MAP,R,ke);for(let me=0;me<6;me++)if(o&&R.mipmaps&&R.mipmaps.length>0)for(let xe=0;xe<R.mipmaps.length;xe++)Oe(Q.__webglFramebuffer[me][xe],D,R,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+me,xe);else Oe(Q.__webglFramebuffer[me],D,R,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+me,0);S(R,ke)&&L(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ce){for(let me=0,xe=he.length;me<xe;me++){const Ye=he[me],fe=n.get(Ye);t.bindTexture(i.TEXTURE_2D,fe.__webglTexture),J(i.TEXTURE_2D,Ye,ke),Oe(Q.__webglFramebuffer,D,Ye,i.COLOR_ATTACHMENT0+me,i.TEXTURE_2D,0),S(Ye,ke)&&L(i.TEXTURE_2D)}t.unbindTexture()}else{let me=i.TEXTURE_2D;if((D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(o?me=D.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(me,re.__webglTexture),J(me,R,ke),o&&R.mipmaps&&R.mipmaps.length>0)for(let xe=0;xe<R.mipmaps.length;xe++)Oe(Q.__webglFramebuffer[xe],D,R,i.COLOR_ATTACHMENT0,me,xe);else Oe(Q.__webglFramebuffer,D,R,i.COLOR_ATTACHMENT0,me,0);S(R,ke)&&L(me),t.unbindTexture()}D.depthBuffer&&Ve(D)}function De(D){const R=v(D)||o,Q=D.textures;for(let re=0,he=Q.length;re<he;re++){const se=Q[re];if(S(se,R)){const Ce=D.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,ke=n.get(se).__webglTexture;t.bindTexture(Ce,ke),L(Ce),t.unbindTexture()}}}function $e(D){if(o&&D.samples>0&&ut(D)===!1){const R=D.textures,Q=D.width,re=D.height;let he=i.COLOR_BUFFER_BIT;const se=[],Ce=D.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ke=n.get(D),me=R.length>1;if(me)for(let xe=0;xe<R.length;xe++)t.bindFramebuffer(i.FRAMEBUFFER,ke.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+xe,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,ke.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+xe,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,ke.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ke.__webglFramebuffer);for(let xe=0;xe<R.length;xe++){se.push(i.COLOR_ATTACHMENT0+xe),D.depthBuffer&&se.push(Ce);const Ye=ke.__ignoreDepthValues!==void 0?ke.__ignoreDepthValues:!1;if(Ye===!1&&(D.depthBuffer&&(he|=i.DEPTH_BUFFER_BIT),D.stencilBuffer&&(he|=i.STENCIL_BUFFER_BIT)),me&&i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ke.__webglColorRenderbuffer[xe]),Ye===!0&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[Ce]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[Ce])),me){const fe=n.get(R[xe]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,fe,0)}i.blitFramebuffer(0,0,Q,re,0,0,Q,re,he,i.NEAREST),h&&i.invalidateFramebuffer(i.READ_FRAMEBUFFER,se)}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),me)for(let xe=0;xe<R.length;xe++){t.bindFramebuffer(i.FRAMEBUFFER,ke.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+xe,i.RENDERBUFFER,ke.__webglColorRenderbuffer[xe]);const Ye=n.get(R[xe]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,ke.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+xe,i.TEXTURE_2D,Ye,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ke.__webglMultisampledFramebuffer)}}function Ue(D){return Math.min(r.maxSamples,D.samples)}function ut(D){const R=n.get(D);return o&&D.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&R.__useRenderToTexture!==!1}function Qe(D){const R=a.render.frame;f.get(D)!==R&&(f.set(D,R),D.update())}function Ze(D,R){const Q=D.colorSpace,re=D.format,he=D.type;return D.isCompressedTexture===!0||D.isVideoTexture===!0||D.format===xh||Q!==Er&&Q!==Yi&&(St.getTransfer(Q)===It?o===!1?e.has("EXT_sRGB")===!0&&re===qn?(D.format=xh,D.minFilter=yn,D.generateMipmaps=!1):R=zv.sRGBToLinear(R):(re!==qn||he!==lr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Q)),R}function xt(D){return typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement?(d.width=D.naturalWidth||D.width,d.height=D.naturalHeight||D.height):typeof VideoFrame<"u"&&D instanceof VideoFrame?(d.width=D.displayWidth,d.height=D.displayHeight):(d.width=D.width,d.height=D.height),d}this.allocateTextureUnit=te,this.resetTextureUnits=j,this.setTexture2D=ne,this.setTexture2DArray=ee,this.setTexture3D=ie,this.setTextureCube=pe,this.rebindTextures=H,this.setupRenderTarget=Nt,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=$e,this.setupDepthRenderbuffer=Ve,this.setupFrameBufferTexture=Oe,this.useMultisampledRTT=ut}function $N(i,e,t){const n=t.isWebGL2;function r(s,a=Yi){let o;const l=St.getTransfer(a);if(s===lr)return i.UNSIGNED_BYTE;if(s===Dv)return i.UNSIGNED_SHORT_4_4_4_4;if(s===Ov)return i.UNSIGNED_SHORT_5_5_5_1;if(s===TR)return i.BYTE;if(s===AR)return i.SHORT;if(s===Cd)return i.UNSIGNED_SHORT;if(s===Lv)return i.INT;if(s===Qi)return i.UNSIGNED_INT;if(s===Si)return i.FLOAT;if(s===uo)return n?i.HALF_FLOAT:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===MR)return i.ALPHA;if(s===qn)return i.RGBA;if(s===RR)return i.LUMINANCE;if(s===CR)return i.LUMINANCE_ALPHA;if(s===Wr)return i.DEPTH_COMPONENT;if(s===ca)return i.DEPTH_STENCIL;if(s===xh)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===IR)return i.RED;if(s===kv)return i.RED_INTEGER;if(s===PR)return i.RG;if(s===Uv)return i.RG_INTEGER;if(s===Fv)return i.RGBA_INTEGER;if(s===Zc||s===eu||s===tu||s===nu)if(l===It)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===Zc)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===eu)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===tu)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===nu)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===Zc)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===eu)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===tu)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===nu)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===dm||s===fm||s===pm||s===mm)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===dm)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===fm)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===pm)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===mm)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Vv)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===gm||s===_m)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(s===gm)return l===It?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===_m)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===vm||s===xm||s===ym||s===bm||s===Em||s===wm||s===Sm||s===Tm||s===Am||s===Mm||s===Rm||s===Cm||s===Im||s===Pm)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(s===vm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===xm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===ym)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===bm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===Em)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===wm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Sm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Tm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Am)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Mm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Rm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Cm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Im)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===Pm)return l===It?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===iu||s===Nm||s===Lm)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(s===iu)return l===It?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===Nm)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===Lm)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===NR||s===Dm||s===Om||s===km)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(s===iu)return o.COMPRESSED_RED_RGTC1_EXT;if(s===Dm)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===Om)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===km)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Gr?n?i.UNSIGNED_INT_24_8:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):i[s]!==void 0?i[s]:null}return{convert:r}}class YN extends kn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class pl extends Nn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const KN={type:"move"};class Cu{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new pl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new pl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new pl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,a=null;const o=this._targetRay,l=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){a=!0;for(const T of e.hand.values()){const m=t.getJointPose(T,n),v=this._getHandJoint(h,T);m!==null&&(v.matrix.fromArray(m.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=m.radius),v.visible=m!==null}const d=h.joints["index-finger-tip"],f=h.joints["thumb-tip"],p=d.position.distanceTo(f.position),g=.02,y=.005;h.inputState.pinching&&p>g+y?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&p<=g-y&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(KN)))}return o!==null&&(o.visible=r!==null),l!==null&&(l.visible=s!==null),h!==null&&(h.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new pl;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const JN=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,QN=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class ZN{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new wn,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}render(e,t){if(this.texture!==null){if(this.mesh===null){const n=t.cameras[0].viewport,r=new _r({extensions:{fragDepth:!0},vertexShader:JN,fragmentShader:QN,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Ri(new Mc(20,20),r)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class eL extends os{constructor(e,t){super();const n=this;let r=null,s=1,a=null,o="local-floor",l=1,h=null,d=null,f=null,p=null,g=null,y=null;const T=new ZN,m=t.getContextAttributes();let v=null,M=null;const S=[],L=[],V=new st;let k=null;const w=new kn;w.layers.enable(1),w.viewport=new rn;const A=new kn;A.layers.enable(2),A.viewport=new rn;const C=[w,A],x=new YN;x.layers.enable(1),x.layers.enable(2);let E=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let ue=S[J];return ue===void 0&&(ue=new Cu,S[J]=ue),ue.getTargetRaySpace()},this.getControllerGrip=function(J){let ue=S[J];return ue===void 0&&(ue=new Cu,S[J]=ue),ue.getGripSpace()},this.getHand=function(J){let ue=S[J];return ue===void 0&&(ue=new Cu,S[J]=ue),ue.getHandSpace()};function I(J){const ue=L.indexOf(J.inputSource);if(ue===-1)return;const Se=S[ue];Se!==void 0&&(Se.update(J.inputSource,J.frame,h||a),Se.dispatchEvent({type:J.type,data:J.inputSource}))}function j(){r.removeEventListener("select",I),r.removeEventListener("selectstart",I),r.removeEventListener("selectend",I),r.removeEventListener("squeeze",I),r.removeEventListener("squeezestart",I),r.removeEventListener("squeezeend",I),r.removeEventListener("end",j),r.removeEventListener("inputsourceschange",te);for(let J=0;J<S.length;J++){const ue=L[J];ue!==null&&(L[J]=null,S[J].disconnect(ue))}E=null,O=null,T.reset(),e.setRenderTarget(v),g=null,p=null,f=null,r=null,M=null,Re.stop(),n.isPresenting=!1,e.setPixelRatio(k),e.setSize(V.width,V.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){s=J,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){o=J,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(J){h=J},this.getBaseLayer=function(){return p!==null?p:g},this.getBinding=function(){return f},this.getFrame=function(){return y},this.getSession=function(){return r},this.setSession=async function(J){if(r=J,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",I),r.addEventListener("selectstart",I),r.addEventListener("selectend",I),r.addEventListener("squeeze",I),r.addEventListener("squeezestart",I),r.addEventListener("squeezeend",I),r.addEventListener("end",j),r.addEventListener("inputsourceschange",te),m.xrCompatible!==!0&&await t.makeXRCompatible(),k=e.getPixelRatio(),e.getSize(V),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ue={antialias:r.renderState.layers===void 0?m.antialias:!0,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s};g=new XRWebGLLayer(r,t,ue),r.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),M=new es(g.framebufferWidth,g.framebufferHeight,{format:qn,type:lr,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil})}else{let ue=null,Se=null,je=null;m.depth&&(je=m.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ue=m.stencil?ca:Wr,Se=m.stencil?Gr:Qi);const Oe={colorFormat:t.RGBA8,depthFormat:je,scaleFactor:s};f=new XRWebGLBinding(r,t),p=f.createProjectionLayer(Oe),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),M=new es(p.textureWidth,p.textureHeight,{format:qn,type:lr,depthTexture:new ix(p.textureWidth,p.textureHeight,Se,void 0,void 0,void 0,void 0,void 0,void 0,ue),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0});const Te=e.properties.get(M);Te.__ignoreDepthValues=p.ignoreDepthValues}M.isXRRenderTarget=!0,this.setFoveation(l),h=null,a=await r.requestReferenceSpace(o),Re.setContext(r),Re.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function te(J){for(let ue=0;ue<J.removed.length;ue++){const Se=J.removed[ue],je=L.indexOf(Se);je>=0&&(L[je]=null,S[je].disconnect(Se))}for(let ue=0;ue<J.added.length;ue++){const Se=J.added[ue];let je=L.indexOf(Se);if(je===-1){for(let Te=0;Te<S.length;Te++)if(Te>=L.length){L.push(Se),je=Te;break}else if(L[Te]===null){L[Te]=Se,je=Te;break}if(je===-1)break}const Oe=S[je];Oe&&Oe.connect(Se)}}const Z=new q,ne=new q;function ee(J,ue,Se){Z.setFromMatrixPosition(ue.matrixWorld),ne.setFromMatrixPosition(Se.matrixWorld);const je=Z.distanceTo(ne),Oe=ue.projectionMatrix.elements,Te=Se.projectionMatrix.elements,ht=Oe[14]/(Oe[10]-1),Ve=Oe[14]/(Oe[10]+1),H=(Oe[9]+1)/Oe[5],Nt=(Oe[9]-1)/Oe[5],De=(Oe[8]-1)/Oe[0],$e=(Te[8]+1)/Te[0],Ue=ht*De,ut=ht*$e,Qe=je/(-De+$e),Ze=Qe*-De;ue.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(Ze),J.translateZ(Qe),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert();const xt=ht+Qe,D=Ve+Qe,R=Ue-Ze,Q=ut+(je-Ze),re=H*Ve/D*xt,he=Nt*Ve/D*xt;J.projectionMatrix.makePerspective(R,Q,re,he,xt,D),J.projectionMatrixInverse.copy(J.projectionMatrix).invert()}function ie(J,ue){ue===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(ue.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(r===null)return;T.texture!==null&&(J.near=T.depthNear,J.far=T.depthFar),x.near=A.near=w.near=J.near,x.far=A.far=w.far=J.far,(E!==x.near||O!==x.far)&&(r.updateRenderState({depthNear:x.near,depthFar:x.far}),E=x.near,O=x.far,w.near=E,w.far=O,A.near=E,A.far=O,w.updateProjectionMatrix(),A.updateProjectionMatrix(),J.updateProjectionMatrix());const ue=J.parent,Se=x.cameras;ie(x,ue);for(let je=0;je<Se.length;je++)ie(Se[je],ue);Se.length===2?ee(x,w,A):x.projectionMatrix.copy(w.projectionMatrix),pe(J,x,ue)};function pe(J,ue,Se){Se===null?J.matrix.copy(ue.matrixWorld):(J.matrix.copy(Se.matrixWorld),J.matrix.invert(),J.matrix.multiply(ue.matrixWorld)),J.matrix.decompose(J.position,J.quaternion,J.scale),J.updateMatrixWorld(!0),J.projectionMatrix.copy(ue.projectionMatrix),J.projectionMatrixInverse.copy(ue.projectionMatrixInverse),J.isPerspectiveCamera&&(J.fov=yh*2*Math.atan(1/J.projectionMatrix.elements[5]),J.zoom=1)}this.getCamera=function(){return x},this.getFoveation=function(){if(!(p===null&&g===null))return l},this.setFoveation=function(J){l=J,p!==null&&(p.fixedFoveation=J),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=J)},this.hasDepthSensing=function(){return T.texture!==null};let ge=null;function be(J,ue){if(d=ue.getViewerPose(h||a),y=ue,d!==null){const Se=d.views;g!==null&&(e.setRenderTargetFramebuffer(M,g.framebuffer),e.setRenderTarget(M));let je=!1;Se.length!==x.cameras.length&&(x.cameras.length=0,je=!0);for(let Te=0;Te<Se.length;Te++){const ht=Se[Te];let Ve=null;if(g!==null)Ve=g.getViewport(ht);else{const Nt=f.getViewSubImage(p,ht);Ve=Nt.viewport,Te===0&&(e.setRenderTargetTextures(M,Nt.colorTexture,p.ignoreDepthValues?void 0:Nt.depthStencilTexture),e.setRenderTarget(M))}let H=C[Te];H===void 0&&(H=new kn,H.layers.enable(Te),H.viewport=new rn,C[Te]=H),H.matrix.fromArray(ht.transform.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale),H.projectionMatrix.fromArray(ht.projectionMatrix),H.projectionMatrixInverse.copy(H.projectionMatrix).invert(),H.viewport.set(Ve.x,Ve.y,Ve.width,Ve.height),Te===0&&(x.matrix.copy(H.matrix),x.matrix.decompose(x.position,x.quaternion,x.scale)),je===!0&&x.cameras.push(H)}const Oe=r.enabledFeatures;if(Oe&&Oe.includes("depth-sensing")){const Te=f.getDepthInformation(Se[0]);Te&&Te.isValid&&Te.texture&&T.init(e,Te,r.renderState)}}for(let Se=0;Se<S.length;Se++){const je=L[Se],Oe=S[Se];je!==null&&Oe!==void 0&&Oe.update(je,ue,h||a)}T.render(e,x),ge&&ge(J,ue),ue.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:ue}),y=null}const Re=new tx;Re.setAnimationLoop(be),this.setAnimationLoop=function(J){ge=J},this.dispose=function(){}}}const Lr=new di,tL=new $t;function nL(i,e){function t(m,v){m.matrixAutoUpdate===!0&&m.updateMatrix(),v.value.copy(m.matrix)}function n(m,v){v.color.getRGB(m.fogColor.value,Jv(i)),v.isFog?(m.fogNear.value=v.near,m.fogFar.value=v.far):v.isFogExp2&&(m.fogDensity.value=v.density)}function r(m,v,M,S,L){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(m,v):v.isMeshToonMaterial?(s(m,v),f(m,v)):v.isMeshPhongMaterial?(s(m,v),d(m,v)):v.isMeshStandardMaterial?(s(m,v),p(m,v),v.isMeshPhysicalMaterial&&g(m,v,L)):v.isMeshMatcapMaterial?(s(m,v),y(m,v)):v.isMeshDepthMaterial?s(m,v):v.isMeshDistanceMaterial?(s(m,v),T(m,v)):v.isMeshNormalMaterial?s(m,v):v.isLineBasicMaterial?(a(m,v),v.isLineDashedMaterial&&o(m,v)):v.isPointsMaterial?l(m,v,M,S):v.isSpriteMaterial?h(m,v):v.isShadowMaterial?(m.color.value.copy(v.color),m.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(m,v){m.opacity.value=v.opacity,v.color&&m.diffuse.value.copy(v.color),v.emissive&&m.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(m.map.value=v.map,t(v.map,m.mapTransform)),v.alphaMap&&(m.alphaMap.value=v.alphaMap,t(v.alphaMap,m.alphaMapTransform)),v.bumpMap&&(m.bumpMap.value=v.bumpMap,t(v.bumpMap,m.bumpMapTransform),m.bumpScale.value=v.bumpScale,v.side===En&&(m.bumpScale.value*=-1)),v.normalMap&&(m.normalMap.value=v.normalMap,t(v.normalMap,m.normalMapTransform),m.normalScale.value.copy(v.normalScale),v.side===En&&m.normalScale.value.negate()),v.displacementMap&&(m.displacementMap.value=v.displacementMap,t(v.displacementMap,m.displacementMapTransform),m.displacementScale.value=v.displacementScale,m.displacementBias.value=v.displacementBias),v.emissiveMap&&(m.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,m.emissiveMapTransform)),v.specularMap&&(m.specularMap.value=v.specularMap,t(v.specularMap,m.specularMapTransform)),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest);const M=e.get(v),S=M.envMap,L=M.envMapRotation;if(S&&(m.envMap.value=S,Lr.copy(L),Lr.x*=-1,Lr.y*=-1,Lr.z*=-1,S.isCubeTexture&&S.isRenderTargetTexture===!1&&(Lr.y*=-1,Lr.z*=-1),m.envMapRotation.value.setFromMatrix4(tL.makeRotationFromEuler(Lr)),m.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=v.reflectivity,m.ior.value=v.ior,m.refractionRatio.value=v.refractionRatio),v.lightMap){m.lightMap.value=v.lightMap;const V=i._useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=v.lightMapIntensity*V,t(v.lightMap,m.lightMapTransform)}v.aoMap&&(m.aoMap.value=v.aoMap,m.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,m.aoMapTransform))}function a(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,v.map&&(m.map.value=v.map,t(v.map,m.mapTransform))}function o(m,v){m.dashSize.value=v.dashSize,m.totalSize.value=v.dashSize+v.gapSize,m.scale.value=v.scale}function l(m,v,M,S){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.size.value=v.size*M,m.scale.value=S*.5,v.map&&(m.map.value=v.map,t(v.map,m.uvTransform)),v.alphaMap&&(m.alphaMap.value=v.alphaMap,t(v.alphaMap,m.alphaMapTransform)),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest)}function h(m,v){m.diffuse.value.copy(v.color),m.opacity.value=v.opacity,m.rotation.value=v.rotation,v.map&&(m.map.value=v.map,t(v.map,m.mapTransform)),v.alphaMap&&(m.alphaMap.value=v.alphaMap,t(v.alphaMap,m.alphaMapTransform)),v.alphaTest>0&&(m.alphaTest.value=v.alphaTest)}function d(m,v){m.specular.value.copy(v.specular),m.shininess.value=Math.max(v.shininess,1e-4)}function f(m,v){v.gradientMap&&(m.gradientMap.value=v.gradientMap)}function p(m,v){m.metalness.value=v.metalness,v.metalnessMap&&(m.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,m.metalnessMapTransform)),m.roughness.value=v.roughness,v.roughnessMap&&(m.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,m.roughnessMapTransform)),e.get(v).envMap&&(m.envMapIntensity.value=v.envMapIntensity)}function g(m,v,M){m.ior.value=v.ior,v.sheen>0&&(m.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),m.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(m.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,m.sheenColorMapTransform)),v.sheenRoughnessMap&&(m.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,m.sheenRoughnessMapTransform))),v.clearcoat>0&&(m.clearcoat.value=v.clearcoat,m.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(m.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,m.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(m.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===En&&m.clearcoatNormalScale.value.negate())),v.iridescence>0&&(m.iridescence.value=v.iridescence,m.iridescenceIOR.value=v.iridescenceIOR,m.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(m.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,m.iridescenceMapTransform)),v.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),v.transmission>0&&(m.transmission.value=v.transmission,m.transmissionSamplerMap.value=M.texture,m.transmissionSamplerSize.value.set(M.width,M.height),v.transmissionMap&&(m.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,m.transmissionMapTransform)),m.thickness.value=v.thickness,v.thicknessMap&&(m.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=v.attenuationDistance,m.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(m.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(m.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=v.specularIntensity,m.specularColor.value.copy(v.specularColor),v.specularColorMap&&(m.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,m.specularColorMapTransform)),v.specularIntensityMap&&(m.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,m.specularIntensityMapTransform))}function y(m,v){v.matcap&&(m.matcap.value=v.matcap)}function T(m,v){const M=e.get(v).light;m.referencePosition.value.setFromMatrixPosition(M.matrixWorld),m.nearDistance.value=M.shadow.camera.near,m.farDistance.value=M.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function iL(i,e,t,n){let r={},s={},a=[];const o=t.isWebGL2?i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(M,S){const L=S.program;n.uniformBlockBinding(M,L)}function h(M,S){let L=r[M.id];L===void 0&&(y(M),L=d(M),r[M.id]=L,M.addEventListener("dispose",m));const V=S.program;n.updateUBOMapping(M,V);const k=e.render.frame;s[M.id]!==k&&(p(M),s[M.id]=k)}function d(M){const S=f();M.__bindingPointIndex=S;const L=i.createBuffer(),V=M.__size,k=M.usage;return i.bindBuffer(i.UNIFORM_BUFFER,L),i.bufferData(i.UNIFORM_BUFFER,V,k),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,S,L),L}function f(){for(let M=0;M<o;M++)if(a.indexOf(M)===-1)return a.push(M),M;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(M){const S=r[M.id],L=M.uniforms,V=M.__cache;i.bindBuffer(i.UNIFORM_BUFFER,S);for(let k=0,w=L.length;k<w;k++){const A=Array.isArray(L[k])?L[k]:[L[k]];for(let C=0,x=A.length;C<x;C++){const E=A[C];if(g(E,k,C,V)===!0){const O=E.__offset,I=Array.isArray(E.value)?E.value:[E.value];let j=0;for(let te=0;te<I.length;te++){const Z=I[te],ne=T(Z);typeof Z=="number"||typeof Z=="boolean"?(E.__data[0]=Z,i.bufferSubData(i.UNIFORM_BUFFER,O+j,E.__data)):Z.isMatrix3?(E.__data[0]=Z.elements[0],E.__data[1]=Z.elements[1],E.__data[2]=Z.elements[2],E.__data[3]=0,E.__data[4]=Z.elements[3],E.__data[5]=Z.elements[4],E.__data[6]=Z.elements[5],E.__data[7]=0,E.__data[8]=Z.elements[6],E.__data[9]=Z.elements[7],E.__data[10]=Z.elements[8],E.__data[11]=0):(Z.toArray(E.__data,j),j+=ne.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,O,E.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function g(M,S,L,V){const k=M.value,w=S+"_"+L;if(V[w]===void 0)return typeof k=="number"||typeof k=="boolean"?V[w]=k:V[w]=k.clone(),!0;{const A=V[w];if(typeof k=="number"||typeof k=="boolean"){if(A!==k)return V[w]=k,!0}else if(A.equals(k)===!1)return A.copy(k),!0}return!1}function y(M){const S=M.uniforms;let L=0;const V=16;for(let w=0,A=S.length;w<A;w++){const C=Array.isArray(S[w])?S[w]:[S[w]];for(let x=0,E=C.length;x<E;x++){const O=C[x],I=Array.isArray(O.value)?O.value:[O.value];for(let j=0,te=I.length;j<te;j++){const Z=I[j],ne=T(Z),ee=L%V;ee!==0&&V-ee<ne.boundary&&(L+=V-ee),O.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),O.__offset=L,L+=ne.storage}}}const k=L%V;return k>0&&(L+=V-k),M.__size=L,M.__cache={},this}function T(M){const S={boundary:0,storage:0};return typeof M=="number"||typeof M=="boolean"?(S.boundary=4,S.storage=4):M.isVector2?(S.boundary=8,S.storage=8):M.isVector3||M.isColor?(S.boundary=16,S.storage=12):M.isVector4?(S.boundary=16,S.storage=16):M.isMatrix3?(S.boundary=48,S.storage=48):M.isMatrix4?(S.boundary=64,S.storage=64):M.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",M),S}function m(M){const S=M.target;S.removeEventListener("dispose",m);const L=a.indexOf(S.__bindingPointIndex);a.splice(L,1),i.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function v(){for(const M in r)i.deleteBuffer(r[M]);a=[],r={},s={}}return{bind:l,update:h,dispose:v}}class Ld{constructor(e={}){const{canvas:t=qR(),context:n=null,depth:r=!0,stencil:s=!0,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:h=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let p;n!==null?p=n.getContextAttributes().alpha:p=a;const g=new Uint32Array(4),y=new Int32Array(4);let T=null,m=null;const v=[],M=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Gn,this._useLegacyLights=!1,this.toneMapping=or,this.toneMappingExposure=1;const S=this;let L=!1,V=0,k=0,w=null,A=-1,C=null;const x=new rn,E=new rn;let O=null;const I=new bt(0);let j=0,te=t.width,Z=t.height,ne=1,ee=null,ie=null;const pe=new rn(0,0,te,Z),ge=new rn(0,0,te,Z);let be=!1;const Re=new ex;let J=!1,ue=!1,Se=null;const je=new $t,Oe=new st,Te=new q,ht={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ve(){return w===null?ne:1}let H=n;function Nt(N,B){for(let $=0;$<N.length;$++){const Y=N[$],X=t.getContext(Y,B);if(X!==null)return X}return null}try{const N={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:h,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Md}`),t.addEventListener("webglcontextlost",Me,!1),t.addEventListener("webglcontextrestored",F,!1),t.addEventListener("webglcontextcreationerror",de,!1),H===null){const B=["webgl2","webgl","experimental-webgl"];if(S.isWebGL1Renderer===!0&&B.shift(),H=Nt(B,N),H===null)throw Nt(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&H instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),H.getShaderPrecisionFormat===void 0&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw console.error("THREE.WebGLRenderer: "+N.message),N}let De,$e,Ue,ut,Qe,Ze,xt,D,R,Q,re,he,se,Ce,ke,me,xe,Ye,fe,Mt,nt,Ie,Ae,Pe;function U(){De=new cP(H),$e=new iP(H,De,e),De.init($e),Ie=new $N(H,De,$e),Ue=new qN(H,De,$e),ut=new dP(H),Qe=new NN,Ze=new XN(H,De,Ue,Qe,$e,Ie,ut),xt=new sP(S),D=new lP(S),R=new v2(H,$e),Ae=new tP(H,De,R,$e),Q=new uP(H,R,ut,Ae),re=new gP(H,Q,R,ut),fe=new mP(H,$e,Ze),me=new rP(Qe),he=new PN(S,xt,D,De,$e,Ae,me),se=new nL(S,Qe),Ce=new DN,ke=new jN(De,$e),Ye=new eP(S,xt,D,Ue,re,p,l),xe=new WN(S,re,$e),Pe=new iL(H,ut,$e,Ue),Mt=new nP(H,De,ut,$e),nt=new hP(H,De,ut,$e),ut.programs=he.programs,S.capabilities=$e,S.extensions=De,S.properties=Qe,S.renderLists=Ce,S.shadowMap=xe,S.state=Ue,S.info=ut}U();const ae=new eL(S,H);this.xr=ae,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){const N=De.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){const N=De.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return ne},this.setPixelRatio=function(N){N!==void 0&&(ne=N,this.setSize(te,Z,!1))},this.getSize=function(N){return N.set(te,Z)},this.setSize=function(N,B,$=!0){if(ae.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}te=N,Z=B,t.width=Math.floor(N*ne),t.height=Math.floor(B*ne),$===!0&&(t.style.width=N+"px",t.style.height=B+"px"),this.setViewport(0,0,N,B)},this.getDrawingBufferSize=function(N){return N.set(te*ne,Z*ne).floor()},this.setDrawingBufferSize=function(N,B,$){te=N,Z=B,ne=$,t.width=Math.floor(N*$),t.height=Math.floor(B*$),this.setViewport(0,0,N,B)},this.getCurrentViewport=function(N){return N.copy(x)},this.getViewport=function(N){return N.copy(pe)},this.setViewport=function(N,B,$,Y){N.isVector4?pe.set(N.x,N.y,N.z,N.w):pe.set(N,B,$,Y),Ue.viewport(x.copy(pe).multiplyScalar(ne).round())},this.getScissor=function(N){return N.copy(ge)},this.setScissor=function(N,B,$,Y){N.isVector4?ge.set(N.x,N.y,N.z,N.w):ge.set(N,B,$,Y),Ue.scissor(E.copy(ge).multiplyScalar(ne).round())},this.getScissorTest=function(){return be},this.setScissorTest=function(N){Ue.setScissorTest(be=N)},this.setOpaqueSort=function(N){ee=N},this.setTransparentSort=function(N){ie=N},this.getClearColor=function(N){return N.copy(Ye.getClearColor())},this.setClearColor=function(){Ye.setClearColor.apply(Ye,arguments)},this.getClearAlpha=function(){return Ye.getClearAlpha()},this.setClearAlpha=function(){Ye.setClearAlpha.apply(Ye,arguments)},this.clear=function(N=!0,B=!0,$=!0){let Y=0;if(N){let X=!1;if(w!==null){const Ee=w.texture.format;X=Ee===Fv||Ee===Uv||Ee===kv}if(X){const Ee=w.texture.type,Ne=Ee===lr||Ee===Qi||Ee===Cd||Ee===Gr||Ee===Dv||Ee===Ov,Be=Ye.getClearColor(),ze=Ye.getClearAlpha(),it=Be.r,Xe=Be.g,qe=Be.b;Ne?(g[0]=it,g[1]=Xe,g[2]=qe,g[3]=ze,H.clearBufferuiv(H.COLOR,0,g)):(y[0]=it,y[1]=Xe,y[2]=qe,y[3]=ze,H.clearBufferiv(H.COLOR,0,y))}else Y|=H.COLOR_BUFFER_BIT}B&&(Y|=H.DEPTH_BUFFER_BIT),$&&(Y|=H.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),H.clear(Y)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Me,!1),t.removeEventListener("webglcontextrestored",F,!1),t.removeEventListener("webglcontextcreationerror",de,!1),Ce.dispose(),ke.dispose(),Qe.dispose(),xt.dispose(),D.dispose(),re.dispose(),Ae.dispose(),Pe.dispose(),he.dispose(),ae.dispose(),ae.removeEventListener("sessionstart",Rt),ae.removeEventListener("sessionend",We),Se&&(Se.dispose(),Se=null),Et.stop()};function Me(N){N.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),L=!0}function F(){console.log("THREE.WebGLRenderer: Context Restored."),L=!1;const N=ut.autoReset,B=xe.enabled,$=xe.autoUpdate,Y=xe.needsUpdate,X=xe.type;U(),ut.autoReset=N,xe.enabled=B,xe.autoUpdate=$,xe.needsUpdate=Y,xe.type=X}function de(N){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function W(N){const B=N.target;B.removeEventListener("dispose",W),le(B)}function le(N){ye(N),Qe.remove(N)}function ye(N){const B=Qe.get(N).programs;B!==void 0&&(B.forEach(function($){he.releaseProgram($)}),N.isShaderMaterial&&he.releaseShaderCache(N))}this.renderBufferDirect=function(N,B,$,Y,X,Ee){B===null&&(B=ht);const Ne=X.isMesh&&X.matrixWorld.determinant()<0,Be=Co(N,B,$,Y,X);Ue.setMaterial(Y,Ne);let ze=$.index,it=1;if(Y.wireframe===!0){if(ze=Q.getWireframeAttribute($),ze===void 0)return;it=2}const Xe=$.drawRange,qe=$.attributes.position;let yt=Xe.start*it,Zt=(Xe.start+Xe.count)*it;Ee!==null&&(yt=Math.max(yt,Ee.start*it),Zt=Math.min(Zt,(Ee.start+Ee.count)*it)),ze!==null?(yt=Math.max(yt,0),Zt=Math.min(Zt,ze.count)):qe!=null&&(yt=Math.max(yt,0),Zt=Math.min(Zt,qe.count));const Ft=Zt-yt;if(Ft<0||Ft===1/0)return;Ae.setup(X,Y,Be,$,ze);let Ln,At=Mt;if(ze!==null&&(Ln=R.get(ze),At=nt,At.setIndex(Ln)),X.isMesh)Y.wireframe===!0?(Ue.setLineWidth(Y.wireframeLinewidth*Ve()),At.setMode(H.LINES)):At.setMode(H.TRIANGLES);else if(X.isLine){let tt=Y.linewidth;tt===void 0&&(tt=1),Ue.setLineWidth(tt*Ve()),X.isLineSegments?At.setMode(H.LINES):X.isLineLoop?At.setMode(H.LINE_LOOP):At.setMode(H.LINE_STRIP)}else X.isPoints?At.setMode(H.POINTS):X.isSprite&&At.setMode(H.TRIANGLES);if(X.isBatchedMesh)At.renderMultiDraw(X._multiDrawStarts,X._multiDrawCounts,X._multiDrawCount);else if(X.isInstancedMesh)At.renderInstances(yt,Ft,X.count);else if($.isInstancedBufferGeometry){const tt=$._maxInstanceCount!==void 0?$._maxInstanceCount:1/0,Sr=Math.min($.instanceCount,tt);At.renderInstances(yt,Ft,Sr)}else At.render(yt,Ft)};function et(N,B,$){N.transparent===!0&&N.side===wi&&N.forceSinglePass===!1?(N.side=En,N.needsUpdate=!0,hs(N,B,$),N.side=gr,N.needsUpdate=!0,hs(N,B,$),N.side=wi):hs(N,B,$)}this.compile=function(N,B,$=null){$===null&&($=N),m=ke.get($),m.init(),M.push(m),$.traverseVisible(function(X){X.isLight&&X.layers.test(B.layers)&&(m.pushLight(X),X.castShadow&&m.pushShadow(X))}),N!==$&&N.traverseVisible(function(X){X.isLight&&X.layers.test(B.layers)&&(m.pushLight(X),X.castShadow&&m.pushShadow(X))}),m.setupLights(S._useLegacyLights);const Y=new Set;return N.traverse(function(X){const Ee=X.material;if(Ee)if(Array.isArray(Ee))for(let Ne=0;Ne<Ee.length;Ne++){const Be=Ee[Ne];et(Be,$,X),Y.add(Be)}else et(Ee,$,X),Y.add(Ee)}),M.pop(),m=null,Y},this.compileAsync=function(N,B,$=null){const Y=this.compile(N,B,$);return new Promise(X=>{function Ee(){if(Y.forEach(function(Ne){Qe.get(Ne).currentProgram.isReady()&&Y.delete(Ne)}),Y.size===0){X(N);return}setTimeout(Ee,10)}De.get("KHR_parallel_shader_compile")!==null?Ee():setTimeout(Ee,10)})};let gt=null;function mt(N){gt&&gt(N)}function Rt(){Et.stop()}function We(){Et.start()}const Et=new tx;Et.setAnimationLoop(mt),typeof self<"u"&&Et.setContext(self),this.setAnimationLoop=function(N){gt=N,ae.setAnimationLoop(N),N===null?Et.stop():Et.start()},ae.addEventListener("sessionstart",Rt),ae.addEventListener("sessionend",We),this.render=function(N,B){if(B!==void 0&&B.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(L===!0)return;N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),B.parent===null&&B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),ae.enabled===!0&&ae.isPresenting===!0&&(ae.cameraAutoUpdate===!0&&ae.updateCamera(B),B=ae.getCamera()),N.isScene===!0&&N.onBeforeRender(S,N,B,w),m=ke.get(N,M.length),m.init(),M.push(m),je.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),Re.setFromProjectionMatrix(je),ue=this.localClippingEnabled,J=me.init(this.clippingPlanes,ue),T=Ce.get(N,v.length),T.init(),v.push(T),Ot(N,B,0,S.sortObjects),T.finish(),S.sortObjects===!0&&T.sort(ee,ie),this.info.render.frame++,J===!0&&me.beginShadows();const $=m.state.shadowsArray;if(xe.render($,N,B),J===!0&&me.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ae.enabled===!1||ae.isPresenting===!1||ae.hasDepthSensing()===!1)&&Ye.render(T,N),m.setupLights(S._useLegacyLights),B.isArrayCamera){const Y=B.cameras;for(let X=0,Ee=Y.length;X<Ee;X++){const Ne=Y[X];Sn(T,N,Ne,Ne.viewport)}}else Sn(T,N,B);w!==null&&(Ze.updateMultisampleRenderTarget(w),Ze.updateRenderTargetMipmap(w)),N.isScene===!0&&N.onAfterRender(S,N,B),Ae.resetDefaultState(),A=-1,C=null,M.pop(),M.length>0?m=M[M.length-1]:m=null,v.pop(),v.length>0?T=v[v.length-1]:T=null};function Ot(N,B,$,Y){if(N.visible===!1)return;if(N.layers.test(B.layers)){if(N.isGroup)$=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(B);else if(N.isLight)m.pushLight(N),N.castShadow&&m.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||Re.intersectsSprite(N)){Y&&Te.setFromMatrixPosition(N.matrixWorld).applyMatrix4(je);const Ne=re.update(N),Be=N.material;Be.visible&&T.push(N,Ne,Be,$,Te.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(!N.frustumCulled||Re.intersectsObject(N))){const Ne=re.update(N),Be=N.material;if(Y&&(N.boundingSphere!==void 0?(N.boundingSphere===null&&N.computeBoundingSphere(),Te.copy(N.boundingSphere.center)):(Ne.boundingSphere===null&&Ne.computeBoundingSphere(),Te.copy(Ne.boundingSphere.center)),Te.applyMatrix4(N.matrixWorld).applyMatrix4(je)),Array.isArray(Be)){const ze=Ne.groups;for(let it=0,Xe=ze.length;it<Xe;it++){const qe=ze[it],yt=Be[qe.materialIndex];yt&&yt.visible&&T.push(N,Ne,yt,$,Te.z,qe)}}else Be.visible&&T.push(N,Ne,Be,$,Te.z,null)}}const Ee=N.children;for(let Ne=0,Be=Ee.length;Ne<Be;Ne++)Ot(Ee[Ne],B,$,Y)}function Sn(N,B,$,Y){const X=N.opaque,Ee=N.transmissive,Ne=N.transparent;m.setupLightsView($),J===!0&&me.setGlobalState(S.clippingPlanes,$),Ee.length>0&&cs(X,Ee,B,$),Y&&Ue.viewport(x.copy(Y)),X.length>0&&us(X,B,$),Ee.length>0&&us(Ee,B,$),Ne.length>0&&us(Ne,B,$),Ue.buffers.depth.setTest(!0),Ue.buffers.depth.setMask(!0),Ue.buffers.color.setMask(!0),Ue.setPolygonOffset(!1)}function cs(N,B,$,Y){if(($.isScene===!0?$.overrideMaterial:null)!==null)return;const Ee=$e.isWebGL2;Se===null&&(Se=new es(1,1,{generateMipmaps:!0,type:De.has("EXT_color_buffer_half_float")?uo:lr,minFilter:jr,samples:Ee?4:0})),S.getDrawingBufferSize(Oe),Ee?Se.setSize(Oe.x,Oe.y):Se.setSize(bh(Oe.x),bh(Oe.y));const Ne=S.getRenderTarget();S.setRenderTarget(Se),S.getClearColor(I),j=S.getClearAlpha(),j<1&&S.setClearColor(16777215,.5),S.clear();const Be=S.toneMapping;S.toneMapping=or,us(N,$,Y),Ze.updateMultisampleRenderTarget(Se),Ze.updateRenderTargetMipmap(Se);let ze=!1;for(let it=0,Xe=B.length;it<Xe;it++){const qe=B[it],yt=qe.object,Zt=qe.geometry,Ft=qe.material,Ln=qe.group;if(Ft.side===wi&&yt.layers.test(Y.layers)){const At=Ft.side;Ft.side=En,Ft.needsUpdate=!0,pi(yt,$,Y,Zt,Ft,Ln),Ft.side=At,Ft.needsUpdate=!0,ze=!0}}ze===!0&&(Ze.updateMultisampleRenderTarget(Se),Ze.updateRenderTargetMipmap(Se)),S.setRenderTarget(Ne),S.setClearColor(I,j),S.toneMapping=Be}function us(N,B,$){const Y=B.isScene===!0?B.overrideMaterial:null;for(let X=0,Ee=N.length;X<Ee;X++){const Ne=N[X],Be=Ne.object,ze=Ne.geometry,it=Y===null?Ne.material:Y,Xe=Ne.group;Be.layers.test($.layers)&&pi(Be,B,$,ze,it,Xe)}}function pi(N,B,$,Y,X,Ee){N.onBeforeRender(S,B,$,Y,X,Ee),N.modelViewMatrix.multiplyMatrices($.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),X.onBeforeRender(S,B,$,Y,N,Ee),X.transparent===!0&&X.side===wi&&X.forceSinglePass===!1?(X.side=En,X.needsUpdate=!0,S.renderBufferDirect($,B,Y,X,N,Ee),X.side=gr,X.needsUpdate=!0,S.renderBufferDirect($,B,Y,X,N,Ee),X.side=wi):S.renderBufferDirect($,B,Y,X,N,Ee),N.onAfterRender(S,B,$,Y,X,Ee)}function hs(N,B,$){B.isScene!==!0&&(B=ht);const Y=Qe.get(N),X=m.state.lights,Ee=m.state.shadowsArray,Ne=X.state.version,Be=he.getParameters(N,X.state,Ee,B,$),ze=he.getProgramCacheKey(Be);let it=Y.programs;Y.environment=N.isMeshStandardMaterial?B.environment:null,Y.fog=B.fog,Y.envMap=(N.isMeshStandardMaterial?D:xt).get(N.envMap||Y.environment),Y.envMapRotation=Y.environment!==null&&N.envMap===null?B.environmentRotation:N.envMapRotation,it===void 0&&(N.addEventListener("dispose",W),it=new Map,Y.programs=it);let Xe=it.get(ze);if(Xe!==void 0){if(Y.currentProgram===Xe&&Y.lightsStateVersion===Ne)return wr(N,Be),Xe}else Be.uniforms=he.getUniforms(N),N.onBuild($,Be,S),N.onBeforeCompile(Be,S),Xe=he.acquireProgram(Be,ze),it.set(ze,Xe),Y.uniforms=Be.uniforms;const qe=Y.uniforms;return(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(qe.clippingPlanes=me.uniform),wr(N,Be),Y.needsLights=ds(N),Y.lightsStateVersion=Ne,Y.needsLights&&(qe.ambientLightColor.value=X.state.ambient,qe.lightProbe.value=X.state.probe,qe.directionalLights.value=X.state.directional,qe.directionalLightShadows.value=X.state.directionalShadow,qe.spotLights.value=X.state.spot,qe.spotLightShadows.value=X.state.spotShadow,qe.rectAreaLights.value=X.state.rectArea,qe.ltc_1.value=X.state.rectAreaLTC1,qe.ltc_2.value=X.state.rectAreaLTC2,qe.pointLights.value=X.state.point,qe.pointLightShadows.value=X.state.pointShadow,qe.hemisphereLights.value=X.state.hemi,qe.directionalShadowMap.value=X.state.directionalShadowMap,qe.directionalShadowMatrix.value=X.state.directionalShadowMatrix,qe.spotShadowMap.value=X.state.spotShadowMap,qe.spotLightMatrix.value=X.state.spotLightMatrix,qe.spotLightMap.value=X.state.spotLightMap,qe.pointShadowMap.value=X.state.pointShadowMap,qe.pointShadowMatrix.value=X.state.pointShadowMatrix),Y.currentProgram=Xe,Y.uniformsList=null,Xe}function Ro(N){if(N.uniformsList===null){const B=N.currentProgram.getUniforms();N.uniformsList=Ml.seqWithValue(B.seq,N.uniforms)}return N.uniformsList}function wr(N,B){const $=Qe.get(N);$.outputColorSpace=B.outputColorSpace,$.batching=B.batching,$.instancing=B.instancing,$.instancingColor=B.instancingColor,$.instancingMorph=B.instancingMorph,$.skinning=B.skinning,$.morphTargets=B.morphTargets,$.morphNormals=B.morphNormals,$.morphColors=B.morphColors,$.morphTargetsCount=B.morphTargetsCount,$.numClippingPlanes=B.numClippingPlanes,$.numIntersection=B.numClipIntersection,$.vertexAlphas=B.vertexAlphas,$.vertexTangents=B.vertexTangents,$.toneMapping=B.toneMapping}function Co(N,B,$,Y,X){B.isScene!==!0&&(B=ht),Ze.resetTextureUnits();const Ee=B.fog,Ne=Y.isMeshStandardMaterial?B.environment:null,Be=w===null?S.outputColorSpace:w.isXRRenderTarget===!0?w.texture.colorSpace:Er,ze=(Y.isMeshStandardMaterial?D:xt).get(Y.envMap||Ne),it=Y.vertexColors===!0&&!!$.attributes.color&&$.attributes.color.itemSize===4,Xe=!!$.attributes.tangent&&(!!Y.normalMap||Y.anisotropy>0),qe=!!$.morphAttributes.position,yt=!!$.morphAttributes.normal,Zt=!!$.morphAttributes.color;let Ft=or;Y.toneMapped&&(w===null||w.isXRRenderTarget===!0)&&(Ft=S.toneMapping);const Ln=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,At=Ln!==void 0?Ln.length:0,tt=Qe.get(Y),Sr=m.state.lights;if(J===!0&&(ue===!0||N!==C)){const Vt=N===C&&Y.id===A;me.setState(Y,N,Vt)}let wt=!1;Y.version===tt.__version?(tt.needsLights&&tt.lightsStateVersion!==Sr.state.version||tt.outputColorSpace!==Be||X.isBatchedMesh&&tt.batching===!1||!X.isBatchedMesh&&tt.batching===!0||X.isInstancedMesh&&tt.instancing===!1||!X.isInstancedMesh&&tt.instancing===!0||X.isSkinnedMesh&&tt.skinning===!1||!X.isSkinnedMesh&&tt.skinning===!0||X.isInstancedMesh&&tt.instancingColor===!0&&X.instanceColor===null||X.isInstancedMesh&&tt.instancingColor===!1&&X.instanceColor!==null||X.isInstancedMesh&&tt.instancingMorph===!0&&X.morphTexture===null||X.isInstancedMesh&&tt.instancingMorph===!1&&X.morphTexture!==null||tt.envMap!==ze||Y.fog===!0&&tt.fog!==Ee||tt.numClippingPlanes!==void 0&&(tt.numClippingPlanes!==me.numPlanes||tt.numIntersection!==me.numIntersection)||tt.vertexAlphas!==it||tt.vertexTangents!==Xe||tt.morphTargets!==qe||tt.morphNormals!==yt||tt.morphColors!==Zt||tt.toneMapping!==Ft||$e.isWebGL2===!0&&tt.morphTargetsCount!==At)&&(wt=!0):(wt=!0,tt.__version=Y.version);let Yn=tt.currentProgram;wt===!0&&(Yn=hs(Y,B,X));let wa=!1,Tr=!1,Sa=!1;const Gt=Yn.getUniforms(),Kn=tt.uniforms;if(Ue.useProgram(Yn.program)&&(wa=!0,Tr=!0,Sa=!0),Y.id!==A&&(A=Y.id,Tr=!0),wa||C!==N){Gt.setValue(H,"projectionMatrix",N.projectionMatrix),Gt.setValue(H,"viewMatrix",N.matrixWorldInverse);const Vt=Gt.map.cameraPosition;Vt!==void 0&&Vt.setValue(H,Te.setFromMatrixPosition(N.matrixWorld)),$e.logarithmicDepthBuffer&&Gt.setValue(H,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),(Y.isMeshPhongMaterial||Y.isMeshToonMaterial||Y.isMeshLambertMaterial||Y.isMeshBasicMaterial||Y.isMeshStandardMaterial||Y.isShaderMaterial)&&Gt.setValue(H,"isOrthographic",N.isOrthographicCamera===!0),C!==N&&(C=N,Tr=!0,Sa=!0)}if(X.isSkinnedMesh){Gt.setOptional(H,X,"bindMatrix"),Gt.setOptional(H,X,"bindMatrixInverse");const Vt=X.skeleton;Vt&&($e.floatVertexTextures?(Vt.boneTexture===null&&Vt.computeBoneTexture(),Gt.setValue(H,"boneTexture",Vt.boneTexture,Ze)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}X.isBatchedMesh&&(Gt.setOptional(H,X,"batchingTexture"),Gt.setValue(H,"batchingTexture",X._matricesTexture,Ze));const Ta=$.morphAttributes;if((Ta.position!==void 0||Ta.normal!==void 0||Ta.color!==void 0&&$e.isWebGL2===!0)&&fe.update(X,$,Yn),(Tr||tt.receiveShadow!==X.receiveShadow)&&(tt.receiveShadow=X.receiveShadow,Gt.setValue(H,"receiveShadow",X.receiveShadow)),Y.isMeshGouraudMaterial&&Y.envMap!==null&&(Kn.envMap.value=ze,Kn.flipEnvMap.value=ze.isCubeTexture&&ze.isRenderTargetTexture===!1?-1:1),Tr&&(Gt.setValue(H,"toneMappingExposure",S.toneMappingExposure),tt.needsLights&&Ea(Kn,Sa),Ee&&Y.fog===!0&&se.refreshFogUniforms(Kn,Ee),se.refreshMaterialUniforms(Kn,Y,ne,Z,Se),Ml.upload(H,Ro(tt),Kn,Ze)),Y.isShaderMaterial&&Y.uniformsNeedUpdate===!0&&(Ml.upload(H,Ro(tt),Kn,Ze),Y.uniformsNeedUpdate=!1),Y.isSpriteMaterial&&Gt.setValue(H,"center",X.center),Gt.setValue(H,"modelViewMatrix",X.modelViewMatrix),Gt.setValue(H,"normalMatrix",X.normalMatrix),Gt.setValue(H,"modelMatrix",X.matrixWorld),Y.isShaderMaterial||Y.isRawShaderMaterial){const Vt=Y.uniformsGroups;for(let Tn=0,fs=Vt.length;Tn<fs;Tn++)if($e.isWebGL2){const Ar=Vt[Tn];Pe.update(Ar,Yn),Pe.bind(Ar,Yn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Yn}function Ea(N,B){N.ambientLightColor.needsUpdate=B,N.lightProbe.needsUpdate=B,N.directionalLights.needsUpdate=B,N.directionalLightShadows.needsUpdate=B,N.pointLights.needsUpdate=B,N.pointLightShadows.needsUpdate=B,N.spotLights.needsUpdate=B,N.spotLightShadows.needsUpdate=B,N.rectAreaLights.needsUpdate=B,N.hemisphereLights.needsUpdate=B}function ds(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(N,B,$){Qe.get(N.texture).__webglTexture=B,Qe.get(N.depthTexture).__webglTexture=$;const Y=Qe.get(N);Y.__hasExternalTextures=!0,Y.__autoAllocateDepthBuffer=$===void 0,Y.__autoAllocateDepthBuffer||De.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Y.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(N,B){const $=Qe.get(N);$.__webglFramebuffer=B,$.__useDefaultFramebuffer=B===void 0},this.setRenderTarget=function(N,B=0,$=0){w=N,V=B,k=$;let Y=!0,X=null,Ee=!1,Ne=!1;if(N){const ze=Qe.get(N);ze.__useDefaultFramebuffer!==void 0?(Ue.bindFramebuffer(H.FRAMEBUFFER,null),Y=!1):ze.__webglFramebuffer===void 0?Ze.setupRenderTarget(N):ze.__hasExternalTextures&&Ze.rebindTextures(N,Qe.get(N.texture).__webglTexture,Qe.get(N.depthTexture).__webglTexture);const it=N.texture;(it.isData3DTexture||it.isDataArrayTexture||it.isCompressedArrayTexture)&&(Ne=!0);const Xe=Qe.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(Array.isArray(Xe[B])?X=Xe[B][$]:X=Xe[B],Ee=!0):$e.isWebGL2&&N.samples>0&&Ze.useMultisampledRTT(N)===!1?X=Qe.get(N).__webglMultisampledFramebuffer:Array.isArray(Xe)?X=Xe[$]:X=Xe,x.copy(N.viewport),E.copy(N.scissor),O=N.scissorTest}else x.copy(pe).multiplyScalar(ne).floor(),E.copy(ge).multiplyScalar(ne).floor(),O=be;if(Ue.bindFramebuffer(H.FRAMEBUFFER,X)&&$e.drawBuffers&&Y&&Ue.drawBuffers(N,X),Ue.viewport(x),Ue.scissor(E),Ue.setScissorTest(O),Ee){const ze=Qe.get(N.texture);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+B,ze.__webglTexture,$)}else if(Ne){const ze=Qe.get(N.texture),it=B||0;H.framebufferTextureLayer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,ze.__webglTexture,$||0,it)}A=-1},this.readRenderTargetPixels=function(N,B,$,Y,X,Ee,Ne){if(!(N&&N.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Be=Qe.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&Ne!==void 0&&(Be=Be[Ne]),Be){Ue.bindFramebuffer(H.FRAMEBUFFER,Be);try{const ze=N.texture,it=ze.format,Xe=ze.type;if(it!==qn&&Ie.convert(it)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const qe=Xe===uo&&(De.has("EXT_color_buffer_half_float")||$e.isWebGL2&&De.has("EXT_color_buffer_float"));if(Xe!==lr&&Ie.convert(Xe)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Xe===Si&&($e.isWebGL2||De.has("OES_texture_float")||De.has("WEBGL_color_buffer_float")))&&!qe){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}B>=0&&B<=N.width-Y&&$>=0&&$<=N.height-X&&H.readPixels(B,$,Y,X,Ie.convert(it),Ie.convert(Xe),Ee)}finally{const ze=w!==null?Qe.get(w).__webglFramebuffer:null;Ue.bindFramebuffer(H.FRAMEBUFFER,ze)}}},this.copyFramebufferToTexture=function(N,B,$=0){const Y=Math.pow(2,-$),X=Math.floor(B.image.width*Y),Ee=Math.floor(B.image.height*Y);Ze.setTexture2D(B,0),H.copyTexSubImage2D(H.TEXTURE_2D,$,0,0,N.x,N.y,X,Ee),Ue.unbindTexture()},this.copyTextureToTexture=function(N,B,$,Y=0){const X=B.image.width,Ee=B.image.height,Ne=Ie.convert($.format),Be=Ie.convert($.type);Ze.setTexture2D($,0),H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,$.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,$.unpackAlignment),B.isDataTexture?H.texSubImage2D(H.TEXTURE_2D,Y,N.x,N.y,X,Ee,Ne,Be,B.image.data):B.isCompressedTexture?H.compressedTexSubImage2D(H.TEXTURE_2D,Y,N.x,N.y,B.mipmaps[0].width,B.mipmaps[0].height,Ne,B.mipmaps[0].data):H.texSubImage2D(H.TEXTURE_2D,Y,N.x,N.y,Ne,Be,B.image),Y===0&&$.generateMipmaps&&H.generateMipmap(H.TEXTURE_2D),Ue.unbindTexture()},this.copyTextureToTexture3D=function(N,B,$,Y,X=0){if(S.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ee=Math.round(N.max.x-N.min.x),Ne=Math.round(N.max.y-N.min.y),Be=N.max.z-N.min.z+1,ze=Ie.convert(Y.format),it=Ie.convert(Y.type);let Xe;if(Y.isData3DTexture)Ze.setTexture3D(Y,0),Xe=H.TEXTURE_3D;else if(Y.isDataArrayTexture||Y.isCompressedArrayTexture)Ze.setTexture2DArray(Y,0),Xe=H.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,Y.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Y.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,Y.unpackAlignment);const qe=H.getParameter(H.UNPACK_ROW_LENGTH),yt=H.getParameter(H.UNPACK_IMAGE_HEIGHT),Zt=H.getParameter(H.UNPACK_SKIP_PIXELS),Ft=H.getParameter(H.UNPACK_SKIP_ROWS),Ln=H.getParameter(H.UNPACK_SKIP_IMAGES),At=$.isCompressedTexture?$.mipmaps[X]:$.image;H.pixelStorei(H.UNPACK_ROW_LENGTH,At.width),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,At.height),H.pixelStorei(H.UNPACK_SKIP_PIXELS,N.min.x),H.pixelStorei(H.UNPACK_SKIP_ROWS,N.min.y),H.pixelStorei(H.UNPACK_SKIP_IMAGES,N.min.z),$.isDataTexture||$.isData3DTexture?H.texSubImage3D(Xe,X,B.x,B.y,B.z,Ee,Ne,Be,ze,it,At.data):Y.isCompressedArrayTexture?H.compressedTexSubImage3D(Xe,X,B.x,B.y,B.z,Ee,Ne,Be,ze,At.data):H.texSubImage3D(Xe,X,B.x,B.y,B.z,Ee,Ne,Be,ze,it,At),H.pixelStorei(H.UNPACK_ROW_LENGTH,qe),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,yt),H.pixelStorei(H.UNPACK_SKIP_PIXELS,Zt),H.pixelStorei(H.UNPACK_SKIP_ROWS,Ft),H.pixelStorei(H.UNPACK_SKIP_IMAGES,Ln),X===0&&Y.generateMipmaps&&H.generateMipmap(Xe),Ue.unbindTexture()},this.initTexture=function(N){N.isCubeTexture?Ze.setTextureCube(N,0):N.isData3DTexture?Ze.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?Ze.setTexture2DArray(N,0):Ze.setTexture2D(N,0),Ue.unbindTexture()},this.resetState=function(){V=0,k=0,w=null,Ue.reset(),Ae.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Mi}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Id?"display-p3":"srgb",t.unpackColorSpace=St.workingColorSpace===Tc?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class rL extends Ld{}rL.prototype.isWebGL1Renderer=!0;class cx extends Nn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new di,this.environmentRotation=new di,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Mg{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(_n(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Md}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Md);const Rg={type:"change"},Iu={type:"start"},Cg={type:"end"},ml=new Wv,Ig=new Wi,sL=Math.cos(70*WR.DEG2RAD);class ux extends os{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new q,this.cursor=new q,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ys.ROTATE,MIDDLE:ys.DOLLY,RIGHT:ys.PAN},this.touches={ONE:bs.ROTATE,TWO:bs.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(U){U.addEventListener("keydown",ke),this._domElementKeyEvents=U},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ke),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Rg),n.update(),s=r.NONE},this.update=function(){const U=new q,ae=new ts().setFromUnitVectors(e.up,new q(0,1,0)),Me=ae.clone().invert(),F=new q,de=new ts,W=new q,le=2*Math.PI;return function(et=null){const gt=n.object.position;U.copy(gt).sub(n.target),U.applyQuaternion(ae),o.setFromVector3(U),n.autoRotate&&s===r.NONE&&O(x(et)),n.enableDamping?(o.theta+=l.theta*n.dampingFactor,o.phi+=l.phi*n.dampingFactor):(o.theta+=l.theta,o.phi+=l.phi);let mt=n.minAzimuthAngle,Rt=n.maxAzimuthAngle;isFinite(mt)&&isFinite(Rt)&&(mt<-Math.PI?mt+=le:mt>Math.PI&&(mt-=le),Rt<-Math.PI?Rt+=le:Rt>Math.PI&&(Rt-=le),mt<=Rt?o.theta=Math.max(mt,Math.min(Rt,o.theta)):o.theta=o.theta>(mt+Rt)/2?Math.max(mt,o.theta):Math.min(Rt,o.theta)),o.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,o.phi)),o.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),n.target.sub(n.cursor),n.target.clampLength(n.minTargetRadius,n.maxTargetRadius),n.target.add(n.cursor);let We=!1;if(n.zoomToCursor&&k||n.object.isOrthographicCamera)o.radius=pe(o.radius);else{const Et=o.radius;o.radius=pe(o.radius*h),We=Et!=o.radius}if(U.setFromSpherical(o),U.applyQuaternion(Me),gt.copy(n.target).add(U),n.object.lookAt(n.target),n.enableDamping===!0?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),d.set(0,0,0)),n.zoomToCursor&&k){let Et=null;if(n.object.isPerspectiveCamera){const Ot=U.length();Et=pe(Ot*h);const Sn=Ot-Et;n.object.position.addScaledVector(L,Sn),n.object.updateMatrixWorld(),We=!!Sn}else if(n.object.isOrthographicCamera){const Ot=new q(V.x,V.y,0);Ot.unproject(n.object);const Sn=n.object.zoom;n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix(),We=Sn!==n.object.zoom;const cs=new q(V.x,V.y,0);cs.unproject(n.object),n.object.position.sub(cs).add(Ot),n.object.updateMatrixWorld(),Et=U.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Et!==null&&(this.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Et).add(n.object.position):(ml.origin.copy(n.object.position),ml.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(ml.direction))<sL?e.lookAt(n.target):(Ig.setFromNormalAndCoplanarPoint(n.object.up,n.target),ml.intersectPlane(Ig,n.target))))}else if(n.object.isOrthographicCamera){const Et=n.object.zoom;n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),Et!==n.object.zoom&&(n.object.updateProjectionMatrix(),We=!0)}return h=1,k=!1,We||F.distanceToSquared(n.object.position)>a||8*(1-de.dot(n.object.quaternion))>a||W.distanceToSquared(n.target)>a?(n.dispatchEvent(Rg),F.copy(n.object.position),de.copy(n.object.quaternion),W.copy(n.target),!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Ye),n.domElement.removeEventListener("pointerdown",Ze),n.domElement.removeEventListener("pointercancel",D),n.domElement.removeEventListener("wheel",re),n.domElement.removeEventListener("pointermove",xt),n.domElement.removeEventListener("pointerup",D),n.domElement.getRootNode().removeEventListener("keydown",se,{capture:!0}),n._domElementKeyEvents!==null&&(n._domElementKeyEvents.removeEventListener("keydown",ke),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const a=1e-6,o=new Mg,l=new Mg;let h=1;const d=new q,f=new st,p=new st,g=new st,y=new st,T=new st,m=new st,v=new st,M=new st,S=new st,L=new q,V=new st;let k=!1;const w=[],A={};let C=!1;function x(U){return U!==null?2*Math.PI/60*n.autoRotateSpeed*U:2*Math.PI/60/60*n.autoRotateSpeed}function E(U){const ae=Math.abs(U*.01);return Math.pow(.95,n.zoomSpeed*ae)}function O(U){l.theta-=U}function I(U){l.phi-=U}const j=function(){const U=new q;return function(Me,F){U.setFromMatrixColumn(F,0),U.multiplyScalar(-Me),d.add(U)}}(),te=function(){const U=new q;return function(Me,F){n.screenSpacePanning===!0?U.setFromMatrixColumn(F,1):(U.setFromMatrixColumn(F,0),U.crossVectors(n.object.up,U)),U.multiplyScalar(Me),d.add(U)}}(),Z=function(){const U=new q;return function(Me,F){const de=n.domElement;if(n.object.isPerspectiveCamera){const W=n.object.position;U.copy(W).sub(n.target);let le=U.length();le*=Math.tan(n.object.fov/2*Math.PI/180),j(2*Me*le/de.clientHeight,n.object.matrix),te(2*F*le/de.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(j(Me*(n.object.right-n.object.left)/n.object.zoom/de.clientWidth,n.object.matrix),te(F*(n.object.top-n.object.bottom)/n.object.zoom/de.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function ne(U){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?h/=U:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ee(U){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?h*=U:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ie(U,ae){if(!n.zoomToCursor)return;k=!0;const Me=n.domElement.getBoundingClientRect(),F=U-Me.left,de=ae-Me.top,W=Me.width,le=Me.height;V.x=F/W*2-1,V.y=-(de/le)*2+1,L.set(V.x,V.y,1).unproject(n.object).sub(n.object.position).normalize()}function pe(U){return Math.max(n.minDistance,Math.min(n.maxDistance,U))}function ge(U){f.set(U.clientX,U.clientY)}function be(U){ie(U.clientX,U.clientX),v.set(U.clientX,U.clientY)}function Re(U){y.set(U.clientX,U.clientY)}function J(U){p.set(U.clientX,U.clientY),g.subVectors(p,f).multiplyScalar(n.rotateSpeed);const ae=n.domElement;O(2*Math.PI*g.x/ae.clientHeight),I(2*Math.PI*g.y/ae.clientHeight),f.copy(p),n.update()}function ue(U){M.set(U.clientX,U.clientY),S.subVectors(M,v),S.y>0?ne(E(S.y)):S.y<0&&ee(E(S.y)),v.copy(M),n.update()}function Se(U){T.set(U.clientX,U.clientY),m.subVectors(T,y).multiplyScalar(n.panSpeed),Z(m.x,m.y),y.copy(T),n.update()}function je(U){ie(U.clientX,U.clientY),U.deltaY<0?ee(E(U.deltaY)):U.deltaY>0&&ne(E(U.deltaY)),n.update()}function Oe(U){let ae=!1;switch(U.code){case n.keys.UP:U.ctrlKey||U.metaKey||U.shiftKey?I(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):Z(0,n.keyPanSpeed),ae=!0;break;case n.keys.BOTTOM:U.ctrlKey||U.metaKey||U.shiftKey?I(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):Z(0,-n.keyPanSpeed),ae=!0;break;case n.keys.LEFT:U.ctrlKey||U.metaKey||U.shiftKey?O(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):Z(n.keyPanSpeed,0),ae=!0;break;case n.keys.RIGHT:U.ctrlKey||U.metaKey||U.shiftKey?O(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):Z(-n.keyPanSpeed,0),ae=!0;break}ae&&(U.preventDefault(),n.update())}function Te(U){if(w.length===1)f.set(U.pageX,U.pageY);else{const ae=Ae(U),Me=.5*(U.pageX+ae.x),F=.5*(U.pageY+ae.y);f.set(Me,F)}}function ht(U){if(w.length===1)y.set(U.pageX,U.pageY);else{const ae=Ae(U),Me=.5*(U.pageX+ae.x),F=.5*(U.pageY+ae.y);y.set(Me,F)}}function Ve(U){const ae=Ae(U),Me=U.pageX-ae.x,F=U.pageY-ae.y,de=Math.sqrt(Me*Me+F*F);v.set(0,de)}function H(U){n.enableZoom&&Ve(U),n.enablePan&&ht(U)}function Nt(U){n.enableZoom&&Ve(U),n.enableRotate&&Te(U)}function De(U){if(w.length==1)p.set(U.pageX,U.pageY);else{const Me=Ae(U),F=.5*(U.pageX+Me.x),de=.5*(U.pageY+Me.y);p.set(F,de)}g.subVectors(p,f).multiplyScalar(n.rotateSpeed);const ae=n.domElement;O(2*Math.PI*g.x/ae.clientHeight),I(2*Math.PI*g.y/ae.clientHeight),f.copy(p)}function $e(U){if(w.length===1)T.set(U.pageX,U.pageY);else{const ae=Ae(U),Me=.5*(U.pageX+ae.x),F=.5*(U.pageY+ae.y);T.set(Me,F)}m.subVectors(T,y).multiplyScalar(n.panSpeed),Z(m.x,m.y),y.copy(T)}function Ue(U){const ae=Ae(U),Me=U.pageX-ae.x,F=U.pageY-ae.y,de=Math.sqrt(Me*Me+F*F);M.set(0,de),S.set(0,Math.pow(M.y/v.y,n.zoomSpeed)),ne(S.y),v.copy(M);const W=(U.pageX+ae.x)*.5,le=(U.pageY+ae.y)*.5;ie(W,le)}function ut(U){n.enableZoom&&Ue(U),n.enablePan&&$e(U)}function Qe(U){n.enableZoom&&Ue(U),n.enableRotate&&De(U)}function Ze(U){n.enabled!==!1&&(w.length===0&&(n.domElement.setPointerCapture(U.pointerId),n.domElement.addEventListener("pointermove",xt),n.domElement.addEventListener("pointerup",D)),!nt(U)&&(fe(U),U.pointerType==="touch"?me(U):R(U)))}function xt(U){n.enabled!==!1&&(U.pointerType==="touch"?xe(U):Q(U))}function D(U){switch(Mt(U),w.length){case 0:n.domElement.releasePointerCapture(U.pointerId),n.domElement.removeEventListener("pointermove",xt),n.domElement.removeEventListener("pointerup",D),n.dispatchEvent(Cg),s=r.NONE;break;case 1:const ae=w[0],Me=A[ae];me({pointerId:ae,pageX:Me.x,pageY:Me.y});break}}function R(U){let ae;switch(U.button){case 0:ae=n.mouseButtons.LEFT;break;case 1:ae=n.mouseButtons.MIDDLE;break;case 2:ae=n.mouseButtons.RIGHT;break;default:ae=-1}switch(ae){case ys.DOLLY:if(n.enableZoom===!1)return;be(U),s=r.DOLLY;break;case ys.ROTATE:if(U.ctrlKey||U.metaKey||U.shiftKey){if(n.enablePan===!1)return;Re(U),s=r.PAN}else{if(n.enableRotate===!1)return;ge(U),s=r.ROTATE}break;case ys.PAN:if(U.ctrlKey||U.metaKey||U.shiftKey){if(n.enableRotate===!1)return;ge(U),s=r.ROTATE}else{if(n.enablePan===!1)return;Re(U),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(Iu)}function Q(U){switch(s){case r.ROTATE:if(n.enableRotate===!1)return;J(U);break;case r.DOLLY:if(n.enableZoom===!1)return;ue(U);break;case r.PAN:if(n.enablePan===!1)return;Se(U);break}}function re(U){n.enabled===!1||n.enableZoom===!1||s!==r.NONE||(U.preventDefault(),n.dispatchEvent(Iu),je(he(U)),n.dispatchEvent(Cg))}function he(U){const ae=U.deltaMode,Me={clientX:U.clientX,clientY:U.clientY,deltaY:U.deltaY};switch(ae){case 1:Me.deltaY*=16;break;case 2:Me.deltaY*=100;break}return U.ctrlKey&&!C&&(Me.deltaY*=10),Me}function se(U){U.key==="Control"&&(C=!0,n.domElement.getRootNode().addEventListener("keyup",Ce,{passive:!0,capture:!0}))}function Ce(U){U.key==="Control"&&(C=!1,n.domElement.getRootNode().removeEventListener("keyup",Ce,{passive:!0,capture:!0}))}function ke(U){n.enabled===!1||n.enablePan===!1||Oe(U)}function me(U){switch(Ie(U),w.length){case 1:switch(n.touches.ONE){case bs.ROTATE:if(n.enableRotate===!1)return;Te(U),s=r.TOUCH_ROTATE;break;case bs.PAN:if(n.enablePan===!1)return;ht(U),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case bs.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;H(U),s=r.TOUCH_DOLLY_PAN;break;case bs.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Nt(U),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(Iu)}function xe(U){switch(Ie(U),s){case r.TOUCH_ROTATE:if(n.enableRotate===!1)return;De(U),n.update();break;case r.TOUCH_PAN:if(n.enablePan===!1)return;$e(U),n.update();break;case r.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ut(U),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Qe(U),n.update();break;default:s=r.NONE}}function Ye(U){n.enabled!==!1&&U.preventDefault()}function fe(U){w.push(U.pointerId)}function Mt(U){delete A[U.pointerId];for(let ae=0;ae<w.length;ae++)if(w[ae]==U.pointerId){w.splice(ae,1);return}}function nt(U){for(let ae=0;ae<w.length;ae++)if(w[ae]==U.pointerId)return!0;return!1}function Ie(U){let ae=A[U.pointerId];ae===void 0&&(ae=new st,A[U.pointerId]=ae),ae.set(U.pageX,U.pageY)}function Ae(U){const ae=U.pointerId===w[0]?w[1]:w[0];return A[ae]}n.domElement.addEventListener("contextmenu",Ye),n.domElement.addEventListener("pointerdown",Ze),n.domElement.addEventListener("pointercancel",D),n.domElement.addEventListener("wheel",re,{passive:!1}),n.domElement.getRootNode().addEventListener("keydown",se,{passive:!0,capture:!0}),this.update()}}const aL=()=>{const i=/Mobi|Android/i.test(navigator.userAgent),e=navigator.deviceMemory||4,t=navigator.hardwareConcurrency||4;return{isMobile:i,memory:e,hardwareConcurrency:t}};function oL(){const i=G.useRef(null),e=G.useRef(null),t=G.useRef(null),n=G.useRef(null),r=G.useRef(null),s=G.useRef(null),[a,o]=G.useState(null),[l,h]=G.useState(!1);G.useEffect(()=>{const f=aL();o(f),requestIdleCallback(()=>{window.dispatchEvent(new Event("resize"))})},[]),G.useEffect(()=>{if(!i.current||!a)return;const f=i.current,p=new cx;p.background=null,e.current=p;const g=new kn(75,f.clientWidth/f.clientHeight,.1,5e3);t.current=g;const{isMobile:y,memory:T,hardwareConcurrency:m}=a,v=y||T<=2||m<=2,M=new Ld({antialias:!v,alpha:!0,powerPreference:"high-performance"});M.setPixelRatio(Math.min(window.devicePixelRatio||1,v?1:2)),M.setSize(f.clientWidth,f.clientHeight),M.outputColorSpace=Gn,M.shadowMap.enabled=!1,M.domElement.style.pointerEvents="auto",M.domElement.style.touchAction="pan-y",M.domElement.style.userSelect="none",f.appendChild(M.domElement),n.current=M;const S=new ux(g,M.domElement);S.enableDamping=!0,S.enableZoom=!1,S.enablePan=!1,S.enableRotate=!0,S.maxPolarAngle=Math.PI*.8,S.minPolarAngle=Math.PI*.2,S.maxAzimuthAngle=Math.PI/6,S.minAzimuthAngle=-Math.PI/6,r.current=S,M.setAnimationLoop(()=>{l&&(S.update(),M.render(p,g))});const L=()=>{!f||!g||!M||(g.aspect=f.clientWidth/f.clientHeight,g.updateProjectionMatrix(),M.setSize(f.clientWidth,f.clientHeight))};return window.addEventListener("resize",L),d(p,g,S,M),()=>{window.removeEventListener("resize",L),s.current&&s.current.dispose(),M.dispose(),f&&M.domElement&&f.removeChild(M.domElement)}},[a]);const d=async(f,p,g,y)=>{const T=new zg(y.domElement);try{await T.load("https://prod.spline.design/2VoTq6B1iob8D37P/scene.splinecode"),s.current=T,h(!0),requestIdleCallback(()=>{f.updateMatrixWorld(!0);const m=new ya().setFromObject(f),v=new q;m.getCenter(v);const M=m.getSize(new q),S=Math.max(M.x,M.y,M.z),L=p.fov*(Math.PI/180);let V=Math.abs(S/2/Math.tan(L/2));V=Math.max(V,500),p.position.set(v.x,v.y,V),p.lookAt(v),g.target.copy(v),g.update(),f.position.set(0,0,0),y.render(f,p)})}catch(m){console.error("ThreeJSHero: Failed to load Spline scene:",m)}};return c.jsx("div",{ref:i,style:{width:"100%",height:"100vh",overflow:"hidden"}})}const lL=()=>c.jsx("div",{className:"flex items-center justify-center p-8",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})});function Pg({children:i,fallback:e=lL,rootMargin:t="100px",threshold:n=.1,className:r=""}){const[s,a]=G.useState(!1),o=G.useRef(null);return G.useEffect(()=>{const l=o.current;if(!l)return;const h=y1(d=>{d.forEach(f=>{f.isIntersecting&&(a(!0),h?.unobserve(l))})},{rootMargin:t,threshold:n});if(h)return h.observe(l),()=>h.disconnect();a(!0)},[t,n]),c.jsx("div",{ref:o,className:r,children:s?c.jsx(G.Suspense,{fallback:c.jsx(e,{}),children:i}):c.jsx("div",{style:{minHeight:"200px"},className:"flex items-center justify-center",children:c.jsx("div",{className:"w-4 h-4 bg-gray-400 rounded-full animate-pulse"})})})}function cL(){return c.jsxs(c.Fragment,{children:[c.jsx(k1,{children:c.jsx(oL,{})}),c.jsx(Pg,{rootMargin:"200px",className:"min-h-screen",children:c.jsx(z1,{})}),c.jsx(Pg,{rootMargin:"200px",className:"min-h-screen",children:c.jsx(H1,{})})]})}function uL(){return c.jsx("div",{className:"min-h-screen bg-black text-white",children:c.jsxs("div",{className:"container mx-auto px-6 py-20",children:[c.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-8",children:"About Xpanix"}),c.jsx("p",{className:"text-xl text-gray-300 mb-8",children:"We are a team of passionate developers and designers committed to delivering innovative digital solutions that help businesses thrive in the digital age."}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-12",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Our Mission"}),c.jsx("p",{className:"text-gray-300",children:"To empower businesses through cutting-edge technology solutions and exceptional digital experiences."})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Our Vision"}),c.jsx("p",{className:"text-gray-300",children:"To be the leading technology partner that transforms ideas into successful digital products."})]})]})]})})}function Ng(){const i=G.useRef(null),e=G.useRef(null),t=G.useRef(null),n=G.useRef(null),r=G.useRef(null),s=G.useRef(null),a=G.useRef(null);return G.useEffect(()=>{if(!i.current)return;const o=i.current,l=()=>navigator.hardwareConcurrency&&navigator.hardwareConcurrency<=4||window.deviceMemory&&window.deviceMemory<=2,h=/Mobi|Android/i.test(navigator.userAgent),d=l()||h?1:Math.min(window.devicePixelRatio,2),f=!l(),p=new nx(o.clientWidth/-2,o.clientWidth/2,o.clientHeight/2,o.clientHeight/-2,-1e5,1e5);p.position.set(980.99,179.96,196.84),p.quaternion.setFromEuler(new di(-.64,1.33,.63)),n.current=p;const g=new cx;g.background=new bt("#000000"),t.current=g;const y=new Ld({antialias:f});y.setSize(o.clientWidth,o.clientHeight),y.setPixelRatio(d),y.shadowMap.enabled=!0,y.shadowMap.type=Rd,y.setClearAlpha(1),y.domElement.style.pointerEvents="auto",y.domElement.style.touchAction="pan-y",y.domElement.style.userSelect="none",o.appendChild(y.domElement),e.current=y;const T=new ux(p,y.domElement);T.enableDamping=!0,T.dampingFactor=.125,T.enableZoom=!1,T.enablePan=!1,T.enableRotate=!0,T.maxPolarAngle=Math.PI*.8,T.minPolarAngle=Math.PI*.2,T.maxAzimuthAngle=Math.PI/6,T.minAzimuthAngle=-Math.PI/6,r.current=T;const m=new zg(y.domElement);m.load("https://prod.spline.design/0HhtDF4IAOrdc6FJ/scene.splinecode").then(()=>{a.current=m,console.log("ServiceSpline: Spline scene loaded successfully")}).catch(L=>{console.error("ServiceSpline: Failed to load Spline scene:",L)});const v=()=>{T.update(),y.render(g,p),s.current=requestAnimationFrame(v)};v();let M=null;const S=()=>{M&&clearTimeout(M),M=setTimeout(()=>{!p||!y||!o||(p.left=o.clientWidth/-2,p.right=o.clientWidth/2,p.top=o.clientHeight/2,p.bottom=o.clientHeight/-2,p.updateProjectionMatrix(),y.setSize(o.clientWidth,o.clientHeight),y.setPixelRatio(d))},150)};return window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S),M&&clearTimeout(M),s.current&&cancelAnimationFrame(s.current),a.current&&a.current.dispose(),y&&y.dispose(),o&&y.domElement&&o.removeChild(y.domElement)}},[]),c.jsx("div",{ref:i,style:{width:"100%",height:"100%",display:"block",background:"transparent"}})}function On({title:i,description:e,path:t}){const n=fi(),r=()=>{t&&n(t)};return c.jsxs("div",{onClick:r,className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-5 rounded-lg w-full md:w-[220px] hover:bg-white hover:text-black transition-all duration-300 group pointer-events-auto cursor-pointer",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:i}),c.jsx("p",{className:"text-sm opacity-80 group-hover:opacity-100",children:e})]})}function hL(){return c.jsxs("main",{className:"relative min-h-screen w-full bg-black text-white overflow-hidden",children:[c.jsxs("div",{className:"text-center pt-20 md:pt-28 pb-4 md:pb-8 relative z-30 px-4",children:[c.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2 drop-shadow-lg",children:"Scale Your Business at the"}),c.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4 drop-shadow-lg",children:"Speed of Tech"}),c.jsx("p",{className:"max-w-2xl mx-auto text-center text-sm md:text-base drop-shadow-md",children:"From websites and mobile apps to digital marketing and Shopify solutions  we deliver IT services that launch your business forward at lightning speed."})]}),c.jsxs("div",{className:"relative w-full",children:[c.jsxs("div",{className:"md:hidden relative",children:[c.jsx("div",{className:"absolute top-0 left-0 right-0 h-[300px] z-10 flex items-center justify-center",children:c.jsx(Ng,{})}),c.jsxs("div",{className:"relative z-20 flex flex-col items-center gap-4 px-4 pb-10 pt-[220px] pointer-events-none",children:[c.jsx(On,{title:"APP DEVELOPMENT",description:"We develop modern apps with tech that can help your business grow",path:"/app-development"}),c.jsx(On,{title:"WEB DEVELOPMENT",description:"Responsive, high-performance websites tailored to your brand",path:"/web-development"}),c.jsx(On,{title:"DIGITAL MARKETING",description:"Targeted Facebook & Instagram ads to grow your reach and revenue",path:"/digital-marketing"}),c.jsx(On,{title:"SHOPIFY ECOMMERCE",description:"We build modern apps that can help your business grow"}),c.jsx(On,{title:"PRODUCT LISTING",description:"We develop modern apps, tech that can help your business grow",path:"/product-listing"}),c.jsx(On,{title:"SEO",description:"Result-driven SEO strategies to boost your ranking and organic traffic"})]})]}),c.jsxs("div",{className:"hidden md:block relative h-[600px]",children:[c.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center",children:c.jsx(Ng,{})}),c.jsx("div",{className:"absolute top-0 left-[15%] z-10 lg:left-[20%]",children:c.jsx(On,{title:"APP DEVELOPMENT",description:"We develop modern apps with tech that can help your business grow",path:"/app-development"})}),c.jsx("div",{className:"absolute top-0 right-[15%] z-10 lg:right-[20%]",children:c.jsx(On,{title:"WEB DEVELOPMENT",description:"Responsive, high-performance websites tailored to your brand",path:"/web-development"})}),c.jsx("div",{className:"absolute top-[40%] left-[5%] z-10 lg:left-[10%]",children:c.jsx(On,{title:"DIGITAL MARKETING",description:"Targeted Facebook & Instagram ads to grow your reach and revenue",path:"/digital-marketing"})}),c.jsx("div",{className:"absolute top-[40%] right-[5%] z-10 lg:right-[10%]",children:c.jsx(On,{title:"SHOPIFY ECOMMERCE",description:"We build modern apps that can help your business grow"})}),c.jsx("div",{className:"absolute bottom-[5%] left-[15%] z-10 lg:left-[20%]",children:c.jsx(On,{title:"PRODUCT LISTING",description:"We develop modern apps, tech that can help your business grow",path:"/product-listing"})}),c.jsx("div",{className:"absolute bottom-[5%] right-[15%] z-10 lg:right-[20%]",children:c.jsx(On,{title:"SEO",description:"Result-driven SEO strategies to boost your ranking and organic traffic"})})]})]}),c.jsx("div",{className:"h-20 md:h-32"})]})}function Cc({children:i,className:e=""}){const t=G.useRef(null);return G.useEffect(()=>{const n=t.current;if(!n)return;const r=n.getContext("2d");if(!r)return;const s=()=>{n.width=window.innerWidth,n.height=window.innerHeight};s(),window.addEventListener("resize",s);const a=50,o="rgba(255, 255, 255, 0.03)",l=1,h=[{x:0,y:0,radius:200,intensity:.1,speed:.001},{x:0,y:0,radius:150,intensity:.15,speed:.002},{x:0,y:0,radius:100,intensity:.2,speed:.003}];let d,f=0;const p=()=>{f+=.01,r.clearRect(0,0,n.width,n.height),h.forEach((g,y)=>{g.x=n.width/2+Math.sin(f*g.speed+y)*300,g.y=n.height/2+Math.cos(f*g.speed+y)*200}),r.strokeStyle=o,r.lineWidth=l;for(let g=0;g<=n.width;g+=a)r.beginPath(),r.moveTo(g,0),r.lineTo(g,n.height),r.stroke();for(let g=0;g<=n.height;g+=a)r.beginPath(),r.moveTo(0,g),r.lineTo(n.width,g),r.stroke();h.forEach(g=>{const y=r.createRadialGradient(g.x,g.y,0,g.x,g.y,g.radius);y.addColorStop(0,`rgba(255, 255, 255, ${g.intensity})`),y.addColorStop(1,"rgba(255, 255, 255, 0)"),r.fillStyle=y,r.fillRect(0,0,n.width,n.height)}),d=requestAnimationFrame(p)};return p(),()=>{window.removeEventListener("resize",s),cancelAnimationFrame(d)}},[]),c.jsxs("div",{className:`relative ${e}`,children:[c.jsx("canvas",{ref:t,className:"fixed inset-0 w-full h-full pointer-events-none z-0",style:{background:"transparent"}}),c.jsx("div",{className:"relative z-10",children:i})]})}function dL(){const i=fi(),e=()=>{i("/contact")},t=()=>{i("/services")};return c.jsxs(Cc,{className:"min-h-screen bg-black text-white",children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 "}),c.jsx("div",{className:"relative z-10 container mx-auto px-4 pt-32 pb-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[c.jsx("div",{className:"inline-block bg-gradient-to-r from-gray-600 to-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium mb-6",children:"Web Development"}),c.jsxs("h1",{className:"text-5xl md:text-7xl font-bold mb-6",children:["Modern Web",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Solutions"})]}),c.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto",children:"We build responsive, high-performance websites that drive results and elevate your brand presence in the digital world."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[c.jsx("button",{onClick:e,className:"bg-white text-black px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Get Started Now"}),c.jsx("button",{onClick:t,className:"border border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-black transition-colors",children:"Back to Services"})]})]})})]}),c.jsx("div",{className:"container mx-auto px-4 py-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Frontend Development"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Modern, responsive interfaces built with React, Vue, and Angular. Pixel-perfect designs that work seamlessly across all devices."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" React & Next.js Applications"}),c.jsx("li",{children:" Responsive Design"}),c.jsx("li",{children:" Progressive Web Apps"}),c.jsx("li",{children:" Performance Optimization"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Backend Development"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Robust server-side solutions with scalable architectures and secure APIs that power your web applications."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Node.js & Express"}),c.jsx("li",{children:" Python & Django"}),c.jsx("li",{children:" RESTful APIs"}),c.jsx("li",{children:" Database Design"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"E-commerce Solutions"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Complete online store solutions with secure payment processing and inventory management systems."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Custom E-commerce Platforms"}),c.jsx("li",{children:" Payment Integration"}),c.jsx("li",{children:" Inventory Management"}),c.jsx("li",{children:" Order Processing"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 7V9a2 2 0 002 2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"CMS Development"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Custom content management systems that give you full control over your website content and updates."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" WordPress Development"}),c.jsx("li",{children:" Custom CMS"}),c.jsx("li",{children:" Content Management"}),c.jsx("li",{children:" SEO Optimization"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Performance Optimization"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Speed optimization and technical SEO to ensure your website loads fast and ranks well in search engines."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Speed Optimization"}),c.jsx("li",{children:" SEO Implementation"}),c.jsx("li",{children:" Core Web Vitals"}),c.jsx("li",{children:" Technical SEO"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Quality Assurance"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Comprehensive testing and quality assurance to ensure your website meets the highest standards before delivery."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Cross-browser Testing"}),c.jsx("li",{children:" Performance Testing"}),c.jsx("li",{children:" Security Audits"}),c.jsx("li",{children:" Final Delivery"})]})]})]})}),c.jsxs("div",{className:"container mx-auto px-4 py-20",children:[c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"text-center mb-16",children:[c.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Our Development",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Process"})]}),c.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"We follow a proven development methodology to deliver high-quality web solutions on time and within budget."})]}),c.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{number:"01",title:"Discovery",desc:"Understanding your requirements and project scope"},{number:"02",title:"Planning",desc:"Creating detailed project roadmap and architecture"},{number:"03",title:"Development",desc:"Building your website with modern technologies"},{number:"04",title:"Launch",desc:"Testing, deployment, and final delivery"}].map((n,r)=>c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6+r*.1},className:"text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx("span",{className:"text-2xl font-bold text-black",children:n.number})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:n.title}),c.jsx("p",{className:"text-gray-300",children:n.desc})]},n.number))})]})]})}function fL(){const i=fi(),e=()=>{i("/contact")},t=()=>{i("/services")};return c.jsxs(Cc,{className:"min-h-screen bg-black text-white",children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 "}),c.jsx("div",{className:"relative z-10 container mx-auto px-4 pt-32 pb-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[c.jsx("div",{className:"inline-block bg-gradient-to-r from-gray-600 to-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium mb-6",children:"App Development"}),c.jsxs("h1",{className:"text-5xl md:text-7xl font-bold mb-6",children:["Mobile App",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Solutions"})]}),c.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto",children:"We develop innovative mobile applications that engage users and drive business growth across iOS and Android platforms."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[c.jsx("button",{onClick:e,className:"bg-white text-black px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Get Started Now"}),c.jsx("button",{onClick:t,className:"border border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-black transition-colors",children:"Back to Services"})]})]})})]}),c.jsx("div",{className:"container mx-auto px-4 py-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"iOS Development"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Native iOS applications built with Swift and SwiftUI, optimized for performance and user experience."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Swift & SwiftUI"}),c.jsx("li",{children:" iOS 14+ Support"}),c.jsx("li",{children:" App Store Optimization"}),c.jsx("li",{children:" Performance Tuning"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Android Development"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Native Android applications using Kotlin and Jetpack Compose, designed for modern Android devices."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Kotlin & Jetpack Compose"}),c.jsx("li",{children:" Material Design 3"}),c.jsx("li",{children:" Google Play Optimization"}),c.jsx("li",{children:" Multi-device Support"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Cross-Platform"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"React Native and Flutter applications that work seamlessly across iOS and Android with native performance."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" React Native"}),c.jsx("li",{children:" Flutter Development"}),c.jsx("li",{children:" Single Codebase"}),c.jsx("li",{children:" Native Performance"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"UI/UX Design"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Intuitive and engaging user interfaces designed to provide exceptional user experiences."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" User Research"}),c.jsx("li",{children:" Wireframing & Prototyping"}),c.jsx("li",{children:" Visual Design"}),c.jsx("li",{children:" Usability Testing"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Backend Integration"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Robust backend systems and APIs that power your mobile applications with scalable architecture."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" RESTful APIs"}),c.jsx("li",{children:" Real-time Features"}),c.jsx("li",{children:" Cloud Integration"}),c.jsx("li",{children:" Data Synchronization"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"App Testing"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Comprehensive testing and quality assurance to ensure your app meets the highest standards before delivery."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Functional Testing"}),c.jsx("li",{children:" Performance Testing"}),c.jsx("li",{children:" User Experience Testing"}),c.jsx("li",{children:" Final Delivery"})]})]})]})}),c.jsxs("div",{className:"container mx-auto px-4 py-20",children:[c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"text-center mb-16",children:[c.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Our App Development",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Process"})]}),c.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"We follow a comprehensive development methodology to create high-quality mobile applications that users love."})]}),c.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{number:"01",title:"Discovery",desc:"Understanding your app requirements and target audience"},{number:"02",title:"Design",desc:"Creating wireframes, prototypes, and visual designs"},{number:"03",title:"Development",desc:"Building your app with modern technologies and best practices"},{number:"04",title:"Launch",desc:"Testing, app store submission, and final delivery"}].map((n,r)=>c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6+r*.1},className:"text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx("span",{className:"text-2xl font-bold text-black",children:n.number})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:n.title}),c.jsx("p",{className:"text-gray-300",children:n.desc})]},n.number))})]})]})}function pL(){const i=fi(),e=()=>{i("/contact")},t=()=>{i("/services")};return c.jsxs(Cc,{className:"min-h-screen bg-black text-white",children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 "}),c.jsx("div",{className:"relative z-10 container mx-auto px-4 pt-32 pb-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[c.jsx("div",{className:"inline-block bg-gradient-to-r from-gray-600 to-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium mb-6",children:"Digital Marketing"}),c.jsxs("h1",{className:"text-5xl md:text-7xl font-bold mb-6",children:["Digital Growth",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Strategies"})]}),c.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto",children:"We create data-driven digital marketing campaigns that increase brand visibility, drive traffic, and generate qualified leads for your business."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[c.jsx("button",{onClick:e,className:"bg-white text-black px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Get Started Now"}),c.jsx("button",{onClick:t,className:"border border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-black transition-colors",children:"Back to Services"})]})]})})]}),c.jsx("div",{className:"container mx-auto px-4 py-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Search Engine Optimization"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Improve your website's visibility in search engines and drive organic traffic with our comprehensive SEO strategies."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Technical SEO Audit"}),c.jsx("li",{children:" Keyword Research & Optimization"}),c.jsx("li",{children:" On-Page SEO"}),c.jsx("li",{children:" Link Building"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Pay-Per-Click Advertising"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Targeted PPC campaigns on Google Ads, Facebook, and other platforms to drive immediate traffic and conversions."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Google Ads Management"}),c.jsx("li",{children:" Facebook & Instagram Ads"}),c.jsx("li",{children:" Remarketing Campaigns"}),c.jsx("li",{children:" Conversion Optimization"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m-9 0h10m-10 0a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V6a2 2 0 00-2-2"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Social Media Marketing"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Build brand awareness and engage with your audience through strategic social media campaigns and content."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Content Strategy"}),c.jsx("li",{children:" Community Management"}),c.jsx("li",{children:" Influencer Partnerships"}),c.jsx("li",{children:" Social Media Ads"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Content Marketing"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Create valuable, engaging content that attracts your target audience and drives organic growth."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Blog Content Creation"}),c.jsx("li",{children:" Video Marketing"}),c.jsx("li",{children:" Email Marketing"}),c.jsx("li",{children:" Content Strategy"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Analytics & Reporting"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Data-driven insights and comprehensive reporting to track performance and optimize your marketing campaigns."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Google Analytics Setup"}),c.jsx("li",{children:" Performance Tracking"}),c.jsx("li",{children:" ROI Analysis"}),c.jsx("li",{children:" Monthly Reports"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Marketing Strategy"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Comprehensive marketing strategies and campaign planning to achieve your business objectives."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Campaign Planning"}),c.jsx("li",{children:" Target Audience Analysis"}),c.jsx("li",{children:" ROI Optimization"}),c.jsx("li",{children:" Performance Reports"})]})]})]})}),c.jsxs("div",{className:"container mx-auto px-4 py-20",children:[c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"text-center mb-16",children:[c.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Our Marketing",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Process"})]}),c.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"We follow a strategic approach to digital marketing that delivers measurable results and drives business growth."})]}),c.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{number:"01",title:"Research",desc:"Analyzing your market, competitors, and target audience"},{number:"02",title:"Strategy",desc:"Developing comprehensive marketing strategies and campaigns"},{number:"03",title:"Execution",desc:"Implementing campaigns across multiple channels"},{number:"04",title:"Optimization",desc:"Monitoring performance and final campaign delivery"}].map((n,r)=>c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6+r*.1},className:"text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx("span",{className:"text-2xl font-bold text-black",children:n.number})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:n.title}),c.jsx("p",{className:"text-gray-300",children:n.desc})]},n.number))})]})]})}function mL(){const i=fi(),e=()=>{i("/contact")},t=()=>{i("/services")};return c.jsxs(Cc,{className:"min-h-screen bg-black text-white",children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0"}),c.jsx("div",{className:"relative z-10 container mx-auto px-4 pt-32 pb-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[c.jsx("div",{className:"inline-block bg-gradient-to-r from-gray-600 to-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium mb-6",children:"Product Listing"}),c.jsxs("h1",{className:"text-5xl md:text-7xl font-bold mb-6",children:["E-commerce",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Solutions"})]}),c.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto",children:"We help businesses create compelling product listings that drive sales and enhance customer experience across all major e-commerce platforms."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[c.jsx("button",{onClick:e,className:"bg-white text-black px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Get Started Now"}),c.jsx("button",{onClick:t,className:"border border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-black transition-colors",children:"Back to Services"})]})]})})]}),c.jsx("div",{className:"container mx-auto px-4 py-20",children:c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Amazon Product Listing"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Optimized Amazon product listings with compelling titles, descriptions, and images to increase visibility and sales."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Keyword Research & Optimization"}),c.jsx("li",{children:" Compelling Product Titles"}),c.jsx("li",{children:" Enhanced Product Descriptions"}),c.jsx("li",{children:" Professional Product Images"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Shopify Product Setup"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Complete Shopify store setup with optimized product listings, categories, and inventory management."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Store Setup & Configuration"}),c.jsx("li",{children:" Product Catalog Management"}),c.jsx("li",{children:" SEO-Optimized Listings"}),c.jsx("li",{children:" Inventory Tracking"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Flipkart Product Listing"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Optimized Flipkart product listings with compelling titles, descriptions, and competitive pricing for the Indian market."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Indian Market Optimization"}),c.jsx("li",{children:" Competitive Pricing Strategy"}),c.jsx("li",{children:" Localized Product Descriptions"}),c.jsx("li",{children:" Flipkart SEO Optimization"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsxs("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Meta Ads"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Targeted advertising campaigns on Facebook and Instagram to promote your products and drive sales."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Facebook Advertising"}),c.jsx("li",{children:" Instagram Ads"}),c.jsx("li",{children:" Audience Targeting"}),c.jsx("li",{children:" Conversion Optimization"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsxs("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Product Photography"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Professional product photography services to showcase your products in the best light and increase sales."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" Professional Product Shots"}),c.jsx("li",{children:" Lifestyle Photography"}),c.jsx("li",{children:" Image Editing & Optimization"}),c.jsx("li",{children:" Multi-Angle Shots"})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 p-8 rounded-2xl transition-all duration-300 group pointer-events-auto cursor-pointer transform hover:rotate-x-12 hover:rotate-y-12 hover:scale-105",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-gray-600 to-gray-900 rounded-xl flex items-center justify-center mb-6",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Listing Optimization"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Optimize your product listings for maximum visibility and sales across all major e-commerce platforms."}),c.jsxs("ul",{className:"text-gray-400 space-y-2",children:[c.jsx("li",{children:" SEO Optimization"}),c.jsx("li",{children:" Conversion Rate Optimization"}),c.jsx("li",{children:" A/B Testing"}),c.jsx("li",{children:" Final Delivery"})]})]})]})}),c.jsxs("div",{className:"container mx-auto px-4 py-20",children:[c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"text-center mb-16",children:[c.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:["Our Product Listing",c.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:" Process"})]}),c.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"We follow a systematic approach to create compelling product listings that drive sales and enhance customer experience."})]}),c.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{number:"01",title:"Research",desc:"Analyzing market trends, competitors, and target audience"},{number:"02",title:"Optimization",desc:"Creating SEO-optimized titles, descriptions, and keywords"},{number:"03",title:"Visual Design",desc:"Professional product photography and visual presentation"},{number:"04",title:"Launch",desc:"Publishing listings and final delivery"}].map((n,r)=>c.jsxs(ct.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6+r*.1},className:"text-center",children:[c.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx("span",{className:"text-2xl font-bold text-black",children:n.number})}),c.jsx("h3",{className:"text-2xl font-bold mb-4",children:n.title}),c.jsx("p",{className:"text-gray-300",children:n.desc})]},n.number))})]})]})}const hx=()=>{const i=document.getElementById("all-projects");i&&i.scrollIntoView({behavior:"smooth"})},gL=({products:i})=>{const e=i.slice(0,5),t=i.slice(5,10),n=i.slice(10,15),r=kg.useRef(null),{scrollYProgress:s}=Cx({target:r,offset:["start start","end start"]}),a={stiffness:300,damping:30,bounce:100},o=_s(vs(s,[0,1],[0,800]),a),l=_s(vs(s,[0,1],[0,-800]),a),h=_s(vs(s,[0,.2],[15,0]),a),d=_s(vs(s,[0,.2],[.2,1]),a),f=_s(vs(s,[0,.2],[20,0]),a),p=_s(vs(s,[0,.2],[0,200]),a),g=G.useMemo(()=>e,[e]),y=G.useMemo(()=>t,[t]),T=G.useMemo(()=>n,[n]);return c.jsxs("div",{ref:r,className:"h-[100vh] md:h-[200vh] pt-20 pb-0 md:pt-24 md:pb-0 overflow-hidden  antialiased relative flex flex-col self-auto [perspective:1000px] [transform-style:preserve-3d]",children:[c.jsxs(ct.div,{style:{rotateX:h,rotateZ:f,translateY:p,opacity:d},className:"absolute inset-0 z-0 mt-8 md:mt-12",children:[c.jsx(ct.div,{className:"flex flex-row-reverse space-x-reverse space-x-8 md:space-x-20 mb-4 md:mb-16",children:g.map(m=>c.jsx(Pu,{product:m,translate:o},m.title))}),c.jsx(ct.div,{className:"flex flex-row mb-4 md:mb-16 space-x-8 md:space-x-20",children:y.map(m=>c.jsx(Pu,{product:m,translate:l},m.title))}),c.jsx(ct.div,{className:"flex flex-row-reverse space-x-reverse space-x-8 md:space-x-20",children:T.map(m=>c.jsx(Pu,{product:m,translate:o},m.title))})]}),c.jsx("div",{className:"relative z-40",children:c.jsx(_L,{})})]})},_L=()=>c.jsxs("div",{className:"flex flex-col items-center justify-center text-center w-full max-w-7xl mx-auto px-4 md:px-10 py-3 md:py-6 relative",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-4 md:px-6 py-1.5 md:py-2 bg-[#181f2a] border border-[#25304a] rounded-full text-white text-sm md:text-lg font-semibold mb-3 md:mb-4 shadow-lg",children:[c.jsx("span",{className:"text-amber-400 text-lg md:text-xl",children:""}),"Partnership Excellence Since 2020"]}),c.jsx("h1",{className:"text-3xl md:text-7xl font-extrabold mb-3 md:mb-4 tracking-tight text-white drop-shadow-lg",children:"Our Portfolio"}),c.jsxs("p",{className:"text-sm md:text-2xl text-gray-300 max-w-4xl mx-auto mb-4 md:mb-6 leading-relaxed font-normal drop-shadow-md",children:["Four years of collaborative excellence, delivering innovative digital solutions as ",c.jsx("span",{className:"font-bold text-white",children:"trusted partners"})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-8 mb-4 md:mb-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl md:text-5xl font-extrabold text-[#a6b3c9] mb-1 drop-shadow-md",children:"99%"}),c.jsx("div",{className:"text-xs md:text-lg text-gray-300 drop-shadow-sm",children:"Partnership Success"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl md:text-5xl font-extrabold text-[#a6b3c9] mb-1 drop-shadow-md",children:"50+"}),c.jsx("div",{className:"text-xs md:text-lg text-gray-300 drop-shadow-sm",children:"Trusted Clients"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl md:text-5xl font-extrabold text-[#a6b3c9] mb-1 drop-shadow-md",children:"4+"}),c.jsx("div",{className:"text-xs md:text-lg text-gray-300 drop-shadow-sm",children:"Years Partnership"})]})]}),c.jsxs("button",{onClick:hx,className:"inline-flex items-center gap-2 px-6 md:px-8 py-3 md:py-4 bg-[#3b4861] hover:bg-[#4a5a7a] text-white rounded-xl font-semibold text-base md:text-lg transition-all duration-300 hover:scale-105 group shadow-xl border border-gray-600/50",children:["Explore Our Work",c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 md:h-6 md:w-6 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]}),Pu=({product:i,translate:e})=>c.jsxs(ct.div,{style:{x:e},whileHover:{y:-20},className:"group/product h-48 md:h-96 w-[18rem] md:w-[30rem] relative flex-shrink-0",children:[c.jsx("div",{onClick:hx,className:"block group-hover/product:shadow-2xl cursor-pointer",children:c.jsx("img",{src:i.thumbnail,height:"600",width:"600",className:"object-cover object-left-top absolute h-full w-full inset-0",alt:i.title})}),c.jsx("div",{className:"absolute inset-0 h-full w-full opacity-0 group-hover/product:opacity-80 bg-black pointer-events-none"}),c.jsx("h2",{className:"absolute bottom-4 left-4 opacity-0 group-hover/product:opacity-100 text-white",children:i.title})]},i.title),vL=["All","Web Development","UI/UX Design"],Lg=[{id:5,title:"Travel Agency Website",description:"An engaging travel website offering tour packages, destination galleries, and inquiry forms to attract potential travelers.",image:"/2.png",category:"Web Development",technologies:["html","css","javascript","bootstrap"],liveUrl:"https://www.ruhanitrips.com/",featured:!0},{id:6,title:"Art Gallery Website",description:"A visually rich online art gallery showcasing artwork collections, artist bios, and exhibition details.",image:"/6.png",category:"Web Development",technologies:["html","css","javascript","bootstrap"],liveUrl:"https://neha-kandari.github.io/photoframe/#home",featured:!0},{id:7,title:"Gym Website",description:"A Figma-based design for a fitness-focused website featuring workout plans, trainer profiles, and membership options.",image:"/7.png",category:"UI/UX Design",technologies:["figma"],liveUrl:"https://www.figma.com/proto/b1wR3W4cUSryI4rBCJZpKR/Fitness---Gym-Website-Design--Fitmaker---Community-?page-id=0%3A1&node-id=2-47&viewport=358%2C196%2C0.09&t=mwZMGDfZmv7MZiUO-1&scaling=min-zoom&content-scaling=fixed"},{id:8,title:"E-commerce Website",description:"A full-featured e-commerce platform with product listings, modern UI components, and a responsive layout built using the latest stack.",image:"/9.png",category:"Web Development",technologies:["next.js","tailwindcss","typescript","shadcn/ui"],liveUrl:"https://pmakemobilelcd.com/"},{id:9,title:"Interior Design Website",description:"A creative Figma prototype for an interior design firm, highlighting project galleries, service sections, and design concepts.",image:"/8.png",category:"UI/UX Design",technologies:["figma"],liveUrl:"https://www.figma.com/proto/Idofiu2yi7cPfZXd53ySWR/Panto---Furniture-Landing-Page-Design--Community-?page-id=0%3A1&node-id=1-2&p=f&viewport=489%2C487%2C0.13&t=VHCoQAXjUXJufzTR-1&scaling=min-zoom&content-scaling=fixed"},{id:10,title:"Furniture E-commerce Website",description:"A clean and elegant e-commerce UI/UX concept for a furniture brand, featuring product views, categories, and smooth interactions.",image:"/10.png",category:"UI/UX Design",technologies:["figma"],liveUrl:"https://www.figma.com/proto/lpHV3fKVx2mYmgBysqr0fg/eCommerce-Website-%7C-Web-Page-Design?page-id=0%3A1&node-id=117-336&p=f&viewport=200%2C264%2C0.07&t=Ly4kCpErwUh0JVJl-1&scaling=min-zoom&content-scaling=fixed&starting-point-node-id=117%3A1143"}],xL=()=>{const[i,e]=G.useState("All"),[t,n]=G.useState(!1),r=G.useMemo(()=>i==="All"?Lg:Lg.filter(o=>o.category===i),[i]),s=G.useMemo(()=>t?r:r.slice(0,4),[t,r]),a=o=>{e(o),n(!1)};return c.jsx("div",{id:"all-projects",className:"min-h-screen pt-0 md:pt-4 bg-black text-white",children:c.jsx("section",{className:"py-4 md:py-8 px-4 bg-black",children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-center mb-6 text-white",children:"All Projects"}),c.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:vL.map(o=>c.jsx("button",{onClick:()=>a(o),className:`px-3 py-1.5 rounded-lg font-medium transition-all duration-300 text-xs md:text-sm ${i===o?"bg-slate-600 text-white shadow-md":"bg-neutral-900 text-white hover:bg-slate-800 border border-neutral-700"}`,children:o},o))}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4 lg:gap-6 mb-6",children:s.map(o=>c.jsxs("div",{className:"group bg-neutral-900 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1 border border-neutral-700 flex flex-col h-full text-white",children:[c.jsxs("div",{className:"relative h-32 md:h-40 lg:h-48 overflow-hidden bg-black",children:[c.jsx("img",{src:o.image,alt:o.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),c.jsx("div",{className:"absolute top-2 left-2",children:c.jsx("span",{className:"px-1.5 py-0.5 bg-slate-700 text-white text-[10px] md:text-xs rounded",children:o.category})})]}),c.jsxs("div",{className:"p-2 md:p-3 lg:p-4 flex flex-col flex-grow",children:[c.jsx("h3",{className:"text-sm md:text-base lg:text-lg font-bold mb-1 md:mb-2 line-clamp-2 text-white",children:o.title}),c.jsx("p",{className:"text-white text-xs md:text-sm mb-2 md:mb-3 line-clamp-2 md:line-clamp-3 flex-grow",children:o.description}),c.jsx("div",{className:"hidden md:flex flex-wrap gap-1.5 mb-3 min-h-[24px]",children:o.technologies.slice(0,3).map(l=>c.jsx("span",{className:"px-2 py-1 bg-neutral-800 text-white text-xs rounded",children:l},l))}),c.jsx("div",{className:"mt-auto",children:c.jsx(rt,{to:o.liveUrl,className:"block w-full text-center py-1.5 md:py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-800 transition-colors text-xs md:text-sm",children:"View Project"})})]})]},o.id))}),r.length>4&&c.jsx("div",{className:"text-center",children:c.jsx("button",{onClick:()=>n(!t),className:"inline-flex items-center gap-2 px-4 md:px-6 lg:px-8 py-2 md:py-3 lg:py-4 bg-slate-600 hover:bg-slate-700 text-white rounded-lg font-medium transition-all duration-300 hover:scale-105 shadow-lg group text-sm md:text-base",children:t?c.jsxs(c.Fragment,{children:["Show Less Projects",c.jsx(lf,{size:16,className:"rotate-90 group-hover:translate-y-1 transition-transform"})]}):c.jsxs(c.Fragment,{children:["Show More Projects (",r.length-4," more)",c.jsx(lf,{size:16,className:"group-hover:translate-x-1 transition-transform"})]})})})]})})})},Dg=["/Desktop - 1.png","/Desktop - 2.png","/Desktop - 3.png","/Desktop - 4.png","/Desktop - 5.png","/Desktop - 6.png"],yL=["E-Commerce Platform","Mobile Banking App","Healthcare Dashboard","Real Estate Platform","Education Management System","Restaurant Ordering System","Travel Booking Platform","Fitness Tracking App","Social Media Dashboard","Inventory Management System","CRM Software","Project Management Tool","Analytics Dashboard","Content Management System","AI-Powered Chatbot"],bL=yL.map((i,e)=>({title:i,link:`/portfolio/${i.toLowerCase().replace(/ /g,"-")}`,thumbnail:Dg[e%Dg.length]}));function EL(){return c.jsxs("div",{className:"bg-black",children:[c.jsx(gL,{products:bL}),c.jsx(xL,{})]})}function wL(){const[i,e]=G.useState({name:"",email:"",phone:"",message:""}),[t,n]=G.useState({name:"",email:"",phone:"",message:""}),[r,s]=G.useState({name:!1,email:!1,phone:!1,message:!1}),a=d=>{const{name:f,value:p}=d.target;if(t[f]&&n({...t,[f]:""}),f==="name"){const y=Td(p).slice(0,20);e({...i,name:y});const T=Sd(y);T.isValid?n({...t,name:""}):n({...t,name:T.error||""});return}if(f==="phone"){const y=p.replace(/\D/g,"").slice(0,10);e({...i,phone:y});const T=wd(y);T.isValid?n({...t,phone:""}):n({...t,phone:T.error||""});return}if(e({...i,[f]:p}),f==="email"){const g=Ed(p);g.isValid?n({...t,email:""}):n({...t,email:g.error||""})}},o=d=>{const{name:f,value:p}=d.target;if(s({...r,[f]:!0}),f==="name"){const g=aa(p);g.isValid?n({...t,name:""}):n({...t,name:g.error||""})}else if(f==="email"){const g=sa(p);g.isValid?n({...t,email:""}):n({...t,email:g.error||""})}else if(f==="phone"){const g=Hr(p);g.isValid?n({...t,phone:""}):n({...t,phone:g.error||""})}},l=async()=>{const d={name:"",email:"",phone:"",message:""},f=aa(i.name);f.isValid||(d.name=f.error||"");const p=sa(i.email);if(!p.isValid)d.email=p.error||"";else{const g=await Iv(i.email);g.exists||(d.email=g.error||"Email address does not exist")}if(i.phone.trim()){const g=Hr(i.phone);g.isValid||(d.phone=g.error||"")}return i.message.trim()||(d.message="Message is required"),n(d),!Object.values(d).some(g=>g!=="")},h=async d=>{if(d.preventDefault(),!await l())return;const p=`
Hello,

I am reaching out through your website contact form. Here are my details:

Name: ${i.name}
Email: ${i.email}
Phone: ${i.phone||"Not provided"}

Message:
${i.message}

Best regards,
${i.name}
    `.trim(),g=`mailto:info.xpanix@gmail.com?subject=Contact Form Submission - ${encodeURIComponent(i.name)}&body=${encodeURIComponent(p)}`;window.location.href=g};return c.jsx("div",{className:"bg-gradient-to-br from-gray-900/50 to-gray-800/30 backdrop-blur-lg p-8 rounded-3xl border border-gray-700/50 shadow-2xl",children:c.jsxs("form",{className:"space-y-6",onSubmit:h,children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300",children:"Name *"}),c.jsx("input",{type:"text",id:"name",name:"name",className:`w-full bg-gray-800/50 border rounded-xl px-4 py-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-300 backdrop-blur-sm ${t.name&&r.name?"border-red-400/50 focus:ring-red-400":"border-gray-600/50 focus:ring-gray-500"}`,required:!0,value:i.name,onChange:a,onBlur:o,placeholder:"Enter your full name",maxLength:20}),t.name&&r.name&&c.jsx("p",{className:"text-red-400 text-sm",children:t.name})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email *"}),c.jsx("input",{type:"email",id:"email",name:"email",className:`w-full bg-gray-800/50 border rounded-xl px-4 py-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-300 backdrop-blur-sm ${t.email&&r.email?"border-red-400/50 focus:ring-red-400":"border-gray-600/50 focus:ring-gray-500"}`,required:!0,value:i.email,onChange:a,onBlur:o,placeholder:"Enter your email address"}),t.email&&r.email&&c.jsx("p",{className:"text-red-400 text-sm",children:t.email})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-300",children:"Phone"}),c.jsx("input",{type:"tel",id:"phone",name:"phone",className:`w-full bg-gray-800/50 border rounded-xl px-4 py-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-300 backdrop-blur-sm ${t.phone&&r.phone?"border-red-400/50 focus:ring-red-400":"border-gray-600/50 focus:ring-gray-500"}`,value:i.phone,onChange:a,onBlur:o,placeholder:"Enter 10 digits only (e.g., 9876543210)",maxLength:10}),t.phone&&r.phone&&c.jsx("p",{className:"text-red-400 text-sm",children:t.phone})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-300",children:"Message *"}),c.jsx("textarea",{id:"message",name:"message",rows:6,className:`w-full bg-gray-800/50 border rounded-xl px-4 py-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-300 backdrop-blur-sm resize-none ${t.message&&r.message?"border-red-400/50 focus:ring-red-400":"border-gray-600/50 focus:ring-gray-500"}`,required:!0,value:i.message,onChange:a,onBlur:o,placeholder:"Tell us about your project requirements..."}),t.message&&r.message&&c.jsx("p",{className:"text-red-400 text-sm",children:t.message})]}),c.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-[1.02] hover:shadow-lg border border-gray-600/50",children:"Submit"})]})})}function SL(){return c.jsx("div",{className:"min-h-screen bg-black text-white relative overflow-hidden",children:c.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center px-4 py-20 pt-32",children:c.jsxs("div",{className:"w-full max-w-7xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6 text-white uppercase tracking-wider",children:"CONTACT US"}),c.jsx("h2",{className:"text-xl md:text-2xl font-medium mb-4 text-white",children:"Skip the Middlemen  Talk Directly to the Developer!"}),c.jsx("p",{className:"text-gray-400 text-base md:text-lg max-w-4xl mx-auto leading-relaxed",children:"We believe in clear, fast, and honest communication. That's why when you reach out to us, you won't be passed through layers of sales person and managers."})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center",children:[c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Get in touch"}),c.jsx("p",{className:"text-gray-400 text-lg mb-8 leading-relaxed",children:"Have questions or ready to transform your business with AI automation?"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx("a",{href:"mailto:info.xpanix@gmail.com?subject=Contact%20Inquiry&body=Hello,%20I%20would%20like%20to%20get%20in%20touch%20with%20you.",className:"block bg-gradient-to-r from-gray-900/80 to-gray-800/60 backdrop-blur-sm p-6 rounded-2xl border border-gray-700/50 hover:border-gray-600/70 transition-all duration-300 group cursor-pointer",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-800 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:c.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-1",children:"Email us"}),c.jsx("p",{className:"text-gray-400",children:"info.xpanix@gmail.com"})]}),c.jsx("div",{className:"ml-auto",children:c.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]})}),c.jsx("a",{href:"https://wa.me/918930005190?text=Hello%2C%20I%20would%20like%20to%20discuss%20a%20project%20with%20you.",target:"_blank",rel:"noopener noreferrer",className:"block bg-gradient-to-r from-gray-900/80 to-gray-800/60 backdrop-blur-sm p-6 rounded-2xl border border-gray-700/50 hover:border-gray-600/70 transition-all duration-300 group cursor-pointer",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-800 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:c.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-1",children:"Call us"}),c.jsx("p",{className:"text-gray-400",children:"+91 8930005190"})]}),c.jsx("div",{className:"ml-auto",children:c.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]})}),c.jsxs("div",{className:"bg-gradient-to-r from-gray-900/80 to-gray-800/60 backdrop-blur-sm p-6 rounded-2xl border border-gray-700/50",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-700 to-gray-800 rounded-xl flex items-center justify-center",children:c.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),c.jsx("div",{children:c.jsx("h3",{className:"text-lg font-semibold mb-1",children:"Our locations"})})]}),c.jsx("a",{href:"https://www.google.com/maps/search/?api=1&query=D-91+West+Patel+Nagar+Patel+Nagar+New+Delhi+India",target:"_blank",rel:"noopener noreferrer",className:"block p-4 rounded-xl border border-gray-700/30 hover:border-gray-600/50 hover:bg-gray-800/30 transition-all duration-300 group cursor-pointer mb-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-semibold mb-1 text-white",children:"Delhi Office"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"D-91 West Patel Nagar, Patel Nagar, New Delhi"})]}),c.jsx("svg",{className:"w-4 h-4 text-gray-500 group-hover:text-gray-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})}),c.jsx("a",{href:"https://www.google.com/maps/search/?api=1&query=2+Eadgah+Road+Model+Town+Panipat+Haryana+India",target:"_blank",rel:"noopener noreferrer",className:"block p-4 rounded-xl border border-gray-700/30 hover:border-gray-600/50 hover:bg-gray-800/30 transition-all duration-300 group cursor-pointer",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-semibold mb-1 text-white",children:"Panipat Office"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"2, Eadgah Road Model Town Panipat Haryana"})]}),c.jsx("svg",{className:"w-4 h-4 text-gray-500 group-hover:text-gray-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})]}),c.jsx("div",{className:"lg:pl-8 pt-8 lg:pt-12",children:c.jsx(wL,{})})]})]})})})}const dx=new Zn;dx.setCustomParameters({prompt:"select_account"});const TL=()=>{const[i,e]=G.useState(""),[t,n]=G.useState(""),[r,s]=G.useState(""),[a,o]=G.useState(null),[l,h]=G.useState(!1),[d,f]=G.useState(null),[p,g]=G.useState(!1),y=fi(),T=async()=>{o(null);try{const S=(await $0(Fn,dx)).user,L=await _d(Br(sr,"users",S.uid));!L.exists()||!L.data().phone?(f(S),h(!0)):(g(!0),setTimeout(()=>{g(!1),y("/")},1500))}catch(M){console.error("Google Sign-In Error:",M);const S=M;S.code==="auth/popup-closed-by-user"?o("Sign-in was cancelled. Please try again."):S.code==="auth/popup-blocked"?o("Popup was blocked by your browser. Please allow popups and try again."):S.code==="auth/auth-domain-config-required"?o("Google Sign-In is not properly configured. Please contact support."):S.code==="auth/operation-not-allowed"?o("Google Sign-In is not enabled. Please contact support."):S.code==="auth/unauthorized-domain"?o("This domain is not authorized for Google Sign-In."):o(`Sign-in failed: ${S.message||"Unknown error"}`)}},m=async M=>{M.preventDefault(),d&&(await uh(Br(sr,"users",d.uid),{phone:r,name:d.displayName,email:d.email},{merge:!0}),h(!1),g(!0),setTimeout(()=>{g(!1),y("/")},1500))},v=async M=>{M.preventDefault(),o(null);try{await Mw(Fn,i,t),y("/")}catch(S){o(S.message)}};return c.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-900 to-gray-800",children:[c.jsxs("div",{className:"bg-black bg-opacity-60 rounded-xl shadow-lg p-8 w-full max-w-md",children:[c.jsxs("div",{className:"flex flex-col items-center mb-6",children:[c.jsx("div",{className:"bg-gray-800 rounded-full p-3 mb-2",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})}),c.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Welcome back"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"Sign in with Google or Email"})]}),c.jsx("div",{className:"flex justify-center mb-4",children:c.jsxs("button",{className:"bg-gray-700 hover:bg-gray-600 p-2 rounded-full flex items-center gap-2",onClick:T,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"w-5 h-5",children:c.jsxs("g",{children:[c.jsx("path",{fill:"#4285F4",d:"M43.6 20.5H42V20H24v8h11.3C34.7 32.1 29.8 35 24 35c-6.1 0-11.3-4.1-13.1-9.6s-.3-11.3 4.6-14.7c4.9-3.4 11.5-2.7 15.7 1.6l6.2-6.2C33.1 2.1 28.7 0 24 0 10.7 0 0 10.7 0 24s10.7 24 24 24c12.2 0 22.3-9.3 23.8-21.2.1-.7.2-1.3.2-2 0-1.3-.1-2.5-.4-3.7z"}),c.jsx("path",{fill:"#34A853",d:"M6.3 14.6l6.6 4.8C14.5 16.1 19 13 24 13c3.1 0 6 .9 8.3 2.6l6.2-6.2C34.7 4.1 29.8 1 24 1 14.1 1 5.7 7.6 2.1 16.1l6.2-1.5z"}),c.jsx("path",{fill:"#FBBC05",d:"M24 47c5.8 0 11.1-2.2 15.2-5.8l-7.1-5.8C29.8 37.9 27 39 24 39c-5 0-9.5-3.1-11.3-7.6l-6.6 5.1C5.7 40.4 14.1 47 24 47z"}),c.jsx("path",{fill:"#EA4335",d:"M43.6 20.5H42V20H24v8h11.3c-1.1 3.1-4.1 5.5-7.3 6.2l7.1 5.8C41.7 36.2 44 30.6 44 24c0-1.3-.1-2.5-.4-3.7z"})]})}),c.jsx("span",{className:"text-white",children:"Sign in with Google"})]})}),c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"flex-grow h-px bg-gray-700"}),c.jsx("span",{className:"mx-2 text-gray-500 text-xs",children:"OR"}),c.jsx("div",{className:"flex-grow h-px bg-gray-700"})]}),c.jsxs("form",{onSubmit:v,children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Email Address"}),c.jsx("input",{type:"email",className:"w-full px-4 py-2 rounded bg-gray-800 text-white border border-gray-700 focus:outline-none focus:border-blue-500",placeholder:"Enter your email...",required:!0,value:i,onChange:M=>e(M.target.value)})]}),c.jsxs("div",{className:"mb-2",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Password"}),c.jsx("input",{type:"password",className:"w-full px-4 py-2 rounded bg-gray-800 text-white border border-gray-700 focus:outline-none focus:border-blue-500",placeholder:"********",required:!0,value:t,onChange:M=>n(M.target.value)})]}),c.jsx("div",{className:"flex justify-end mb-4",children:c.jsx("a",{href:"#",className:"text-xs text-gray-400 hover:underline",children:"Forgot Password?"})}),a&&c.jsx("div",{className:"text-red-500 text-sm mb-2",children:a}),c.jsx("button",{type:"submit",className:"w-full py-2 rounded bg-gray-700 text-white font-semibold hover:bg-gray-600 transition",children:"Sign in"})]}),c.jsxs("div",{className:"mt-4 text-center text-gray-400 text-sm",children:["Don't have an account yet?"," ",c.jsx(rt,{to:"/signup",className:"text-blue-400 hover:underline",children:"Sign up"})]})]}),l&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-50",children:c.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg shadow-lg w-full max-w-sm",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Enter your phone number"}),c.jsxs("form",{onSubmit:m,children:[c.jsx("input",{type:"tel",className:"w-full px-4 py-2 rounded bg-gray-800 text-white border border-gray-700 focus:outline-none focus:border-blue-500 mb-4",placeholder:"Enter your phone number...",required:!0,value:r,onChange:M=>s(M.target.value)}),c.jsx("button",{type:"submit",className:"w-full py-2 rounded bg-gray-700 text-white font-semibold hover:bg-gray-600 transition",children:"Save Phone Number"})]})]})}),p&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-50",children:c.jsxs("div",{className:"bg-green-600 p-6 rounded-lg shadow-lg w-full max-w-sm flex flex-col items-center",children:[c.jsx("svg",{className:"w-10 h-10 text-white mb-2",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),c.jsx("span",{className:"text-white text-lg font-semibold",children:"Sign in successful!"})]})})]})};function AL(){return c.jsx(TL,{})}const fx=new Zn;fx.setCustomParameters({prompt:"select_account"});const ML=()=>{const[i,e]=G.useState(""),[t,n]=G.useState(""),[r,s]=G.useState(""),[a,o]=G.useState(""),[l,h]=G.useState(null),[d,f]=G.useState(!1),[p,g]=G.useState({name:"",phone:"",email:"",password:""}),[y,T]=G.useState({name:!1,phone:!1,email:!1,password:!1}),m=fi(),v=async()=>{h(null);try{const A=(await $0(Fn,fx)).user,C=await _d(Br(sr,"users",A.uid));!C.exists()||!C.data().phone?f(!0):setTimeout(()=>{m("/")},1500)}catch(w){console.error("Google Sign-In Error:",w);const A=w;A.code==="auth/popup-closed-by-user"?h("Sign-in was cancelled. Please try again."):A.code==="auth/popup-blocked"?h("Popup was blocked by your browser. Please allow popups and try again."):A.code==="auth/auth-domain-config-required"?h("Google Sign-In is not properly configured. Please contact support."):A.code==="auth/operation-not-allowed"?h("Google Sign-In is not enabled. Please contact support."):A.code==="auth/unauthorized-domain"?h("This domain is not authorized for Google Sign-In."):h(`Sign-in failed: ${A.message||"Unknown error"}`)}},M=async w=>{w.preventDefault();const A=Hr(t);if(!A.isValid){h(A.error||"Please enter a valid phone number");return}try{await uh(Br(sr,"users",Fn.currentUser?.uid||""),{phone:t,name:Fn.currentUser?.displayName,email:Fn.currentUser?.email},{merge:!0}),f(!1),setTimeout(()=>{m("/")},1500)}catch(C){h(C.message)}},S=w=>{const{name:A,value:C}=w.target;if(p[A]&&g(x=>({...x,[A]:""})),A==="name"){const E=Td(C).slice(0,20);e(E);const O=Sd(E);O.isValid?g(I=>({...I,name:""})):g(I=>({...I,name:O.error||""}));return}if(A==="phone"){const E=C.replace(/\D/g,"").slice(0,10);n(E);const O=wd(E);O.isValid?g(I=>({...I,phone:""})):g(I=>({...I,phone:O.error||""}));return}if(A==="email"){s(C);const x=Ed(C);x.isValid?g(E=>({...E,email:""})):g(E=>({...E,email:x.error||""}))}else A==="password"&&o(C)},L=w=>{const{name:A,value:C}=w.target;if(T(x=>({...x,[A]:!0})),A==="name"){const x=aa(C);x.isValid?g(E=>({...E,name:""})):g(E=>({...E,name:x.error||""}))}else if(A==="email"){const x=sa(C);x.isValid?g(E=>({...E,email:""})):g(E=>({...E,email:x.error||""}))}else if(A==="phone"){const x=Hr(C);x.isValid?g(E=>({...E,phone:""})):g(E=>({...E,phone:x.error||""}))}},V=()=>{const w={name:"",phone:"",email:"",password:""},A=aa(i);A.isValid||(w.name=A.error||"");const C=Hr(t);C.isValid||(w.phone=C.error||"");const x=sa(r);return x.isValid||(w.email=x.error||""),a.trim()?a.length<6&&(w.password="Password must be at least 6 characters"):w.password="Password is required",g(w),!Object.values(w).some(E=>E!=="")},k=async w=>{if(w.preventDefault(),h(null),!!V())try{console.log("Attempting to create user with email/password...");const A=await Aw(Fn,r,a);console.log("User created successfully:",A.user),A.user&&(await U0(A.user,{displayName:i}),console.log("Profile updated successfully"),await uh(Br(sr,"users",A.user.uid),{name:i,email:r,phone:t}),console.log("User data stored in Firestore successfully")),m("/")}catch(A){console.error("Email/Password Sign-up Error:",A);const C=A;C.code==="auth/email-already-in-use"?h("This email is already registered. Please use a different email or try logging in."):C.code==="auth/weak-password"?h("Password is too weak. Please use at least 6 characters."):C.code==="auth/invalid-email"?h("Please enter a valid email address."):C.code==="auth/operation-not-allowed"?h("Email/password authentication is not enabled. Please contact support."):h(`Registration failed: ${C.message||"Unknown error"}`)}};return c.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-900 to-gray-800",children:[c.jsxs("div",{className:"bg-black bg-opacity-60 rounded-xl shadow-lg p-8 w-full max-w-md",children:[c.jsxs("div",{className:"flex flex-col items-center mb-6",children:[c.jsx("div",{className:"bg-gray-800 rounded-full p-3 mb-2",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})}),c.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Create an account"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"Sign up with Google or Email"})]}),c.jsx("div",{className:"flex justify-center mb-4",children:c.jsxs("button",{className:"bg-gray-700 hover:bg-gray-600 p-2 rounded-full flex items-center gap-2",onClick:v,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"w-5 h-5",children:c.jsxs("g",{children:[c.jsx("path",{fill:"#4285F4",d:"M43.6 20.5H42V20H24v8h11.3C34.7 32.1 29.8 35 24 35c-6.1 0-11.3-4.1-13.1-9.6s-.3-11.3 4.6-14.7c4.9-3.4 11.5-2.7 15.7 1.6l6.2-6.2C33.1 2.1 28.7 0 24 0 10.7 0 0 10.7 0 24s10.7 24 24 24c12.2 0 22.3-9.3 23.8-21.2.1-.7.2-1.3.2-2 0-1.3-.1-2.5-.4-3.7z"}),c.jsx("path",{fill:"#34A853",d:"M6.3 14.6l6.6 4.8C14.5 16.1 19 13 24 13c3.1 0 6 .9 8.3 2.6l6.2-6.2C34.7 4.1 29.8 1 24 1 14.1 1 5.7 7.6 2.1 16.1l6.2-1.5z"}),c.jsx("path",{fill:"#FBBC05",d:"M24 47c5.8 0 11.1-2.2 15.2-5.8l-7.1-5.8C29.8 37.9 27 39 24 39c-5 0-9.5-3.1-11.3-7.6l-6.6 5.1C5.7 40.4 14.1 47 24 47z"}),c.jsx("path",{fill:"#EA4335",d:"M43.6 20.5H42V20H24v8h11.3c-1.1 3.1-4.1 5.5-7.3 6.2l7.1 5.8C41.7 36.2 44 30.6 44 24c0-1.3-.1-2.5-.4-3.7z"})]})}),c.jsx("span",{className:"text-white",children:"Sign up with Google"})]})}),c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"flex-grow h-px bg-gray-700"}),c.jsx("span",{className:"mx-2 text-gray-500 text-xs",children:"OR"}),c.jsx("div",{className:"flex-grow h-px bg-gray-700"})]}),c.jsxs("form",{onSubmit:k,children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Name *"}),c.jsx("input",{type:"text",name:"name",className:`w-full px-4 py-2 rounded bg-gray-800 text-white border focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${p.name&&y.name?"border-red-500":"border-gray-700"}`,placeholder:"Enter your full name",required:!0,value:i,onChange:S,onBlur:L,maxLength:20}),y.name&&p.name&&c.jsx("div",{className:"text-red-500 text-sm mt-1",children:p.name})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Phone Number *"}),c.jsx("input",{type:"tel",name:"phone",className:`w-full px-4 py-2 rounded bg-gray-800 text-white border focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${p.phone&&y.phone?"border-red-500":"border-gray-700"}`,placeholder:"Enter 10 digits only (e.g., 9876543210)",required:!0,value:t,onChange:S,onBlur:L,maxLength:10}),y.phone&&p.phone&&c.jsx("div",{className:"text-red-500 text-sm mt-1",children:p.phone})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Email Address *"}),c.jsx("input",{type:"email",name:"email",className:`w-full px-4 py-2 rounded bg-gray-800 text-white border focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${p.email&&y.email?"border-red-500":"border-gray-700"}`,placeholder:"Enter your email address...",required:!0,value:r,onChange:S,onBlur:L}),y.email&&p.email&&c.jsx("div",{className:"text-red-500 text-sm mt-1",children:p.email})]}),c.jsxs("div",{className:"mb-2",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Password *"}),c.jsx("input",{type:"password",name:"password",className:`w-full px-4 py-2 rounded bg-gray-800 text-white border focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${p.password&&y.password?"border-red-500":"border-gray-700"}`,placeholder:"Enter password (min 6 characters)...",required:!0,value:a,onChange:S,onBlur:L}),y.password&&p.password&&c.jsx("div",{className:"text-red-500 text-sm mt-1",children:p.password})]}),l&&c.jsx("div",{className:"text-red-500 text-sm mb-2",children:l}),c.jsx("button",{type:"submit",className:"w-full py-2 rounded bg-gray-700 text-white font-semibold hover:bg-gray-600 transition",children:"Sign up"})]}),c.jsxs("div",{className:"mt-4 text-center text-gray-400 text-sm",children:["Already have an account?"," ",c.jsx(rt,{to:"/login",className:"text-blue-400 hover:underline",children:"Sign in"})]})]}),d&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-50",children:c.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg shadow-lg w-full max-w-sm",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Enter your phone number"}),c.jsxs("form",{onSubmit:M,children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Phone Number *"}),c.jsx("input",{type:"tel",name:"phone",className:`w-full px-4 py-2 rounded bg-gray-800 text-white border focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${p.phone&&y.phone?"border-red-500":"border-gray-700"}`,placeholder:"Enter 10 digits only (e.g., 9876543210)",required:!0,value:t,onChange:S,onBlur:L,maxLength:10}),y.phone&&p.phone&&c.jsx("div",{className:"text-red-500 text-sm mt-1",children:p.phone})]}),c.jsx("button",{type:"submit",className:"w-full py-2 rounded bg-gray-700 text-white font-semibold hover:bg-gray-600 transition",children:"Save Phone Number"})]})]})})]})};function RL(){return c.jsx(ML,{})}function CL(){const{user:i}=Sv(),[e,t]=G.useState(null),[n,r]=G.useState(!1),[s,a]=G.useState(!0),[o,l]=G.useState(null),[h,d]=G.useState({name:"",phone:""});G.useEffect(()=>{(async()=>{if(i)try{const y=await _d(Br(sr,"users",i.uid));if(y.exists()){const T=y.data();t({name:T.name||i.displayName||"N/A",email:T.email||i.email||"N/A",phone:T.phone||"N/A",createdAt:T.createdAt,lastLogin:T.lastLogin}),d({name:T.name||i.displayName||"",phone:T.phone||""})}else t({name:i.displayName||"N/A",email:i.email||"N/A",phone:"N/A",createdAt:i.metadata.creationTime,lastLogin:i.metadata.lastSignInTime}),d({name:i.displayName||"",phone:""})}catch(y){l("Failed to load user data"),console.error("Error fetching user data:",y)}finally{a(!1)}})()},[i]);const f=async g=>{if(g.preventDefault(),!!i)try{l(null),await U0(i,{displayName:h.name}),await i1(Br(sr,"users",i.uid),{name:h.name,phone:h.phone,updatedAt:new Date().toISOString()}),t(y=>y?{...y,name:h.name,phone:h.phone}:null),r(!1)}catch(y){l("Failed to update profile"),console.error("Error updating profile:",y)}},p=async()=>{try{await Fn.signOut(),window.location.href="/"}catch(g){l("Failed to sign out"),console.error("Error signing out:",g)}};return s?c.jsx("div",{className:"min-h-screen bg-black pt-32",children:c.jsx("div",{className:"container mx-auto px-4",children:c.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})})})}):i?c.jsx("div",{className:"min-h-screen bg-black pt-32",children:c.jsx("div",{className:"container mx-auto px-4",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx(rt,{to:"/",className:"text-gray-400 hover:text-white transition",children:c.jsx(Vx,{className:"w-6 h-6"})}),c.jsx("h1",{className:"text-3xl font-bold text-white",children:"My Profile"})]}),c.jsxs("button",{onClick:p,className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition",children:[c.jsx(Lu,{className:"w-4 h-4"}),"Sign Out"]})]}),o&&c.jsx("div",{className:"bg-red-600/20 border border-red-600 text-red-400 px-4 py-3 rounded-lg mb-6",children:o}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-white",children:"Profile Information"}),c.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-2 bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition",children:[c.jsx(jx,{className:"w-4 h-4"}),n?"Cancel":"Edit"]})]}),n?c.jsxs("form",{onSubmit:f,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Full Name"}),c.jsx("input",{type:"text",value:h.name,onChange:g=>d(y=>({...y,name:g.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"Enter your full name",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Phone Number"}),c.jsx("input",{type:"tel",value:h.phone,onChange:g=>d(y=>({...y,phone:g.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"Enter your phone number"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition",children:"Save Changes"}),c.jsx("button",{type:"button",onClick:()=>r(!1),className:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ws,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 text-sm",children:"Full Name"}),c.jsx("p",{className:"text-white font-medium",children:e?.name})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ug,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 text-sm",children:"Email Address"}),c.jsx("p",{className:"text-white font-medium",children:e?.email})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Fg,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 text-sm",children:"Phone Number"}),c.jsx("p",{className:"text-white font-medium",children:e?.phone})]})]}),e?.createdAt&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Bx,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 text-sm",children:"Member Since"}),c.jsx("p",{className:"text-white font-medium",children:new Date(e.createdAt).toLocaleDateString()})]})]})]})]})}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(rt,{to:"/contact",className:"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg hover:bg-gray-700/50 transition",children:[c.jsx(Nu,{className:"w-5 h-5 text-blue-400"}),c.jsx("span",{className:"text-white",children:"Contact Support"})]}),c.jsxs(rt,{to:"/services",className:"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg hover:bg-gray-700/50 transition",children:[c.jsx(Ws,{className:"w-5 h-5 text-green-400"}),c.jsx("span",{className:"text-white",children:"View Services"})]}),c.jsxs(rt,{to:"/portfolio",className:"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg hover:bg-gray-700/50 transition",children:[c.jsx(Ws,{className:"w-5 h-5 text-purple-400"}),c.jsx("span",{className:"text-white",children:"View Portfolio"})]})]})]}),c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Account Status"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-gray-400",children:"Email Verified"}),c.jsx("span",{className:`px-2 py-1 rounded text-xs ${i.emailVerified?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:i.emailVerified?"Verified":"Not Verified"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-gray-400",children:"Last Login"}),c.jsx("span",{className:"text-white text-sm",children:e?.lastLogin?new Date(e.lastLogin).toLocaleDateString():"N/A"})]})]})]})]})]})]})})}):c.jsx("div",{className:"min-h-screen bg-black pt-32",children:c.jsx("div",{className:"container mx-auto px-4",children:c.jsx("div",{className:"max-w-2xl mx-auto",children:c.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border border-gray-800 rounded-lg p-8 text-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Access Denied"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"You need to be logged in to view your profile."}),c.jsx(rt,{to:"/login",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition",children:"Sign In"})]})})})})}function IL(){const i=rs(),e=i.pathname==="/login"||i.pathname==="/signup",{isPopupOpen:t,closePopup:n}=I1(3);return c.jsxs("div",{className:"antialiased bg-black min-h-screen",children:[c.jsx(S1,{}),c.jsx(T1,{}),!e&&c.jsx(a1,{}),c.jsx("main",{children:c.jsxs(Ny,{children:[c.jsx(Cn,{path:"/",element:c.jsx(cL,{})}),c.jsx(Cn,{path:"/about",element:c.jsx(uL,{})}),c.jsx(Cn,{path:"/services",element:c.jsx(hL,{})}),c.jsx(Cn,{path:"/web-development",element:c.jsx(dL,{})}),c.jsx(Cn,{path:"/app-development",element:c.jsx(fL,{})}),c.jsx(Cn,{path:"/digital-marketing",element:c.jsx(pL,{})}),c.jsx(Cn,{path:"/product-listing",element:c.jsx(mL,{})}),c.jsx(Cn,{path:"/portfolio",element:c.jsx(EL,{})}),c.jsx(Cn,{path:"/contact",element:c.jsx(SL,{})}),c.jsx(Cn,{path:"/login",element:c.jsx(AL,{})}),c.jsx(Cn,{path:"/signup",element:c.jsx(RL,{})}),c.jsx(Cn,{path:"/profile",element:c.jsx(CL,{})})]})}),!e&&c.jsx(o1,{}),c.jsx(C1,{isOpen:t,onClose:n})]})}Du.createRoot(document.getElementById("root")).render(c.jsx(kg.StrictMode,{children:c.jsx(Vy,{children:c.jsx(IL,{})})}));
